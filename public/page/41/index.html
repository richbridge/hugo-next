<!doctype html><html lang=zh-CN data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.147.7"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="æ¨Šå°˜åˆ¹è®°"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"><meta name=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=keywords content="æ¨Šåˆ¹,ä¸“ä¸š,å­¦ä¹ ,è€ƒè¯,æ¨Šå°˜åˆ¹"><meta property="og:type" content="website"><meta property="og:title" content="æ¨Šå°˜åˆ¹è®°"><meta property="og:description" content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"><meta property="og:image" content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="//localhost:1313/"><meta property="og:site_name" content="æ¨Šå°˜åˆ¹è®°"><meta property="og:locale" content="zh-CN"><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.css?=1750131041"><style type=text/css>.post-footer hr:after{content:"~ æˆ‘å¯æ˜¯æœ‰åº•çº¿çš„å“Ÿ ~"}.flinks-list-footer hr:after{content:"~ æˆ‘å¯æ˜¯æœ‰åº•çº¿çš„å“Ÿ ~"}</style><link rel=stylesheet type=text/css href="/css/custom_style.css?=1750131041"><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>æ¨Šå°˜åˆ¹è®°</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>æ¨Šå°˜åˆ¹è®°</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>çº¢å°˜æ¹®ç­ï¼Œå”¯æœ‰å°˜åˆ¹</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class="hvr-icon-pulse menu-item-active" rel=section><i class="fa fa-home hvr-icon"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>å½’æ¡£
<span class=badge>629</span></a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>å‹é“¾</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>å…³äº</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>æœç´¢</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=æœç´¢... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>æ–‡ç« ç›®å½•</li><li class=sidebar-nav-overview>ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rich src=/imgs/img-lazy-loading.gif data-src=https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif><p class=site-author-name itemprop=name>Rich</p><div class=site-description itemprop=description>ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>629</span>
<span class=site-state-item-name>æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>8</span>
<span class=site-state-item-name>åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>99</span>
<span class=site-state-item-name>æ ‡ç­¾</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/richbridge title="Github â†’ https://github.com/richbridge" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/richfan-38 title="çŸ¥ä¹ â†’ https://www.zhihu.com/people/richfan-38" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
çŸ¥ä¹</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans class=cc-opacity rel=noopener target=_blank title=å…±äº«çŸ¥è¯†><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=å…±äº«çŸ¥è¯†></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
å‹æƒ…é“¾æ¥</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>å‡¡æ¢¦æ˜Ÿå°˜ç©ºé—´ç«™</a></li></ul></div><div class="mydefined animated" itemprop=custom><span>ğŸ’„ğŸ’„ğŸ’„</span></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>ç½‘ç«™èµ„è®¯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>å·²è¿è¡Œï¼š</div><div class=item-count id=runTimes data-publishdate="0001-01-01 00:00:00 +0000 UTC"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>æ€»è®¿å®¢æ•°ï¼š</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>é¡µé¢æµè§ˆï¼š</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>æ€»å­—æ•°ï¼š</div><div class=item-count id=wordsCount data-count=2702735></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>é˜…è¯»çº¦ï¼š</div><div class=item-count id=readTimes data-times=5708></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>æœ€åæ›´æ–°äºï¼š</div><div class=item-count id=last-push-date data-lastpushdate="2025-01-24 00:00:00 +0000 UTC"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-i18n-translate class=button title=å¤šè¯­è¨€ç¿»è¯‘><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=æ·±æµ…æ¨¡å¼åˆ‡æ¢><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=è¿”å›é¡¶éƒ¨><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/richbridge rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner index posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E7%A8%8B%E6%8A%80/sql/3days_alive_users/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="ç»™å®šç”¨æˆ·ç™»å½•è¡¨ï¼Œæ±‚è¡¨ä¸­æ¯ä¸€å¤©çš„3å¤©ç•™å­˜ç‡"><meta itemprop=description content="

 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94


-- ç»™å®šç”¨æˆ·ç™»å½•è¡¨ï¼Œæ±‚è¡¨ä¸­æ¯ä¸€å¤©çš„&#34;3å¤©ç•™å­˜ç‡&#34;

-- step 0 è¡¨å‡†å¤‡ï¼Œç”¨æˆ·IDï¼Œç™»å½•æ—¶é—´
create table cm.tb_user_logs(
    user_id int,
    visit_time datetime
);

insert into cm.tb_user_logs
(user_id, visit_time)
values
(1001, '2022-10-01 08:01:23'),
(1001, '2022-10-01 08:11:15'),
(1002, '2022-10-01 08:22:19'),
(1003, '2022-10-01 09:00:53'),
(1002, '2022-10-02 18:00:13'),
(1004, '2022-10-02 13:30:43'),
(1004, '2022-10-02 15:06:22'),
(1005, '2022-10-02 08:00:39'),
(1002, '2022-10-03 08:00:13'),
(1003, '2022-10-03 18:00:13'),
(1004, '2022-10-03 21:00:13'),
(1006, '2022-10-03 22:00:13'),
(1001, '2022-10-04 11:10:13'),
(1002, '2022-10-04 12:00:13'),
(1002, '2022-10-04 09:00:13'),
(1004, '2022-10-04 08:00:13'),
(1006, '2022-10-04 08:00:13'),
(1004, '2022-10-05 08:00:13'),
(1005, '2022-10-05 08:00:13'),
(1002, '2022-10-05 08:00:43'),
(1003, '2022-10-05 12:00:13'),
(1004, '2022-10-05 10:00:43'),
(1006, '2022-10-05 08:00:11'),
(1001, '2022-10-06 09:00:47'),
(1001, '2022-10-06 07:00:15'),
(1002, '2022-10-06 18:00:43'),
(1003, '2022-10-07 20:00:19'),
(1002, '2022-10-07 21:00:23'),
(1004, '2022-10-07 22:00:43');

-- step 1 åˆ›å»ºè§†å›¾ï¼Œè¿›è¡Œç”¨æˆ·IDå’Œæ—¶é—´å»é‡
create view A as
select distinct
       user_id,
       date(visit_time) as dt
from cm.tb_user_logs;

-- step2. è®¡ç®—æ¯å¤©çš„&#34;3å¤©æ´»è·ƒç”¨æˆ·æ•°&#34;ï¼Œå³å¯¹äºæ¯ä¸€å¤©è€Œè¨€ï¼Œåœ¨å½“å¤©çš„æ´»è·ƒç”¨æˆ·ä¸­ï¼Œ3å¤©åè¿˜æ´»è·ƒçš„é‚£äº›ç”¨æˆ·---åˆ†å­
select
    t1.dt      as dt,
    count(t1.user_id) as 3day_active_cnt
from A as t1
         join A t2 on t1.dt = t2.dt - 3
where 1 = 1
  and t1.user_id = t2.user_id
group by t1.dt;

-- step3. è®¡ç®—æ¯å¤©çš„æ´»è·ƒç”¨æˆ·æ•°---åˆ†æ¯
select
    dt,
    count(user_id) as active_cnt
from A
group by dt;

-- step4. å°†ä¸Šè¿°ä¸¤ä¸ªæ­¥éª¤ç»“æœï¼ŒæŒ‰ç…§åŒä¸€å¤©çš„æ—¥æœŸï¼Œè¿›è¡Œå…³è”ï¼Œæ±‚æ¯”ç‡å³å¯
select t3.dt,
       t3.3days_active_cnt,
       t4.active_cnt,
       t3.3days_active_cnt * 1.0 / t4.active_cnt as 3day_alive_ratio
from (select t1.dt,
             count(t1.user_id) as 3days_active_cnt
            from A as t1
                     join A t2 on t1.dt = t2.dt - 3
            where 1=1
                and t1.user_id = t2.user_id
            group by dt) as t3
         join
         (select
              dt,
              count(user_id) as active_cnt
          from A
          group by dt
          ) as t4
         on t3.dt = t4.dt
order by t3.dt;

select distinct (user_id)
from cm.tb_user_logs
where date(visit_time)='2022-10-01';

select distinct (user_id)
from cm.tb_user_logs
where date(visit_time)='2022-10-04';

"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E7%A8%8B%E6%8A%80/sql/3days_alive_users/ itemprop=url class=post-title-link>ç»™å®šç”¨æˆ·ç™»å½•è¡¨ï¼Œæ±‚è¡¨ä¸­æ¯ä¸€å¤©çš„3å¤©ç•™å­˜ç‡</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E7%A8%8B%E6%8A%80/ itemprop=url rel=index><span itemprop=name>ç¨‹æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38>38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39>39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40>40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41>41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42>42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43>43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44>44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45>45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46>46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47>47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48>48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49>49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50>50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51>51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52>52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53>53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54>54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55>55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56>56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57>57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58>58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59>59</a>
</span><span class=lnt id=hl-0-60><a class=lnlinks href=#hl-0-60>60</a>
</span><span class=lnt id=hl-0-61><a class=lnlinks href=#hl-0-61>61</a>
</span><span class=lnt id=hl-0-62><a class=lnlinks href=#hl-0-62>62</a>
</span><span class=lnt id=hl-0-63><a class=lnlinks href=#hl-0-63>63</a>
</span><span class=lnt id=hl-0-64><a class=lnlinks href=#hl-0-64>64</a>
</span><span class=lnt id=hl-0-65><a class=lnlinks href=#hl-0-65>65</a>
</span><span class=lnt id=hl-0-66><a class=lnlinks href=#hl-0-66>66</a>
</span><span class=lnt id=hl-0-67><a class=lnlinks href=#hl-0-67>67</a>
</span><span class=lnt id=hl-0-68><a class=lnlinks href=#hl-0-68>68</a>
</span><span class=lnt id=hl-0-69><a class=lnlinks href=#hl-0-69>69</a>
</span><span class=lnt id=hl-0-70><a class=lnlinks href=#hl-0-70>70</a>
</span><span class=lnt id=hl-0-71><a class=lnlinks href=#hl-0-71>71</a>
</span><span class=lnt id=hl-0-72><a class=lnlinks href=#hl-0-72>72</a>
</span><span class=lnt id=hl-0-73><a class=lnlinks href=#hl-0-73>73</a>
</span><span class=lnt id=hl-0-74><a class=lnlinks href=#hl-0-74>74</a>
</span><span class=lnt id=hl-0-75><a class=lnlinks href=#hl-0-75>75</a>
</span><span class=lnt id=hl-0-76><a class=lnlinks href=#hl-0-76>76</a>
</span><span class=lnt id=hl-0-77><a class=lnlinks href=#hl-0-77>77</a>
</span><span class=lnt id=hl-0-78><a class=lnlinks href=#hl-0-78>78</a>
</span><span class=lnt id=hl-0-79><a class=lnlinks href=#hl-0-79>79</a>
</span><span class=lnt id=hl-0-80><a class=lnlinks href=#hl-0-80>80</a>
</span><span class=lnt id=hl-0-81><a class=lnlinks href=#hl-0-81>81</a>
</span><span class=lnt id=hl-0-82><a class=lnlinks href=#hl-0-82>82</a>
</span><span class=lnt id=hl-0-83><a class=lnlinks href=#hl-0-83>83</a>
</span><span class=lnt id=hl-0-84><a class=lnlinks href=#hl-0-84>84</a>
</span><span class=lnt id=hl-0-85><a class=lnlinks href=#hl-0-85>85</a>
</span><span class=lnt id=hl-0-86><a class=lnlinks href=#hl-0-86>86</a>
</span><span class=lnt id=hl-0-87><a class=lnlinks href=#hl-0-87>87</a>
</span><span class=lnt id=hl-0-88><a class=lnlinks href=#hl-0-88>88</a>
</span><span class=lnt id=hl-0-89><a class=lnlinks href=#hl-0-89>89</a>
</span><span class=lnt id=hl-0-90><a class=lnlinks href=#hl-0-90>90</a>
</span><span class=lnt id=hl-0-91><a class=lnlinks href=#hl-0-91>91</a>
</span><span class=lnt id=hl-0-92><a class=lnlinks href=#hl-0-92>92</a>
</span><span class=lnt id=hl-0-93><a class=lnlinks href=#hl-0-93>93</a>
</span><span class=lnt id=hl-0-94><a class=lnlinks href=#hl-0-94>94</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- ç»™å®šç”¨æˆ·ç™»å½•è¡¨ï¼Œæ±‚è¡¨ä¸­æ¯ä¸€å¤©çš„&#34;3å¤©ç•™å­˜ç‡&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step 0 è¡¨å‡†å¤‡ï¼Œç”¨æˆ·IDï¼Œç™»å½•æ—¶é—´
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_user_logs</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>user_id</span><span class=w> </span><span class=nb>int</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>visit_time</span><span class=w> </span><span class=n>datetime</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_user_logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span><span class=w> </span><span class=n>visit_time</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1001</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-01 08:01:23&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1001</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-01 08:11:15&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-01 08:22:19&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-01 09:00:53&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-02 18:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1004</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-02 13:30:43&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1004</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-02 15:06:22&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1005</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-02 08:00:39&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-03 08:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-03 18:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1004</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-03 21:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1006</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-03 22:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1001</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-04 11:10:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-04 12:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-04 09:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1004</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-04 08:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1006</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-04 08:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1004</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-05 08:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1005</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-05 08:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-05 08:00:43&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-05 12:00:13&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1004</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-05 10:00:43&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1006</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-05 08:00:11&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1001</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-06 09:00:47&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1001</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-06 07:00:15&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-06 18:00:43&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-07 20:00:19&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-07 21:00:23&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1004</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-07 22:00:43&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step 1 åˆ›å»ºè§†å›¾ï¼Œè¿›è¡Œç”¨æˆ·IDå’Œæ—¶é—´å»é‡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>create</span><span class=w> </span><span class=k>view</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=k>as</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=k>distinct</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>user_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=nb>date</span><span class=p>(</span><span class=n>visit_time</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>dt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_user_logs</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step2. è®¡ç®—æ¯å¤©çš„&#34;3å¤©æ´»è·ƒç”¨æˆ·æ•°&#34;ï¼Œå³å¯¹äºæ¯ä¸€å¤©è€Œè¨€ï¼Œåœ¨å½“å¤©çš„æ´»è·ƒç”¨æˆ·ä¸­ï¼Œ3å¤©åè¿˜æ´»è·ƒçš„é‚£äº›ç”¨æˆ·---åˆ†å­
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>t1</span><span class=p>.</span><span class=n>dt</span><span class=w>      </span><span class=k>as</span><span class=w> </span><span class=n>dt</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>count</span><span class=p>(</span><span class=n>t1</span><span class=p>.</span><span class=n>user_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=mi>3</span><span class=n>day_active_cnt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>t1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>join</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>dt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=n>dt</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>and</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>user_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=n>user_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>dt</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step3. è®¡ç®—æ¯å¤©çš„æ´»è·ƒç”¨æˆ·æ•°---åˆ†æ¯
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>dt</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>count</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>active_cnt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>dt</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step4. å°†ä¸Šè¿°ä¸¤ä¸ªæ­¥éª¤ç»“æœï¼ŒæŒ‰ç…§åŒä¸€å¤©çš„æ—¥æœŸï¼Œè¿›è¡Œå…³è”ï¼Œæ±‚æ¯”ç‡å³å¯
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=n>t3</span><span class=p>.</span><span class=n>dt</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>t3</span><span class=p>.</span><span class=mi>3</span><span class=n>days_active_cnt</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>t4</span><span class=p>.</span><span class=n>active_cnt</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>t3</span><span class=p>.</span><span class=mi>3</span><span class=n>days_active_cnt</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>t4</span><span class=p>.</span><span class=n>active_cnt</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=mi>3</span><span class=n>day_alive_ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>dt</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=k>count</span><span class=p>(</span><span class=n>t1</span><span class=p>.</span><span class=n>user_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=mi>3</span><span class=n>days_active_cnt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>from</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>t1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=k>join</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>dt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=n>dt</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>where</span><span class=w> </span><span class=mi>1</span><span class=o>=</span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>and</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>user_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=n>user_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>dt</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>t3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>join</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=n>dt</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=k>count</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>active_cnt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=k>from</span><span class=w> </span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>dt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>t4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>on</span><span class=w> </span><span class=n>t3</span><span class=p>.</span><span class=n>dt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t4</span><span class=p>.</span><span class=n>dt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>t3</span><span class=p>.</span><span class=n>dt</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=k>distinct</span><span class=w> </span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_user_logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=nb>date</span><span class=p>(</span><span class=n>visit_time</span><span class=p>)</span><span class=o>=</span><span class=s1>&#39;2022-10-01&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=k>distinct</span><span class=w> </span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_user_logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=nb>date</span><span class=p>(</span><span class=n>visit_time</span><span class=p>)</span><span class=o>=</span><span class=s1>&#39;2022-10-04&#39;</span><span class=p>;</span></span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E7%A8%8B%E6%8A%80/sql/3days_alive_users/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E5%AE%A1%E6%8A%80/%E7%BB%8F%E6%B5%8E%E8%B4%A3%E4%BB%BB%E5%AE%A1%E8%AE%A1/%E5%85%AC%E5%8A%A1%E6%8E%A5%E5%BE%85%E4%B8%AD%E5%93%AA%E4%BA%9B%E8%A1%8C%E4%B8%BA%E5%8F%AF%E4%B8%BA%E5%93%AA%E4%BA%9B%E8%A1%8C%E4%B8%BA%E4%B8%8D%E5%8F%AF%E4%B8%BA/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="å…¬åŠ¡æ¥å¾…ä¸­å“ªäº›è¡Œä¸ºå¯ä¸ºï¼Ÿå“ªäº›è¡Œä¸ºä¸å¯ä¸ºï¼Ÿ"><meta itemprop=description content="å…¬åŠ¡æ¥å¾…ä¸­å“ªäº›è¡Œä¸ºå¯ä¸ºï¼Ÿå“ªäº›è¡Œä¸ºä¸å¯ä¸ºï¼Ÿ

ä¸€ã€å…¬åŠ¡æ¥å¾…ç¨‹åº

1.å››è¦ç´ ã€‚

æœ‰å…¬å‡½ï¼ˆåŒ…æ‹¬ç”µè¯é€šçŸ¥ï¼‰ã€æœ‰å®¡æ‰¹ã€æŒ‰æ ‡å‡†ã€æœ‰æ¸…å•ã€‚
2.æ¥å¾…ç¨‹åºã€‚

æ¥å¾…å•ä½åº”å½“æ ¹æ®è§„å®šçš„æ¥å¾…èŒƒå›´ï¼Œä¸¥æ ¼æ¥å¾…å®¡æ‰¹æ§åˆ¶ï¼Œå¯¹èƒ½å¤Ÿåˆå¹¶çš„å…¬åŠ¡æ¥å¾…ç»Ÿç­¹å®‰æ’ã€‚æ— å…¬å‡½çš„å…¬åŠ¡æ´»åŠ¨å’Œæ¥è®¿äººå‘˜ä¸€å¾‹ä¸äºˆæ¥å¾…ã€‚"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E5%AE%A1%E6%8A%80/%E7%BB%8F%E6%B5%8E%E8%B4%A3%E4%BB%BB%E5%AE%A1%E8%AE%A1/%E5%85%AC%E5%8A%A1%E6%8E%A5%E5%BE%85%E4%B8%AD%E5%93%AA%E4%BA%9B%E8%A1%8C%E4%B8%BA%E5%8F%AF%E4%B8%BA%E5%93%AA%E4%BA%9B%E8%A1%8C%E4%B8%BA%E4%B8%8D%E5%8F%AF%E4%B8%BA/ itemprop=url class=post-title-link>å…¬åŠ¡æ¥å¾…ä¸­å“ªäº›è¡Œä¸ºå¯ä¸ºï¼Ÿå“ªäº›è¡Œä¸ºä¸å¯ä¸ºï¼Ÿ</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AE%A1%E6%8A%80/ itemprop=url rel=index><span itemprop=name>å®¡æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=å…¬åŠ¡æ¥å¾…ä¸­å“ªäº›è¡Œä¸ºå¯ä¸ºå“ªäº›è¡Œä¸ºä¸å¯ä¸º>å…¬åŠ¡æ¥å¾…ä¸­å“ªäº›è¡Œä¸ºå¯ä¸ºï¼Ÿå“ªäº›è¡Œä¸ºä¸å¯ä¸ºï¼Ÿ
<a class=header-anchor href=#%e5%85%ac%e5%8a%a1%e6%8e%a5%e5%be%85%e4%b8%ad%e5%93%aa%e4%ba%9b%e8%a1%8c%e4%b8%ba%e5%8f%af%e4%b8%ba%e5%93%aa%e4%ba%9b%e8%a1%8c%e4%b8%ba%e4%b8%8d%e5%8f%af%e4%b8%ba></a></h2><h2 id=ä¸€å…¬åŠ¡æ¥å¾…ç¨‹åº>ä¸€ã€å…¬åŠ¡æ¥å¾…ç¨‹åº
<a class=header-anchor href=#%e4%b8%80%e5%85%ac%e5%8a%a1%e6%8e%a5%e5%be%85%e7%a8%8b%e5%ba%8f></a></h2><h3 id=1å››è¦ç´ >1.å››è¦ç´ ã€‚
<a class=header-anchor href=#1%e5%9b%9b%e8%a6%81%e7%b4%a0></a></h3><p>æœ‰å…¬å‡½ï¼ˆåŒ…æ‹¬ç”µè¯é€šçŸ¥ï¼‰ã€æœ‰å®¡æ‰¹ã€æŒ‰æ ‡å‡†ã€æœ‰æ¸…å•ã€‚</p><h3 id=2æ¥å¾…ç¨‹åº>2.æ¥å¾…ç¨‹åºã€‚
<a class=header-anchor href=#2%e6%8e%a5%e5%be%85%e7%a8%8b%e5%ba%8f></a></h3><p>æ¥å¾…å•ä½åº”å½“æ ¹æ®è§„å®šçš„æ¥å¾…èŒƒå›´ï¼Œä¸¥æ ¼æ¥å¾…å®¡æ‰¹æ§åˆ¶ï¼Œå¯¹èƒ½å¤Ÿåˆå¹¶çš„å…¬åŠ¡æ¥å¾…ç»Ÿç­¹å®‰æ’ã€‚æ— å…¬å‡½çš„å…¬åŠ¡æ´»åŠ¨å’Œæ¥è®¿äººå‘˜ä¸€å¾‹ä¸äºˆæ¥å¾…ã€‚</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E5%AE%A1%E6%8A%80/%E7%BB%8F%E6%B5%8E%E8%B4%A3%E4%BB%BB%E5%AE%A1%E8%AE%A1/%E5%85%AC%E5%8A%A1%E6%8E%A5%E5%BE%85%E4%B8%AD%E5%93%AA%E4%BA%9B%E8%A1%8C%E4%B8%BA%E5%8F%AF%E4%B8%BA%E5%93%AA%E4%BA%9B%E8%A1%8C%E4%B8%BA%E4%B8%8D%E5%8F%AF%E4%B8%BA/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E8%AE%B2%E4%B9%89/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="åˆå¹¶æŠ¥è¡¨è®²ä¹‰"><meta itemprop=description content="ç›®å½•

åˆå¹¶æ­¥éª¤ï¼š
ä¸€ã€åˆå¹¶æŠ¥è¡¨åŸç†
ï¼ˆä¸€ï¼‰ä»è´¢åŠ¡æŠ¥è¡¨çš„ç”Ÿæˆè¯´èµ·
ï¼ˆäºŒï¼‰åˆå¹¶æŠµæ¶ˆåˆ†å½•çš„çœŸå®è¿‡ç¨‹
1ã€æŠŠä¸ŠæœŸçš„åˆ†å½•æŠ„è¿‡æ¥ï¼Œå½±å“æœªåˆ†é…åˆ©æ¶¦çš„ï¼Œå…¨éƒ¨å˜æˆå¹´åˆæœªåˆ†é…åˆ©æ¶¦
2ã€å¯¹æœ¬æœŸå­å…¬å¸æ‰€æœ‰è€…æƒç›Šçš„å˜åŠ¨è¿›è¡Œå¤„ç†
ï¼ˆä¸‰ï¼‰â€œç´¯è®¡è°ƒæ•´æ³•â€å’Œâ€œæƒç›Šæ³•â€çš„æ¯”è¾ƒ
ï¼ˆå››ï¼‰â€œç´¯è®¡è°ƒæ•´æ³•â€è½¬æ¢æˆâ€œæƒç›Šæ³•â€
ï¼ˆäº”ï¼‰èƒ½å¤Ÿå®ç°è‡ªåŠ¨åˆå¹¶çš„â€œæˆæœ¬æ³•â€
ï¼ˆå…­ï¼‰è‚¡ä¸œæœªå®Œå…¨å‡ºèµ„
ï¼ˆä¸ƒï¼‰åˆ†å…¬å¸æˆ–æ²¡æœ‰å‡ºèµ„çš„å­å…¬å¸
äºŒã€åˆå¹¶æŠ¥è¡¨å‰æœŸå·¥ä½œ
ï¼ˆä¸€ï¼‰ç¡®å®šåˆå¹¶èŒƒå›´
ï¼ˆäºŒï¼‰å¡«å†™å•ä½“TB
ï¼ˆä¸‰ï¼‰æŠŠå•ä½“TBè¿‡åˆ°åˆå¹¶TB
ä¸‰ã€åšä¸‰å®¶å…¬å¸çš„æ¡ˆä¾‹ï¼Œä½“éªŒæˆæœ¬æ³•
å››ã€æœ¬æœŸå¤„ç½®å­å…¬å¸
ï¼ˆä¸€ï¼‰ä¸€æ¬¡å¤„ç½®
ï¼ˆäºŒï¼‰æˆæœ¬æ³•è½¬æƒç›Šæ³•
ï¼ˆä¸‰ï¼‰æˆæœ¬æ³•è½¬å…¬å…ä»·å€¼
ï¼ˆå››ï¼‰æ³¨é”€å­å…¬å¸ã€åˆ†å…¬å¸
äº”ã€éåŒä¸€æ§åˆ¶ä¸‹ä¼ä¸šåˆå¹¶
ï¼ˆä¸€ï¼‰ä¸€æ¬¡è´­ä¹°
ï¼ˆäºŒï¼‰å…¬å…ä»·å€¼è½¬æˆæœ¬æ³•
ï¼ˆä¸‰ï¼‰æƒç›Šæ³•è½¬æˆæœ¬æ³•
å…­ã€åŒä¸€æ§åˆ¶ä¸‹ä¼ä¸šåˆå¹¶
ï¼ˆä¸€ï¼‰æ¯å…¬å¸çš„åˆ†å½•
ï¼ˆäºŒï¼‰æœ€ç»ˆæ§åˆ¶æ–¹çš„åˆå¹¶æ–¹æ³•
ä¸ƒã€å±‚å±‚åˆå¹¶ï¼Œå­˜åœ¨å­™å…¬å¸çš„æƒ…å†µ
ï¼ˆä¸€ï¼‰åˆ†å±‚åˆå¹¶
ï¼ˆäºŒï¼‰åœ¨æœ€ç»ˆåˆå¹¶å±‚é¢ä¸€æ­¥åˆ°ä½ï¼Ÿ
å…«ã€åˆå¹¶æ‰€æœ‰è€…æƒç›Šå˜åŠ¨è¡¨
ä¹ã€è´­ä¹°å°‘æ•°è‚¡ä¸œè‚¡æƒ
åã€å¤„ç½®å°‘æ•°è‚¡æƒï¼Œä½†ä¸ä¸§å¤±æ§åˆ¶æƒ
åä¸€ã€å°‘æ•°è‚¡ä¸œå¢èµ„å¯¼è‡´ç¨€é‡Šæ¯å…¬å¸è‚¡æƒ
åäºŒã€æ¯å…¬å¸å¢èµ„
åä¸‰ã€äº¤å‰æŒè‚¡
ï¼ˆä¸€ï¼‰æ¯å…¬å¸ä¸å­å…¬å¸ç›¸äº’æŒè‚¡
ï¼ˆäºŒï¼‰å­å…¬å¸ç›¸äº’æŒè‚¡
ï¼ˆä¸‰ï¼‰æ¯å…¬å¸æŒè‚¡å­™å…¬å¸
åå››ã€å†…éƒ¨äº¤æ˜“æŠµæ¶ˆ
ï¼ˆä¸€ï¼‰å†…éƒ¨å•†å“äº¤æ˜“
ï¼ˆäºŒï¼‰å†…éƒ¨äº¤æ˜“å½¢æˆå›ºå®šèµ„äº§
ï¼ˆä¸‰ï¼‰å†…éƒ¨å¾€æ¥
ï¼ˆå››ï¼‰å¦‚ä½•è¯†åˆ«å†…éƒ¨äº¤æ˜“"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E8%AE%B2%E4%B9%89/ itemprop=url class=post-title-link>åˆå¹¶æŠ¥è¡¨è®²ä¹‰</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AE%A1%E6%8A%80/ itemprop=url rel=index><span itemprop=name>å®¡æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=ç›®å½•>ç›®å½•
<a class=header-anchor href=#%e7%9b%ae%e5%bd%95></a></h2><p>åˆå¹¶æ­¥éª¤ï¼š
ä¸€ã€åˆå¹¶æŠ¥è¡¨åŸç†
ï¼ˆä¸€ï¼‰ä»è´¢åŠ¡æŠ¥è¡¨çš„ç”Ÿæˆè¯´èµ·
ï¼ˆäºŒï¼‰åˆå¹¶æŠµæ¶ˆåˆ†å½•çš„çœŸå®è¿‡ç¨‹
1ã€æŠŠä¸ŠæœŸçš„åˆ†å½•æŠ„è¿‡æ¥ï¼Œå½±å“æœªåˆ†é…åˆ©æ¶¦çš„ï¼Œå…¨éƒ¨å˜æˆå¹´åˆæœªåˆ†é…åˆ©æ¶¦
2ã€å¯¹æœ¬æœŸå­å…¬å¸æ‰€æœ‰è€…æƒç›Šçš„å˜åŠ¨è¿›è¡Œå¤„ç†
ï¼ˆä¸‰ï¼‰â€œç´¯è®¡è°ƒæ•´æ³•â€å’Œâ€œæƒç›Šæ³•â€çš„æ¯”è¾ƒ
ï¼ˆå››ï¼‰â€œç´¯è®¡è°ƒæ•´æ³•â€è½¬æ¢æˆâ€œæƒç›Šæ³•â€
ï¼ˆäº”ï¼‰èƒ½å¤Ÿå®ç°è‡ªåŠ¨åˆå¹¶çš„â€œæˆæœ¬æ³•â€
ï¼ˆå…­ï¼‰è‚¡ä¸œæœªå®Œå…¨å‡ºèµ„
ï¼ˆä¸ƒï¼‰åˆ†å…¬å¸æˆ–æ²¡æœ‰å‡ºèµ„çš„å­å…¬å¸
äºŒã€åˆå¹¶æŠ¥è¡¨å‰æœŸå·¥ä½œ
ï¼ˆä¸€ï¼‰ç¡®å®šåˆå¹¶èŒƒå›´
ï¼ˆäºŒï¼‰å¡«å†™å•ä½“TB
ï¼ˆä¸‰ï¼‰æŠŠå•ä½“TBè¿‡åˆ°åˆå¹¶TB
ä¸‰ã€åšä¸‰å®¶å…¬å¸çš„æ¡ˆä¾‹ï¼Œä½“éªŒæˆæœ¬æ³•
å››ã€æœ¬æœŸå¤„ç½®å­å…¬å¸
ï¼ˆä¸€ï¼‰ä¸€æ¬¡å¤„ç½®
ï¼ˆäºŒï¼‰æˆæœ¬æ³•è½¬æƒç›Šæ³•
ï¼ˆä¸‰ï¼‰æˆæœ¬æ³•è½¬å…¬å…ä»·å€¼
ï¼ˆå››ï¼‰æ³¨é”€å­å…¬å¸ã€åˆ†å…¬å¸
äº”ã€éåŒä¸€æ§åˆ¶ä¸‹ä¼ä¸šåˆå¹¶
ï¼ˆä¸€ï¼‰ä¸€æ¬¡è´­ä¹°
ï¼ˆäºŒï¼‰å…¬å…ä»·å€¼è½¬æˆæœ¬æ³•
ï¼ˆä¸‰ï¼‰æƒç›Šæ³•è½¬æˆæœ¬æ³•
å…­ã€åŒä¸€æ§åˆ¶ä¸‹ä¼ä¸šåˆå¹¶
ï¼ˆä¸€ï¼‰æ¯å…¬å¸çš„åˆ†å½•
ï¼ˆäºŒï¼‰æœ€ç»ˆæ§åˆ¶æ–¹çš„åˆå¹¶æ–¹æ³•
ä¸ƒã€å±‚å±‚åˆå¹¶ï¼Œå­˜åœ¨å­™å…¬å¸çš„æƒ…å†µ
ï¼ˆä¸€ï¼‰åˆ†å±‚åˆå¹¶
ï¼ˆäºŒï¼‰åœ¨æœ€ç»ˆåˆå¹¶å±‚é¢ä¸€æ­¥åˆ°ä½ï¼Ÿ
å…«ã€åˆå¹¶æ‰€æœ‰è€…æƒç›Šå˜åŠ¨è¡¨
ä¹ã€è´­ä¹°å°‘æ•°è‚¡ä¸œè‚¡æƒ
åã€å¤„ç½®å°‘æ•°è‚¡æƒï¼Œä½†ä¸ä¸§å¤±æ§åˆ¶æƒ
åä¸€ã€å°‘æ•°è‚¡ä¸œå¢èµ„å¯¼è‡´ç¨€é‡Šæ¯å…¬å¸è‚¡æƒ
åäºŒã€æ¯å…¬å¸å¢èµ„
åä¸‰ã€äº¤å‰æŒè‚¡
ï¼ˆä¸€ï¼‰æ¯å…¬å¸ä¸å­å…¬å¸ç›¸äº’æŒè‚¡
ï¼ˆäºŒï¼‰å­å…¬å¸ç›¸äº’æŒè‚¡
ï¼ˆä¸‰ï¼‰æ¯å…¬å¸æŒè‚¡å­™å…¬å¸
åå››ã€å†…éƒ¨äº¤æ˜“æŠµæ¶ˆ
ï¼ˆä¸€ï¼‰å†…éƒ¨å•†å“äº¤æ˜“
ï¼ˆäºŒï¼‰å†…éƒ¨äº¤æ˜“å½¢æˆå›ºå®šèµ„äº§
ï¼ˆä¸‰ï¼‰å†…éƒ¨å¾€æ¥
ï¼ˆå››ï¼‰å¦‚ä½•è¯†åˆ«å†…éƒ¨äº¤æ˜“</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E8%AE%B2%E4%B9%89/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E8%AE%B2%E4%B9%89-%E7%AC%AC%E4%B8%80%E7%AB%A0/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="åˆå¹¶æŠ¥è¡¨è®²ä¹‰-ç¬¬ä¸€ç« "><meta itemprop=description content="å†™åœ¨å‰é¢ï¼š

è¿™ç¯‡æ–‡ç« å¾ˆé•¿ï¼Œ1ä¸‡4åƒå­—ã€‚æ–‡ç« çš„ç›®çš„åœ¨äºæŒ‘æˆ˜ã€Šä¼ä¸šä¼šè®¡å‡†åˆ™åŠåº”ç”¨æŒ‡å—ã€‹ä¸­åˆå¹¶æŠµæ¶ˆåˆ†å½•çš„åšæ³•ï¼Œæ³¨ä¼šæ•™æä¸­çš„åšæ³•æ¥æºäºæŒ‡å—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘è¦æŒ‘æˆ˜â€œå®˜æ–¹â€åšæ³•ã€‚å®˜æ–¹çš„åšæ³•æ˜¯ï¼ŒæŠŠæˆæœ¬æ³•è½¬æ¢æˆæƒç›Šæ³•ï¼Œç„¶åå†æŠµæ¶ˆå­å…¬å¸çš„æ‰€æœ‰è€…æƒç›Šï¼Œæœ€åæŠµæ¶ˆæŠ•èµ„æ”¶ç›Šå’Œå­å…¬å¸çš„åˆ©æ¶¦åˆ†é…ã€‚â€œå®˜æ–¹â€çš„åšæ³•ç»™æˆ‘ä»¬ä¸€ç§å‡è±¡ï¼šå­å…¬å¸çš„æ‰€æœ‰è€…æƒç›Šè¢«æŠµæ¶ˆå®Œäº†ã€‚çœŸå®æƒ…å†µæ˜¯ï¼ŒåªæŠµæ¶ˆè´­ä¹°æ—¥å­å…¬å¸çš„æ‰€æœ‰è€…æƒç›Šï¼Œè´­ä¹°æ—¥åå­å…¬å¸èµšå–çš„å‡€åˆ©æ¶¦å¹¶æ²¡æœ‰æŠµæ¶ˆã€‚"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E8%AE%B2%E4%B9%89-%E7%AC%AC%E4%B8%80%E7%AB%A0/ itemprop=url class=post-title-link>åˆå¹¶æŠ¥è¡¨è®²ä¹‰-ç¬¬ä¸€ç« </a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AE%A1%E6%8A%80/ itemprop=url rel=index><span itemprop=name>å®¡æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=å†™åœ¨å‰é¢>å†™åœ¨å‰é¢ï¼š
<a class=header-anchor href=#%e5%86%99%e5%9c%a8%e5%89%8d%e9%9d%a2></a></h2><p>è¿™ç¯‡æ–‡ç« å¾ˆé•¿ï¼Œ1ä¸‡4åƒå­—ã€‚æ–‡ç« çš„ç›®çš„åœ¨äºæŒ‘æˆ˜ã€Šä¼ä¸šä¼šè®¡å‡†åˆ™åŠåº”ç”¨æŒ‡å—ã€‹ä¸­åˆå¹¶æŠµæ¶ˆåˆ†å½•çš„åšæ³•ï¼Œæ³¨ä¼šæ•™æä¸­çš„åšæ³•æ¥æºäºæŒ‡å—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘è¦æŒ‘æˆ˜â€œå®˜æ–¹â€åšæ³•ã€‚å®˜æ–¹çš„åšæ³•æ˜¯ï¼ŒæŠŠæˆæœ¬æ³•è½¬æ¢æˆæƒç›Šæ³•ï¼Œç„¶åå†æŠµæ¶ˆå­å…¬å¸çš„æ‰€æœ‰è€…æƒç›Šï¼Œæœ€åæŠµæ¶ˆæŠ•èµ„æ”¶ç›Šå’Œå­å…¬å¸çš„åˆ©æ¶¦åˆ†é…ã€‚â€œå®˜æ–¹â€çš„åšæ³•ç»™æˆ‘ä»¬ä¸€ç§å‡è±¡ï¼šå­å…¬å¸çš„æ‰€æœ‰è€…æƒç›Šè¢«æŠµæ¶ˆå®Œäº†ã€‚çœŸå®æƒ…å†µæ˜¯ï¼ŒåªæŠµæ¶ˆè´­ä¹°æ—¥å­å…¬å¸çš„æ‰€æœ‰è€…æƒç›Šï¼Œè´­ä¹°æ—¥åå­å…¬å¸èµšå–çš„å‡€åˆ©æ¶¦å¹¶æ²¡æœ‰æŠµæ¶ˆã€‚</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E8%AE%B2%E4%B9%89-%E7%AC%AC%E4%B8%80%E7%AB%A0/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E5%86%85%E9%83%A8%E6%8A%B5%E6%B6%88%E7%9A%84%E9%80%BB%E8%BE%91/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="åˆå¹¶æŠ¥è¡¨å†…éƒ¨æŠµæ¶ˆçš„é€»è¾‘"><meta itemprop=description content="åœ¨è¿™ä¸ªè®¡ç®—æœºæ—¶ä»£ï¼Œåˆå¹¶æŠ¥è¡¨ç¼–åˆ¶ä¾ç„¶è¿˜æ˜¯çº¯æ‰‹å·¥æ‰“é€ ã€‚æ—¢ç„¶æ˜¯çº¯æ‰‹å·¥æ‰“é€ ï¼Œå†…éƒ¨äº¤æ˜“æŠµæ¶ˆï¼ˆéæƒç›Šç±»ï¼‰è‡ªç„¶ä¹Ÿæ˜¯ç»å¸¸å®¹æ˜“å‡ºç°é”™è¯¯çš„åœ°æ–¹ï¼Œå°¤å…¶å¯¹äºåˆæ¬¡åšå†…éƒ¨æŠµæ¶ˆçš„ã€‚ä¸‹é¢ä»¥å­˜è´§ä¸ºä¾‹ã€‚"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E5%86%85%E9%83%A8%E6%8A%B5%E6%B6%88%E7%9A%84%E9%80%BB%E8%BE%91/ itemprop=url class=post-title-link>åˆå¹¶æŠ¥è¡¨å†…éƒ¨æŠµæ¶ˆçš„é€»è¾‘</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AE%A1%E6%8A%80/ itemprop=url rel=index><span itemprop=name>å®¡æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>åœ¨è¿™ä¸ªè®¡ç®—æœºæ—¶ä»£ï¼Œåˆå¹¶æŠ¥è¡¨ç¼–åˆ¶ä¾ç„¶è¿˜æ˜¯çº¯æ‰‹å·¥æ‰“é€ ã€‚æ—¢ç„¶æ˜¯çº¯æ‰‹å·¥æ‰“é€ ï¼Œå†…éƒ¨äº¤æ˜“æŠµæ¶ˆï¼ˆéæƒç›Šç±»ï¼‰è‡ªç„¶ä¹Ÿæ˜¯ç»å¸¸å®¹æ˜“å‡ºç°é”™è¯¯çš„åœ°æ–¹ï¼Œå°¤å…¶å¯¹äºåˆæ¬¡åšå†…éƒ¨æŠµæ¶ˆçš„ã€‚ä¸‹é¢ä»¥å­˜è´§ä¸ºä¾‹ã€‚</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E5%86%85%E9%83%A8%E6%8A%B5%E6%B6%88%E7%9A%84%E9%80%BB%E8%BE%91/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E6%9D%83%E7%9B%8A%E6%8A%B5%E6%B6%88%E7%9A%84%E9%80%BB%E8%BE%91/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="åˆå¹¶æŠ¥è¡¨æƒç›ŠæŠµæ¶ˆçš„é€»è¾‘"><meta itemprop=description content="2010å¹´ç¬¬ä¸€å¹´åšå®¡è®¡çš„æ—¶å€™ï¼Œé¡¹ç›®ç»ç†è¯´è¿‡ä¸€å¥è¯ï¼Œä¸€ç›´å°è±¡é¢‡æ·±ï¼Œâ€œåªæœ‰ä¼šç¼–åˆ¶åˆå¹¶æŠ¥è¡¨ï¼Œæ‰èƒ½ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„é¡¹ç›®ç»ç†â€ã€‚è¿™4å¹´ï¼ŒçœŸæ­£æ„ä¹‰ä¸Šçš„ç¼–åˆ¶åˆå¹¶æŠ¥è¡¨ï¼Œæ˜¯åœ¨è‡´åŒçš„ä¸€ä¸ªipoé¡¹ç›®ä¸ä¸€ä¸ªä¸Šå¸‚å…¬å¸å¹´å®¡é¡¹ç›®ï¼Œä¹Ÿå°±ç¼–åˆ¶è¿‡2å®¶ã€‚è¿™2å®¶å…¶å®è¿˜æ˜¯å¾ˆç®€å•ï¼ŒåŸºæœ¬éƒ½å…¨èµ„å­å…¬å¸ï¼Œæ›´æ²¡æœ‰ä¼ è¯´ä¸­çš„äº¤å‰æŒè‚¡ï¼Œä¹Ÿæ²¡æœ‰å‡ºå”®è‚¡æƒç­‰å¤æ‚é—®é¢˜ã€‚æˆ‘æƒ³æ•´ç†ä¸€äº›ä¸ªäººçš„çœ‹æ³•ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©æ²¡æœ‰ç¼–åˆ¶è¿‡çš„åŠ©ç†ä»¬æ›´å¥½ç†è§£å¦‚ä½•ç¼–åˆ¶åˆå¹¶æŠ¥è¡¨ï¼Œè€Œä¸æ˜¯ç®€å•çš„ç…§æ¬å…¬å¼ï¼ŒçœŸæ­£åšåˆ°ä¸€é€šç™¾é€šã€‚å½“ç„¶ï¼Œæˆ‘ä¼šå°½æœ€å¤§åŠªåŠ›æ•´ç†ä¸€ç³»åˆ—å¸¸è§çš„åˆå¹¶æŠ¥è¡¨é—®é¢˜ï¼Œæ¡ˆä¾‹ç›®å‰æ‰“ç®—æ¥è‡ªäºå››å¤§çš„ä¸€äº›èµ„æ–™ç¿»è¯‘æ•´ç†ã€è®¡å­¦æ’®è¦æ¡ˆä¾‹çš„å¼•ç”¨æ•´ç†ã€ä¼šè®¡è§†é‡è®ºå›çš„ä¸€äº›èµ„æ–™æ•´ç†ã€å¹³æ—¶å¸®äººè§£å†³çš„ä¸€äº›æ¡ˆä¾‹ç­‰ï¼Œè¿™é‡Œå°±ä¸æ ‡æ˜æ¥æºäº†ã€‚"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E6%9D%83%E7%9B%8A%E6%8A%B5%E6%B6%88%E7%9A%84%E9%80%BB%E8%BE%91/ itemprop=url class=post-title-link>åˆå¹¶æŠ¥è¡¨æƒç›ŠæŠµæ¶ˆçš„é€»è¾‘</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AE%A1%E6%8A%80/ itemprop=url rel=index><span itemprop=name>å®¡æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>2010å¹´ç¬¬ä¸€å¹´åšå®¡è®¡çš„æ—¶å€™ï¼Œé¡¹ç›®ç»ç†è¯´è¿‡ä¸€å¥è¯ï¼Œä¸€ç›´å°è±¡é¢‡æ·±ï¼Œâ€œåªæœ‰ä¼šç¼–åˆ¶åˆå¹¶æŠ¥è¡¨ï¼Œæ‰èƒ½ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„é¡¹ç›®ç»ç†â€ã€‚è¿™4å¹´ï¼ŒçœŸæ­£æ„ä¹‰ä¸Šçš„ç¼–åˆ¶åˆå¹¶æŠ¥è¡¨ï¼Œæ˜¯åœ¨è‡´åŒçš„ä¸€ä¸ªipoé¡¹ç›®ä¸ä¸€ä¸ªä¸Šå¸‚å…¬å¸å¹´å®¡é¡¹ç›®ï¼Œä¹Ÿå°±ç¼–åˆ¶è¿‡2å®¶ã€‚è¿™2å®¶å…¶å®è¿˜æ˜¯å¾ˆç®€å•ï¼ŒåŸºæœ¬éƒ½å…¨èµ„å­å…¬å¸ï¼Œæ›´æ²¡æœ‰ä¼ è¯´ä¸­çš„äº¤å‰æŒè‚¡ï¼Œä¹Ÿæ²¡æœ‰å‡ºå”®è‚¡æƒç­‰å¤æ‚é—®é¢˜ã€‚æˆ‘æƒ³æ•´ç†ä¸€äº›ä¸ªäººçš„çœ‹æ³•ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©æ²¡æœ‰ç¼–åˆ¶è¿‡çš„åŠ©ç†ä»¬æ›´å¥½ç†è§£å¦‚ä½•ç¼–åˆ¶åˆå¹¶æŠ¥è¡¨ï¼Œè€Œä¸æ˜¯ç®€å•çš„ç…§æ¬å…¬å¼ï¼ŒçœŸæ­£åšåˆ°ä¸€é€šç™¾é€šã€‚å½“ç„¶ï¼Œæˆ‘ä¼šå°½æœ€å¤§åŠªåŠ›æ•´ç†ä¸€ç³»åˆ—å¸¸è§çš„åˆå¹¶æŠ¥è¡¨é—®é¢˜ï¼Œæ¡ˆä¾‹ç›®å‰æ‰“ç®—æ¥è‡ªäºå››å¤§çš„ä¸€äº›èµ„æ–™ç¿»è¯‘æ•´ç†ã€è®¡å­¦æ’®è¦æ¡ˆä¾‹çš„å¼•ç”¨æ•´ç†ã€ä¼šè®¡è§†é‡è®ºå›çš„ä¸€äº›èµ„æ–™æ•´ç†ã€å¹³æ—¶å¸®äººè§£å†³çš„ä¸€äº›æ¡ˆä¾‹ç­‰ï¼Œè¿™é‡Œå°±ä¸æ ‡æ˜æ¥æºäº†ã€‚</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E6%9D%83%E7%9B%8A%E6%8A%B5%E6%B6%88%E7%9A%84%E9%80%BB%E8%BE%91/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E5%90%8C%E4%B8%80%E6%8E%A7%E5%88%B6%E7%9A%84%E6%9C%AC%E8%B4%A8/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="åˆå¹¶æŠ¥è¡¨åŒä¸€æ§åˆ¶çš„æœ¬è´¨"><meta itemprop=description content="åˆå¹¶è´¢åŠ¡æŠ¥è¡¨çš„ç¼–åˆ¶å¾€å¾€æ˜¯è®¸å¤šä¼šè®¡ä»ä¸šè€…çš„ä¸€ä¸ªéš¾ç‚¹ï¼Œè€ŒåŒä¸€æ§åˆ¶ä¼ä¸šåˆå¹¶å¾€å¾€ç”±äºç›®å‰è§„å®šä¸å¤ªæ¸…æ™°ï¼Œå¯¼è‡´è®¸å¤šä¼šè®¡ä»ä¸šè€…ä¹Ÿç»å¸¸æ— ä»ä¸‹æ‰‹ï¼Œå°¤å…¶å‡ºç°å‡†åˆ™å¹¶æ²¡æœ‰è§„å®šçš„ä¸æ¸…æ™°é¢†åŸŸï¼Œæ›´åŠ è¿·æƒ‘ã€‚åœ¨â€œå®ä½“ç†è®ºâ€è¶Šæ¥è¶Šç››è¡Œçš„ç°åœ¨ï¼Œç«™åœ¨é›†å›¢å±‚é¢å»ç†è§£åˆå¹¶è´¢åŠ¡æŠ¥è¡¨çš„æœ€ç»ˆå®è´¨å¯¹äºç¼–åˆ¶åˆå¹¶è´¢åŠ¡æŠ¥è¡¨å…·æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚æœ¬æ–‡è¯•å›¾ä»å¦ä¸€ä¸ªè§’åº¦å»é˜è¿°åŒä¸€æ§åˆ¶åˆå¹¶è´¢åŠ¡æŠ¥è¡¨çš„ç¼–åˆ¶ã€‚"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E5%90%8C%E4%B8%80%E6%8E%A7%E5%88%B6%E7%9A%84%E6%9C%AC%E8%B4%A8/ itemprop=url class=post-title-link>åˆå¹¶æŠ¥è¡¨åŒä¸€æ§åˆ¶çš„æœ¬è´¨</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AE%A1%E6%8A%80/ itemprop=url rel=index><span itemprop=name>å®¡æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>åˆå¹¶è´¢åŠ¡æŠ¥è¡¨çš„ç¼–åˆ¶å¾€å¾€æ˜¯è®¸å¤šä¼šè®¡ä»ä¸šè€…çš„ä¸€ä¸ªéš¾ç‚¹ï¼Œè€ŒåŒä¸€æ§åˆ¶ä¼ä¸šåˆå¹¶å¾€å¾€ç”±äºç›®å‰è§„å®šä¸å¤ªæ¸…æ™°ï¼Œå¯¼è‡´è®¸å¤šä¼šè®¡ä»ä¸šè€…ä¹Ÿç»å¸¸æ— ä»ä¸‹æ‰‹ï¼Œå°¤å…¶å‡ºç°å‡†åˆ™å¹¶æ²¡æœ‰è§„å®šçš„ä¸æ¸…æ™°é¢†åŸŸï¼Œæ›´åŠ è¿·æƒ‘ã€‚åœ¨â€œå®ä½“ç†è®ºâ€è¶Šæ¥è¶Šç››è¡Œçš„ç°åœ¨ï¼Œç«™åœ¨é›†å›¢å±‚é¢å»ç†è§£åˆå¹¶è´¢åŠ¡æŠ¥è¡¨çš„æœ€ç»ˆå®è´¨å¯¹äºç¼–åˆ¶åˆå¹¶è´¢åŠ¡æŠ¥è¡¨å…·æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚æœ¬æ–‡è¯•å›¾ä»å¦ä¸€ä¸ªè§’åº¦å»é˜è¿°åŒä¸€æ§åˆ¶åˆå¹¶è´¢åŠ¡æŠ¥è¡¨çš„ç¼–åˆ¶ã€‚</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E5%90%8C%E4%B8%80%E6%8E%A7%E5%88%B6%E7%9A%84%E6%9C%AC%E8%B4%A8/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E6%9C%80%E7%BB%88%E8%A7%86%E8%A7%92/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="åˆå¹¶æŠ¥è¡¨æœ€ç»ˆè§†è§’"><meta itemprop=description content="å¹´å‰æœ€åå‡ å¤©ï¼Œç¼–åˆ¶äº†ä¸€ä¸ªåˆå¹¶æŠ¥è¡¨ï¼Œæ¶‰åŠä¸œè¥¿å¾ˆå¤šï¼ŒæŒºæœ‰æ„Ÿè§¦çš„ã€‚
æˆ‘ç†è§£ï¼Œåˆå¹¶æŠ¥è¡¨ç¼–åˆ¶ï¼Œä¸»è¦éµå¾ªä¸¤ç‚¹ï¼š
1ï¼Œç¡®è®¤æœ€ç»ˆåˆå¹¶æ•ˆæœï¼Œç„¶åå€’è½§æŠµæ¶ˆåˆ†å½•ï¼›2ï¼Œæœç»æ¨¡æ‹Ÿæƒç›Šæ³•è¿˜åŸã€‚ç¬¬ä¸€ç‚¹çš„æ•ˆç‡å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç¬¬äºŒç‚¹ï¼Œä¸¤è€…ç†è§£äº†ï¼Œå¾ˆå¤šä»ä¸šäººå‘˜ç•æƒ§çš„æƒç›Šå˜åŠ¨è¡¨å‡ åˆ†é’Ÿäº‹æƒ…ã€‚"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E6%9C%80%E7%BB%88%E8%A7%86%E8%A7%92/ itemprop=url class=post-title-link>åˆå¹¶æŠ¥è¡¨æœ€ç»ˆè§†è§’</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AE%A1%E6%8A%80/ itemprop=url rel=index><span itemprop=name>å®¡æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>å¹´å‰æœ€åå‡ å¤©ï¼Œç¼–åˆ¶äº†ä¸€ä¸ªåˆå¹¶æŠ¥è¡¨ï¼Œæ¶‰åŠä¸œè¥¿å¾ˆå¤šï¼ŒæŒºæœ‰æ„Ÿè§¦çš„ã€‚</p><p>æˆ‘ç†è§£ï¼Œåˆå¹¶æŠ¥è¡¨ç¼–åˆ¶ï¼Œä¸»è¦éµå¾ªä¸¤ç‚¹ï¼š</p><p>1ï¼Œç¡®è®¤æœ€ç»ˆåˆå¹¶æ•ˆæœï¼Œç„¶åå€’è½§æŠµæ¶ˆåˆ†å½•ï¼›2ï¼Œæœç»æ¨¡æ‹Ÿæƒç›Šæ³•è¿˜åŸã€‚ç¬¬ä¸€ç‚¹çš„æ•ˆç‡å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç¬¬äºŒç‚¹ï¼Œä¸¤è€…ç†è§£äº†ï¼Œå¾ˆå¤šä»ä¸šäººå‘˜ç•æƒ§çš„æƒç›Šå˜åŠ¨è¡¨å‡ åˆ†é’Ÿäº‹æƒ…ã€‚</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E6%8A%A5%E8%A1%A8%E6%9C%80%E7%BB%88%E8%A7%86%E8%A7%92/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E9%99%84%E6%B3%A8%E8%AE%B2%E4%B9%89/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="åˆå¹¶é™„æ³¨è®²ä¹‰"><meta itemprop=description content="é¦–å…ˆï¼Œå°ç¼–è§è¿‡çš„åˆå¹¶é™„æ³¨æ ¼å¼æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯ï¼š
Â 
è¿™ç§æ ¼å¼è·Ÿä¸Šå¸‚å…¬å¸çš„å‚è€ƒæ ¼å¼ä¸€è‡´ï¼Œåªè¦åœ¨excelä¸ŠæŠŠæ•°å¡«å¥½ï¼Œå°±èƒ½ç›´æ¥æŠŠæ•´ä¸ªè¡¨æ ¼å¤åˆ¶ç²˜è´´åˆ°wordã€‚"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E9%99%84%E6%B3%A8%E8%AE%B2%E4%B9%89/ itemprop=url class=post-title-link>åˆå¹¶é™„æ³¨è®²ä¹‰</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AE%A1%E6%8A%80/ itemprop=url rel=index><span itemprop=name>å®¡æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>é¦–å…ˆï¼Œå°ç¼–è§è¿‡çš„åˆå¹¶é™„æ³¨æ ¼å¼æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯ï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://img.richfan.site/finance/accounting/%e5%90%88%e5%b9%b6%e9%99%84%e6%b3%a8/%e5%90%88%e5%b9%b6%e9%99%84%e6%b3%a8_1.webp alt>Â </p><p>è¿™ç§æ ¼å¼è·Ÿä¸Šå¸‚å…¬å¸çš„å‚è€ƒæ ¼å¼ä¸€è‡´ï¼Œåªè¦åœ¨excelä¸ŠæŠŠæ•°å¡«å¥½ï¼Œå°±èƒ½ç›´æ¥æŠŠæ•´ä¸ªè¡¨æ ¼å¤åˆ¶ç²˜è´´åˆ°wordã€‚</p></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E8%B4%A2%E6%8A%80/%E5%90%88%E5%B9%B6/%E5%90%88%E5%B9%B6%E9%99%84%E6%B3%A8%E8%AE%B2%E4%B9%89/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E7%A8%8B%E6%8A%80/sql/90_percent_contribution_goods/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="æ±‚å æ®å‰90%é”€å”®é¢çš„å•†å“ç±»å‹"><meta itemprop=description content="

  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144


-- æ±‚å æ®å‰90%é”€å”®é¢çš„å•†å“ç±»å‹
-- step0. å‡†å¤‡æ•°æ®
create table cm.tb_sale_amount(
    good_category int comment 'å•†å“ç±»å‹ID',
    sale_date date comment 'é”€å”®æ—¥æœŸ',
    amount int comment 'é”€å”®é¢',
    primary key(good_category, sale_date)
);


truncate cm.tb_sale_amount;

insert into cm.tb_sale_amount
(good_category, sale_date, amount) values
(1003, '2022-01-10', 264),
(1001, '2022-06-01', 21),
(1005, '2022-06-01', 73),
(1002, '2022-06-27', 44),
(1006, '2022-06-27', 405),
(1003, '2022-09-10', 16),
(1005, '2022-09-13', 72),
(1004, '2022-10-01', 29),
(1005, '2022-10-03', 332),
(1001, '2022-10-29', 10),
(1006, '2022-10-29', 137),
(1002, '2022-12-02', 23),
(1007, '2022-12-02', 19),
(1003, '2022-12-02', 30),
(1008, '2022-12-03', 3),
(1009, '2022-12-04', 1),
(1010, '2022-12-05', 9),
(1003, '2022-12-30', 121);

-- step1. è®¡ç®—æ¯ç§å•†å“çš„æ€»é”€å”®é¢ï¼Œå¹¶é™åºæ’åº
select
    good_category,
    sum(amount) as good_amount
from cm.tb_sale_amount
group by good_category
order by good_amount desc;

-- step2. æ±‚å…¨éƒ¨å•†å“çš„æ€»é”€å”®é¢ï¼Œä¸ºäº†step3æ±‚å„ç§å•†å“çš„å æ¯”ï¼Œéœ€è¦å…ˆæ±‚å’Œã€‚æ³¨æ„ï¼šæ±‚æ€»å’Œæ—¶ï¼Œçª—å£å€¼æ—¢ä¸æ’åºä¹Ÿä¸è¿›è¡Œåˆ†ç»„
select
    *,
    sum(good_amount) over () as all_amount
from
    (select
        good_category,
        sum(amount) as good_amount
    from cm.tb_sale_amount
    group by good_category
    order by good_amount desc
    ) t1;

-- step3. æ±‚å æ¯”
select
    *,
    good_amount * 1.0 / all_amount as ratio
from (select
          *,
          sum(good_amount) over () as all_amount
      from (select
                good_category,
                sum(amount) as good_amount
            from cm.tb_sale_amount
            group by good_category
            order by good_amount desc
            ) as t1
      ) t2;

-- step4. æ±‚ç´¯è®¡å æ¯”ï¼Œæ³¨æ„ï¼šæ±‚ç´¯è®¡å€¼æ—¶ï¼Œä¸€å®šè¦è¿›è¡Œæ’åº
select
    *,
    sum(ratio) over (order by ratio desc) as acc_ratio
from(
    select
        *,
        good_amount * 1.0 / all_amount as ratio
    from (select
              *,
              sum(good_amount) over () as all_amount
            from (select
                    good_category,
                    sum(amount) as good_amount
                from cm.tb_sale_amount
                group by good_category
                order by good_amount desc
            ) as t1
        ) t2
    ) t3;

-- step5. æ±‚å‰ä¸€è¡Œçš„ç´¯è®¡å æ¯”
select
    *,
    lag(acc_ratio) over() as pre_acc_ratio
from(select
         *,
       sum(ratio) over (order by ratio desc) as acc_ratio
    from(
        select
            *,
            good_amount * 1.0 / all_amount as ratio
        from (select
                  *,
                  sum(good_amount) over () as all_amount
              from (select
                        good_category,
                        sum(amount) as good_amount
                    from cm.tb_sale_amount
                    group by good_category
                    order by good_amount desc
                ) t1
            ) t2
        ) t3
    ) t4;

-- step6. è¿‡æ»¤
select *
from (
    select
    *,
    lag(acc_ratio) over() as pre_acc_ratio
from(select
         *,
       sum(ratio) over (order by ratio desc) as acc_ratio
     from(
        select
            *,
            good_amount * 1.0 / all_amount as ratio
        from (select
                  *,
                  sum(good_amount) over () as all_amount
              from (select
                        good_category,
                        sum(amount) as good_amount
                    from cm.tb_sale_amount
                    group by good_category
                    order by good_amount desc
                )  t1
              ) t2
        ) t3
    ) t4
) t5
where pre_acc_ratio IS NULL or pre_acc_ratio < 0.90;

"></span><header class=post-header><h2 class=post-title itemprop="name headline"><a href=/post/%E7%A8%8B%E6%8A%80/sql/90_percent_contribution_goods/ itemprop=url class=post-title-link>æ±‚å æ®å‰90%é”€å”®é¢çš„å•†å“ç±»å‹</a></h2><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-01 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-08-01 00:00:00 +0000 UTC">2023-08-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E7%A8%8B%E6%8A%80/ itemprop=url rel=index><span itemprop=name>ç¨‹æŠ€</span></a></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>  1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>  2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>  3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>  4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>  5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>  6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7>  7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8>  8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9>  9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10> 10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11> 11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12> 12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13> 13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14> 14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15> 15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16> 16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17> 17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18> 18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19> 19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20> 20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21> 21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22> 22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23> 23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24> 24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25> 25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26> 26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27> 27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28> 28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29> 29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30> 30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31> 31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32> 32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33> 33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34> 34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35> 35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36> 36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37> 37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38> 38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39> 39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40> 40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41> 41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42> 42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43> 43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44> 44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45> 45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46> 46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47> 47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48> 48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49> 49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50> 50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51> 51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52> 52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53> 53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54> 54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55> 55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56> 56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57> 57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58> 58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59> 59</a>
</span><span class=lnt id=hl-0-60><a class=lnlinks href=#hl-0-60> 60</a>
</span><span class=lnt id=hl-0-61><a class=lnlinks href=#hl-0-61> 61</a>
</span><span class=lnt id=hl-0-62><a class=lnlinks href=#hl-0-62> 62</a>
</span><span class=lnt id=hl-0-63><a class=lnlinks href=#hl-0-63> 63</a>
</span><span class=lnt id=hl-0-64><a class=lnlinks href=#hl-0-64> 64</a>
</span><span class=lnt id=hl-0-65><a class=lnlinks href=#hl-0-65> 65</a>
</span><span class=lnt id=hl-0-66><a class=lnlinks href=#hl-0-66> 66</a>
</span><span class=lnt id=hl-0-67><a class=lnlinks href=#hl-0-67> 67</a>
</span><span class=lnt id=hl-0-68><a class=lnlinks href=#hl-0-68> 68</a>
</span><span class=lnt id=hl-0-69><a class=lnlinks href=#hl-0-69> 69</a>
</span><span class=lnt id=hl-0-70><a class=lnlinks href=#hl-0-70> 70</a>
</span><span class=lnt id=hl-0-71><a class=lnlinks href=#hl-0-71> 71</a>
</span><span class=lnt id=hl-0-72><a class=lnlinks href=#hl-0-72> 72</a>
</span><span class=lnt id=hl-0-73><a class=lnlinks href=#hl-0-73> 73</a>
</span><span class=lnt id=hl-0-74><a class=lnlinks href=#hl-0-74> 74</a>
</span><span class=lnt id=hl-0-75><a class=lnlinks href=#hl-0-75> 75</a>
</span><span class=lnt id=hl-0-76><a class=lnlinks href=#hl-0-76> 76</a>
</span><span class=lnt id=hl-0-77><a class=lnlinks href=#hl-0-77> 77</a>
</span><span class=lnt id=hl-0-78><a class=lnlinks href=#hl-0-78> 78</a>
</span><span class=lnt id=hl-0-79><a class=lnlinks href=#hl-0-79> 79</a>
</span><span class=lnt id=hl-0-80><a class=lnlinks href=#hl-0-80> 80</a>
</span><span class=lnt id=hl-0-81><a class=lnlinks href=#hl-0-81> 81</a>
</span><span class=lnt id=hl-0-82><a class=lnlinks href=#hl-0-82> 82</a>
</span><span class=lnt id=hl-0-83><a class=lnlinks href=#hl-0-83> 83</a>
</span><span class=lnt id=hl-0-84><a class=lnlinks href=#hl-0-84> 84</a>
</span><span class=lnt id=hl-0-85><a class=lnlinks href=#hl-0-85> 85</a>
</span><span class=lnt id=hl-0-86><a class=lnlinks href=#hl-0-86> 86</a>
</span><span class=lnt id=hl-0-87><a class=lnlinks href=#hl-0-87> 87</a>
</span><span class=lnt id=hl-0-88><a class=lnlinks href=#hl-0-88> 88</a>
</span><span class=lnt id=hl-0-89><a class=lnlinks href=#hl-0-89> 89</a>
</span><span class=lnt id=hl-0-90><a class=lnlinks href=#hl-0-90> 90</a>
</span><span class=lnt id=hl-0-91><a class=lnlinks href=#hl-0-91> 91</a>
</span><span class=lnt id=hl-0-92><a class=lnlinks href=#hl-0-92> 92</a>
</span><span class=lnt id=hl-0-93><a class=lnlinks href=#hl-0-93> 93</a>
</span><span class=lnt id=hl-0-94><a class=lnlinks href=#hl-0-94> 94</a>
</span><span class=lnt id=hl-0-95><a class=lnlinks href=#hl-0-95> 95</a>
</span><span class=lnt id=hl-0-96><a class=lnlinks href=#hl-0-96> 96</a>
</span><span class=lnt id=hl-0-97><a class=lnlinks href=#hl-0-97> 97</a>
</span><span class=lnt id=hl-0-98><a class=lnlinks href=#hl-0-98> 98</a>
</span><span class=lnt id=hl-0-99><a class=lnlinks href=#hl-0-99> 99</a>
</span><span class=lnt id=hl-0-100><a class=lnlinks href=#hl-0-100>100</a>
</span><span class=lnt id=hl-0-101><a class=lnlinks href=#hl-0-101>101</a>
</span><span class=lnt id=hl-0-102><a class=lnlinks href=#hl-0-102>102</a>
</span><span class=lnt id=hl-0-103><a class=lnlinks href=#hl-0-103>103</a>
</span><span class=lnt id=hl-0-104><a class=lnlinks href=#hl-0-104>104</a>
</span><span class=lnt id=hl-0-105><a class=lnlinks href=#hl-0-105>105</a>
</span><span class=lnt id=hl-0-106><a class=lnlinks href=#hl-0-106>106</a>
</span><span class=lnt id=hl-0-107><a class=lnlinks href=#hl-0-107>107</a>
</span><span class=lnt id=hl-0-108><a class=lnlinks href=#hl-0-108>108</a>
</span><span class=lnt id=hl-0-109><a class=lnlinks href=#hl-0-109>109</a>
</span><span class=lnt id=hl-0-110><a class=lnlinks href=#hl-0-110>110</a>
</span><span class=lnt id=hl-0-111><a class=lnlinks href=#hl-0-111>111</a>
</span><span class=lnt id=hl-0-112><a class=lnlinks href=#hl-0-112>112</a>
</span><span class=lnt id=hl-0-113><a class=lnlinks href=#hl-0-113>113</a>
</span><span class=lnt id=hl-0-114><a class=lnlinks href=#hl-0-114>114</a>
</span><span class=lnt id=hl-0-115><a class=lnlinks href=#hl-0-115>115</a>
</span><span class=lnt id=hl-0-116><a class=lnlinks href=#hl-0-116>116</a>
</span><span class=lnt id=hl-0-117><a class=lnlinks href=#hl-0-117>117</a>
</span><span class=lnt id=hl-0-118><a class=lnlinks href=#hl-0-118>118</a>
</span><span class=lnt id=hl-0-119><a class=lnlinks href=#hl-0-119>119</a>
</span><span class=lnt id=hl-0-120><a class=lnlinks href=#hl-0-120>120</a>
</span><span class=lnt id=hl-0-121><a class=lnlinks href=#hl-0-121>121</a>
</span><span class=lnt id=hl-0-122><a class=lnlinks href=#hl-0-122>122</a>
</span><span class=lnt id=hl-0-123><a class=lnlinks href=#hl-0-123>123</a>
</span><span class=lnt id=hl-0-124><a class=lnlinks href=#hl-0-124>124</a>
</span><span class=lnt id=hl-0-125><a class=lnlinks href=#hl-0-125>125</a>
</span><span class=lnt id=hl-0-126><a class=lnlinks href=#hl-0-126>126</a>
</span><span class=lnt id=hl-0-127><a class=lnlinks href=#hl-0-127>127</a>
</span><span class=lnt id=hl-0-128><a class=lnlinks href=#hl-0-128>128</a>
</span><span class=lnt id=hl-0-129><a class=lnlinks href=#hl-0-129>129</a>
</span><span class=lnt id=hl-0-130><a class=lnlinks href=#hl-0-130>130</a>
</span><span class=lnt id=hl-0-131><a class=lnlinks href=#hl-0-131>131</a>
</span><span class=lnt id=hl-0-132><a class=lnlinks href=#hl-0-132>132</a>
</span><span class=lnt id=hl-0-133><a class=lnlinks href=#hl-0-133>133</a>
</span><span class=lnt id=hl-0-134><a class=lnlinks href=#hl-0-134>134</a>
</span><span class=lnt id=hl-0-135><a class=lnlinks href=#hl-0-135>135</a>
</span><span class=lnt id=hl-0-136><a class=lnlinks href=#hl-0-136>136</a>
</span><span class=lnt id=hl-0-137><a class=lnlinks href=#hl-0-137>137</a>
</span><span class=lnt id=hl-0-138><a class=lnlinks href=#hl-0-138>138</a>
</span><span class=lnt id=hl-0-139><a class=lnlinks href=#hl-0-139>139</a>
</span><span class=lnt id=hl-0-140><a class=lnlinks href=#hl-0-140>140</a>
</span><span class=lnt id=hl-0-141><a class=lnlinks href=#hl-0-141>141</a>
</span><span class=lnt id=hl-0-142><a class=lnlinks href=#hl-0-142>142</a>
</span><span class=lnt id=hl-0-143><a class=lnlinks href=#hl-0-143>143</a>
</span><span class=lnt id=hl-0-144><a class=lnlinks href=#hl-0-144>144</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- æ±‚å æ®å‰90%é”€å”®é¢çš„å•†å“ç±»å‹
</span></span></span><span class=line><span class=cl><span class=c1>-- step0. å‡†å¤‡æ•°æ®
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>good_category</span><span class=w> </span><span class=nb>int</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;å•†å“ç±»å‹ID&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sale_date</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;é”€å”®æ—¥æœŸ&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>amount</span><span class=w> </span><span class=nb>int</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;é”€å”®é¢&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>primary</span><span class=w> </span><span class=k>key</span><span class=p>(</span><span class=n>good_category</span><span class=p>,</span><span class=w> </span><span class=n>sale_date</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>truncate</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=n>good_category</span><span class=p>,</span><span class=w> </span><span class=n>sale_date</span><span class=p>,</span><span class=w> </span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-01-10&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>264</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1001</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-06-01&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>21</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1005</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-06-01&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>73</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-06-27&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>44</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1006</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-06-27&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>405</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-09-10&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>16</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1005</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-09-13&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>72</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1004</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-01&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>29</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1005</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-03&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>332</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1001</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-29&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>10</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1006</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-10-29&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>137</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1002</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-12-02&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>23</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1007</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-12-02&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>19</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-12-02&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>30</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1008</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-12-03&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1009</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-12-04&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1010</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-12-05&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>9</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1003</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;2022-12-30&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>121</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step1. è®¡ç®—æ¯ç§å•†å“çš„æ€»é”€å”®é¢ï¼Œå¹¶é™åºæ’åº
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>good_category</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>good_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_category</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_amount</span><span class=w> </span><span class=k>desc</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step2. æ±‚å…¨éƒ¨å•†å“çš„æ€»é”€å”®é¢ï¼Œä¸ºäº†step3æ±‚å„ç§å•†å“çš„å æ¯”ï¼Œéœ€è¦å…ˆæ±‚å’Œã€‚æ³¨æ„ï¼šæ±‚æ€»å’Œæ—¶ï¼Œçª—å£å€¼æ—¢ä¸æ’åºä¹Ÿä¸è¿›è¡Œåˆ†ç»„
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>good_amount</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>all_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>good_category</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>sum</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>good_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_category</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_amount</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=n>t1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step3. æ±‚å æ¯”
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>good_amount</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>all_amount</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=k>sum</span><span class=p>(</span><span class=n>good_amount</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>all_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>good_category</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>sum</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>good_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_category</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_amount</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>t1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=n>t2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step4. æ±‚ç´¯è®¡å æ¯”ï¼Œæ³¨æ„ï¼šæ±‚ç´¯è®¡å€¼æ—¶ï¼Œä¸€å®šè¦è¿›è¡Œæ’åº
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>sum</span><span class=p>(</span><span class=n>ratio</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>(</span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>ratio</span><span class=w> </span><span class=k>desc</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>acc_ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>good_amount</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>all_amount</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=k>sum</span><span class=p>(</span><span class=n>good_amount</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>all_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>good_category</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>sum</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>good_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_category</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_amount</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>t1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=n>t2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=n>t3</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step5. æ±‚å‰ä¸€è¡Œçš„ç´¯è®¡å æ¯”
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>lag</span><span class=p>(</span><span class=n>acc_ratio</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>pre_acc_ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>sum</span><span class=p>(</span><span class=n>ratio</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>(</span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>ratio</span><span class=w> </span><span class=k>desc</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>acc_ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>from</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>good_amount</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>all_amount</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=k>sum</span><span class=p>(</span><span class=n>good_amount</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>all_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=n>good_category</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=k>sum</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>good_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_category</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_amount</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>)</span><span class=w> </span><span class=n>t1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)</span><span class=w> </span><span class=n>t2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=n>t3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=n>t4</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- step6. è¿‡æ»¤
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>lag</span><span class=p>(</span><span class=n>acc_ratio</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>pre_acc_ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>sum</span><span class=p>(</span><span class=n>ratio</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>(</span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>ratio</span><span class=w> </span><span class=k>desc</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>acc_ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=k>from</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>good_amount</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>all_amount</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=o>*</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=k>sum</span><span class=p>(</span><span class=n>good_amount</span><span class=p>)</span><span class=w> </span><span class=n>over</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>all_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=n>good_category</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=k>sum</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>good_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>from</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>tb_sale_amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_category</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>good_amount</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>)</span><span class=w>  </span><span class=n>t1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=p>)</span><span class=w> </span><span class=n>t2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=n>t3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=n>t4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>t5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=n>pre_acc_ratio</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>pre_acc_ratio</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>90</span><span class=p>;</span></span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><div class=post-button><a class=btn href=/post/%E7%A8%8B%E6%8A%80/sql/90_percent_contribution_goods/#more rel=contents>é˜…è¯»å…¨æ–‡ &#187;</a></div><div class=post-eof></div></footer></article></div><nav class=pagination><a class="extend prev" rel=prev href=/page/40/><i class="fa fa-angle-left"></i>
</a><a class=page-number href=/page/37/>37</a>
<a class=page-number href=/page/38/>38</a>
<a class=page-number href=/page/39/>39</a>
<a class=page-number href=/page/40/>40</a>
<span class="page-number current">41</span>
<a class=page-number href=/page/42/>42</a>
<a class=page-number href=/page/43/>43</a>
<a class=page-number href=/page/44/>44</a>
<a class=page-number href=/page/45/>45</a>
<a class="extend next" rel=next href=/page/42/><i class="fa fa-angle-right"></i></a></nav></div></main><footer class=footer><div class=footer-inner><div id=i18n-translate class=i18n-translate><i class="fa fa-language"></i><div id=lang-select class=lang-select><div id=lang-selected class=selected-option><span class="flag-icon flag-icon-zh-cn"></span>
<span class=selected-language>ç®€ä½“ä¸­æ–‡</span>
<i class="fa fa-chevron-down"></i></div><div id=lang-options class=lang-options><div class=lang-option lang-code=zh-cn lang-name=ç®€ä½“ä¸­æ–‡ lang-url=/><span class="flag-icon flag-icon-zh-cn"></span>
<span class=lang-name>ç®€ä½“ä¸­æ–‡</span></div><div class=lang-option lang-code=en-us lang-name=English lang-url=/en-us/><span class="flag-icon flag-icon-en-us"></span>
<span class=lang-name>English</span></div></div></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2020 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rich</span></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":false,"expired":false,"isHome":true,"isPage":false,"path":"localhost:1313","permalink":"//localhost:1313/","title":"æ¨Šå°˜åˆ¹è®°","toc":true,"waline":{"commentcnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/comment.js","name":"comment","version":"2.15.8"}}}</script><script type=text/javascript src=//localhost:1313/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=//localhost:1313/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"hostname":"//localhost:1313/","i18n":{"ds_day":" å¤©å‰","ds_days":" å¤© ","ds_hour":" å°æ—¶å‰","ds_hours":" å°æ—¶ ","ds_just":"åˆšåˆš","ds_min":" åˆ†é’Ÿå‰","ds_mins":" åˆ†é’Ÿ","ds_month":" ä¸ªæœˆå‰","ds_years":" å¹´ ","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","placeholder":"æœç´¢..."},"isMultiLang":true,"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"slideInRight","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":true},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"//localhost:1313/js/3rd"}},"version":"4.8.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"è¯·æ–‡æ˜å‘è¨€å“Ÿ ãƒ¾(â‰§â–½â‰¦*)o","reaction":true,"reactiontext":["ç‚¹èµ","è¸©ä¸€ä¸‹","å¾—æ„","ä¸å±‘","å°´å°¬","ç¡è§‰"],"reactiontitle":"ä½ è®¤ä¸ºè¿™ç¯‡æ–‡ç« æ€ä¹ˆæ ·ï¼Ÿ","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"å¿«æ¥å‘è¡¨ä½ çš„æ„è§å§ (â‰§âˆ€â‰¦)ã‚","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.js?=1750131040" defer></script></body></html>