<!doctype html><html lang=zh-CN data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.147.7"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="第八章 数据规整：聚合、合并和重塑"><meta itemprop=description content="保持简单的易用性和强大的功能。"><meta name=description content="保持简单的易用性和强大的功能。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=keywords content="python"><meta property="og:type" content="article"><meta property="og:title" content="第八章 数据规整：聚合、合并和重塑"><meta property="og:description" content="保持简单的易用性和强大的功能。"><meta property="og:image" content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="//localhost:1313/chinese/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91/"><meta property="og:site_name" content="樊尘刹记"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rich"><meta property="article:published_time" content="2023-09-25 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2023-09-25 00:00:00 +0000 UTC"><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.css?=1750130235"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><link rel=stylesheet type=text/css href="/css/custom_style.css?=1750130235"><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>第八章 数据规整：聚合、合并和重塑 - 樊尘刹记</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>樊尘刹记</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>红尘湮灭，唯有尘刹</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-example"><a href=/ class="menus-parent hvr-icon-pulse" rel=section><i class="fa fa-angles-down hvr-icon"></i>语法示例
<span class=menu-item-shrink-icon><i class="fa fa-angle-right"></i></span></a><ul class=menu-children><li class=menu-child-item><a href=/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>语法高亮</a></li><li class=menu-child-item><a href=/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>数学公式</a></li><li class=menu-child-item><a href=/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>流程图</a></li></ul></li><li class="menu-item menu-item-archives"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>0</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#81-层次化索引>8.1 层次化索引</a><ul><li><a href=#811-重排与分级排序>8.1.1 重排与分级排序</a></li><li><a href=#812-根据级别汇总统计>8.1.2 根据级别汇总统计</a></li><li><a href=#813-使用dataframe的列进行索引>8.1.3 使用DataFrame的列进行索引</a></li></ul></li><li><a href=#82-合并数据集>8.2 合并数据集</a><ul><li><a href=#821-数据库风格的dataframe合并>8.2.1 数据库风格的DataFrame合并</a></li><li><a href=#822-索引上的合并>8.2.2 索引上的合并</a></li><li><a href=#823-轴向连接>8.2.3 轴向连接</a></li><li><a href=#824-合并重叠数据>8.2.4 合并重叠数据</a></li></ul></li><li><a href=#83-重塑和轴向旋转>8.3 重塑和轴向旋转</a><ul><li><a href=#831-重塑层次化索引>8.3.1 重塑层次化索引</a></li><li><a href=#832-将长格式旋转为宽格式>8.3.2 将“长格式”旋转为“宽格式”</a></li><li><a href=#833-将宽格式旋转为长格式>8.3.3 将“宽格式”旋转为“长格式”</a></li></ul></li><li><a href=#84-总结>8.4 总结</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rich src=/imgs/img-lazy-loading.gif data-src=https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif><p class=site-author-name itemprop=name>Rich</p><div class=site-description itemprop=description>保持简单的易用性和强大的功能。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>8</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>99</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/richbridge title="Github → https://github.com/richbridge" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/richfan-38 title="知乎 → https://www.zhihu.com/people/richfan-38" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div><div class="mydefined animated" itemprop=custom><span>支持自定义CSS和Sidebar布局啦💄💄💄</span></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-i18n-translate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/richbridge rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/chinese/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="保持简单的易用性和强大的功能。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="第八章 数据规整：聚合、合并和重塑"><meta itemprop=description content="在许多应用中，数据可能分散在许多文件或数据库中，存储的形式也不利于分析。本章关注可以聚合、合并、重塑数据的方法。
首先，我会介绍pandas的层次化索引，它广泛用于以上操作。然后，我深入介绍了一些特殊的数据操作。在第14章，你可以看到这些工具的多种应用。"></span><header class=post-header><h1 class=post-title itemprop="name headline">第八章 数据规整：聚合、合并和重塑</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2023-09-25 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-09-25 00:00:00 +0000 UTC">2023-09-25
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E7%A8%8B%E6%8A%80/ itemprop=url rel=index><span itemprop=name>程技</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>10119</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>21分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/chinese/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>在许多应用中，数据可能分散在许多文件或数据库中，存储的形式也不利于分析。本章关注可以聚合、合并、重塑数据的方法。</p><p>首先，我会介绍pandas的层次化索引，它广泛用于以上操作。然后，我深入介绍了一些特殊的数据操作。在第14章，你可以看到这些工具的多种应用。</p><a id=more></a><h2 id=81-层次化索引>8.1 层次化索引
<a class=header-anchor href=#81-%e5%b1%82%e6%ac%a1%e5%8c%96%e7%b4%a2%e5%bc%95></a></h2><p>层次化索引（hierarchical indexing）是pandas的一项重要功能，它使你能在一个轴上拥有多个（两个以上）索引级别。抽象点说，它使你能以低维度形式处理高维度数据。我们先来看一个简单的例子：创建一个Series，并用一个由列表或数组组成的列表作为索引：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>9</span><span class=p>]:</span> <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>9</span><span class=p>),</span>
</span></span><span class=line><span class=cl>   <span class=o>...</span><span class=p>:</span>                  <span class=n>index</span><span class=o>=</span><span class=p>[[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>...</span><span class=p>:</span>                         <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>10</span><span class=p>]:</span> <span class=n>data</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>10</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>a</span>  <span class=mi>1</span>   <span class=o>-</span><span class=mf>0.204708</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>    <span class=mf>0.478943</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>   <span class=o>-</span><span class=mf>0.519439</span>
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mi>1</span>   <span class=o>-</span><span class=mf>0.555730</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mf>1.965781</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=mi>1</span>    <span class=mf>1.393406</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>    <span class=mf>0.092908</span>
</span></span><span class=line><span class=cl><span class=n>d</span>  <span class=mi>2</span>    <span class=mf>0.281746</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mf>0.769023</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span></span></span></code></pre></td></tr></table></div></div><p>看到的结果是经过美化的带有MultiIndex索引的Series的格式。索引之间的“间隔”表示“直接使用上面的标签”：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>11</span><span class=p>]:</span> <span class=n>data</span><span class=o>.</span><span class=n>index</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>11</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>MultiIndex</span><span class=p>(</span><span class=n>levels</span><span class=o>=</span><span class=p>[[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>           <span class=n>labels</span><span class=o>=</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]])</span></span></span></code></pre></td></tr></table></div></div><p>对于一个层次化索引的对象，可以使用所谓的部分索引，使用它选取数据子集的操作更简单：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>12</span><span class=p>]:</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>12</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=o>-</span><span class=mf>0.555730</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>    <span class=mf>1.965781</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>13</span><span class=p>]:</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>:</span><span class=s1>&#39;c&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>13</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mi>1</span>   <span class=o>-</span><span class=mf>0.555730</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mf>1.965781</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=mi>1</span>    <span class=mf>1.393406</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>    <span class=mf>0.092908</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>14</span><span class=p>]:</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[[</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>14</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mi>1</span>   <span class=o>-</span><span class=mf>0.555730</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mf>1.965781</span>
</span></span><span class=line><span class=cl><span class=n>d</span>  <span class=mi>2</span>    <span class=mf>0.281746</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mf>0.769023</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span></span></span></code></pre></td></tr></table></div></div><p>有时甚至还可以在“内层”中进行选取：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>15</span><span class=p>]:</span> <span class=n>data</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>15</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mf>0.478943</span>
</span></span><span class=line><span class=cl><span class=n>c</span>    <span class=mf>0.092908</span>
</span></span><span class=line><span class=cl><span class=n>d</span>    <span class=mf>0.281746</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span></span></span></code></pre></td></tr></table></div></div><p>层次化索引在数据重塑和基于分组的操作（如透视表生成）中扮演着重要的角色。例如，可以通过unstack方法将这段数据重新安排到一个DataFrame中：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>16</span><span class=p>]:</span> <span class=n>data</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>16</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>          <span class=mi>1</span>         <span class=mi>2</span>         <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>-</span><span class=mf>0.204708</span>  <span class=mf>0.478943</span> <span class=o>-</span><span class=mf>0.519439</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>-</span><span class=mf>0.555730</span>       <span class=n>NaN</span>  <span class=mf>1.965781</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=mf>1.393406</span>  <span class=mf>0.092908</span>       <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>d</span>       <span class=n>NaN</span>  <span class=mf>0.281746</span>  <span class=mf>0.769023</span></span></span></code></pre></td></tr></table></div></div><p>unstack的逆运算是stack：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>17</span><span class=p>]:</span> <span class=n>data</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span><span class=o>.</span><span class=n>stack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>17</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>a</span>  <span class=mi>1</span>   <span class=o>-</span><span class=mf>0.204708</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>    <span class=mf>0.478943</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>   <span class=o>-</span><span class=mf>0.519439</span>
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mi>1</span>   <span class=o>-</span><span class=mf>0.555730</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mf>1.965781</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=mi>1</span>    <span class=mf>1.393406</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>    <span class=mf>0.092908</span>
</span></span><span class=line><span class=cl><span class=n>d</span>  <span class=mi>2</span>    <span class=mf>0.281746</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>    <span class=mf>0.769023</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span></span></span></code></pre></td></tr></table></div></div><p>stack和unstack将在本章后面详细讲解。</p><p>对于一个DataFrame，每条轴都可以有分层索引：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>18</span><span class=p>]:</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>12</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                      <span class=n>index</span><span class=o>=</span><span class=p>[[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                      <span class=n>columns</span><span class=o>=</span><span class=p>[[</span><span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Colorado&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                               <span class=p>[</span><span class=s1>&#39;Green&#39;</span><span class=p>,</span> <span class=s1>&#39;Red&#39;</span><span class=p>,</span> <span class=s1>&#39;Green&#39;</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>19</span><span class=p>]:</span> <span class=n>frame</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>19</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>     <span class=n>Ohio</span>     <span class=n>Colorado</span>
</span></span><span class=line><span class=cl>    <span class=n>Green</span> <span class=n>Red</span>    <span class=n>Green</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=mi>1</span>     <span class=mi>0</span>   <span class=mi>1</span>        <span class=mi>2</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>     <span class=mi>3</span>   <span class=mi>4</span>        <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=mi>1</span>     <span class=mi>6</span>   <span class=mi>7</span>        <span class=mi>8</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>     <span class=mi>9</span>  <span class=mi>10</span>       <span class=mi>11</span></span></span></code></pre></td></tr></table></div></div><p>各层都可以有名字（可以是字符串，也可以是别的Python对象）。如果指定了名称，它们就会显示在控制台输出中：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>20</span><span class=p>]:</span> <span class=n>frame</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>names</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;key1&#39;</span><span class=p>,</span> <span class=s1>&#39;key2&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>21</span><span class=p>]:</span> <span class=n>frame</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>names</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>,</span> <span class=s1>&#39;color&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>22</span><span class=p>]:</span> <span class=n>frame</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>22</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>      <span class=n>Ohio</span>     <span class=n>Colorado</span>
</span></span><span class=line><span class=cl><span class=n>color</span>     <span class=n>Green</span> <span class=n>Red</span>    <span class=n>Green</span>
</span></span><span class=line><span class=cl><span class=n>key1</span> <span class=n>key2</span>                   
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mi>1</span>        <span class=mi>0</span>   <span class=mi>1</span>        <span class=mi>2</span>
</span></span><span class=line><span class=cl>     <span class=mi>2</span>        <span class=mi>3</span>   <span class=mi>4</span>        <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mi>1</span>        <span class=mi>6</span>   <span class=mi>7</span>        <span class=mi>8</span>
</span></span><span class=line><span class=cl>     <span class=mi>2</span>        <span class=mi>9</span>  <span class=mi>10</span>       <span class=mi>11</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>注意：小心区分索引名state、color与行标签。</p></blockquote><p>有了部分列索引，因此可以轻松选取列分组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>23</span><span class=p>]:</span> <span class=n>frame</span><span class=p>[</span><span class=s1>&#39;Ohio&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>23</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>color</span>      <span class=n>Green</span>  <span class=n>Red</span>
</span></span><span class=line><span class=cl><span class=n>key1</span> <span class=n>key2</span>            
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mi>1</span>         <span class=mi>0</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl>     <span class=mi>2</span>         <span class=mi>3</span>    <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mi>1</span>         <span class=mi>6</span>    <span class=mi>7</span>
</span></span><span class=line><span class=cl>     <span class=mi>2</span>         <span class=mi>9</span>   <span class=mi>10</span></span></span></code></pre></td></tr></table></div></div><p>可以单独创建MultiIndex然后复用。上面那个DataFrame中的（带有分级名称）列可以这样创建：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>MultiIndex</span><span class=o>.</span><span class=n>from_arrays</span><span class=p>([[</span><span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Colorado&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;Green&#39;</span><span class=p>,</span> <span class=s1>&#39;Red&#39;</span><span class=p>,</span> <span class=s1>&#39;Green&#39;</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>                       <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>,</span> <span class=s1>&#39;color&#39;</span><span class=p>])</span></span></span></code></pre></td></tr></table></div></div><h3 id=811-重排与分级排序>8.1.1 重排与分级排序
<a class=header-anchor href=#811-%e9%87%8d%e6%8e%92%e4%b8%8e%e5%88%86%e7%ba%a7%e6%8e%92%e5%ba%8f></a></h3><p>有时，你需要重新调整某条轴上各级别的顺序，或根据指定级别上的值对数据进行排序。<code>swaplevel</code>接受两个级别编号或名称，并返回一个互换了级别的新对象（但数据不会发生变化）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4>4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5>5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6>6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7>7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8>8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>24</span><span class=p>]:</span> <span class=n>frame</span><span class=o>.</span><span class=n>swaplevel</span><span class=p>(</span><span class=s1>&#39;key1&#39;</span><span class=p>,</span> <span class=s1>&#39;key2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>24</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>      <span class=n>Ohio</span>     <span class=n>Colorado</span>
</span></span><span class=line><span class=cl><span class=n>color</span>     <span class=n>Green</span> <span class=n>Red</span>    <span class=n>Green</span>
</span></span><span class=line><span class=cl><span class=n>key2</span> <span class=n>key1</span>                   
</span></span><span class=line><span class=cl><span class=mi>1</span>    <span class=n>a</span>        <span class=mi>0</span>   <span class=mi>1</span>        <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>    <span class=n>a</span>        <span class=mi>3</span>   <span class=mi>4</span>        <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>    <span class=n>b</span>        <span class=mi>6</span>   <span class=mi>7</span>        <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>    <span class=n>b</span>        <span class=mi>9</span>  <span class=mi>10</span>       <span class=mi>11</span></span></span></code></pre></td></tr></table></div></div><p>而sort_index则根据单个级别中的值对数据进行排序。交换级别时，常常也会用到sort_index，这样最终结果就是按照指定顺序进行字母排序了：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18>18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>25</span><span class=p>]:</span> <span class=n>frame</span><span class=o>.</span><span class=n>sort_index</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>25</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>      <span class=n>Ohio</span>     <span class=n>Colorado</span>
</span></span><span class=line><span class=cl><span class=n>color</span>     <span class=n>Green</span> <span class=n>Red</span>    <span class=n>Green</span>
</span></span><span class=line><span class=cl><span class=n>key1</span> <span class=n>key2</span>                   
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mi>1</span>        <span class=mi>0</span>   <span class=mi>1</span>        <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mi>1</span>        <span class=mi>6</span>   <span class=mi>7</span>        <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mi>2</span>        <span class=mi>3</span>   <span class=mi>4</span>        <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mi>2</span>        <span class=mi>9</span>  <span class=mi>10</span>       <span class=mi>11</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>26</span><span class=p>]:</span> <span class=n>frame</span><span class=o>.</span><span class=n>swaplevel</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>sort_index</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>26</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>      <span class=n>Ohio</span>     <span class=n>Colorado</span>
</span></span><span class=line><span class=cl><span class=n>color</span>     <span class=n>Green</span> <span class=n>Red</span>    <span class=n>Green</span>
</span></span><span class=line><span class=cl><span class=n>key2</span> <span class=n>key1</span>                   
</span></span><span class=line><span class=cl><span class=mi>1</span>    <span class=n>a</span>        <span class=mi>0</span>   <span class=mi>1</span>        <span class=mi>2</span>
</span></span><span class=line><span class=cl>     <span class=n>b</span>        <span class=mi>6</span>   <span class=mi>7</span>        <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>    <span class=n>a</span>        <span class=mi>3</span>   <span class=mi>4</span>        <span class=mi>5</span>
</span></span><span class=line><span class=cl>     <span class=n>b</span>        <span class=mi>9</span>  <span class=mi>10</span>       <span class=mi>11</span></span></span></code></pre></td></tr></table></div></div><h3 id=812-根据级别汇总统计>8.1.2 根据级别汇总统计
<a class=header-anchor href=#812-%e6%a0%b9%e6%8d%ae%e7%ba%a7%e5%88%ab%e6%b1%87%e6%80%bb%e7%bb%9f%e8%ae%a1></a></h3><p>许多对DataFrame和Series的描述和汇总统计都有一个level选项，它用于指定在某条轴上求和的级别。再以上面那个DataFrame为例，我们可以根据行或列上的级别来进行求和：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>27</span><span class=p>]:</span> <span class=n>frame</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=s1>&#39;key2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>27</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>  <span class=n>Ohio</span>     <span class=n>Colorado</span>
</span></span><span class=line><span class=cl><span class=n>color</span> <span class=n>Green</span> <span class=n>Red</span>    <span class=n>Green</span>
</span></span><span class=line><span class=cl><span class=n>key2</span>                    
</span></span><span class=line><span class=cl><span class=mi>1</span>         <span class=mi>6</span>   <span class=mi>8</span>       <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>        <span class=mi>12</span>  <span class=mi>14</span>       <span class=mi>16</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>28</span><span class=p>]:</span> <span class=n>frame</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=s1>&#39;color&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>28</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>color</span>      <span class=n>Green</span>  <span class=n>Red</span>
</span></span><span class=line><span class=cl><span class=n>key1</span> <span class=n>key2</span>            
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mi>1</span>         <span class=mi>2</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl>     <span class=mi>2</span>         <span class=mi>8</span>    <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mi>1</span>        <span class=mi>14</span>    <span class=mi>7</span>
</span></span><span class=line><span class=cl>     <span class=mi>2</span>        <span class=mi>20</span>   <span class=mi>10</span></span></span></code></pre></td></tr></table></div></div><p>这其实是利用了pandas的groupby功能，本书稍后将对其进行详细讲解。</p><h3 id=813-使用dataframe的列进行索引>8.1.3 使用DataFrame的列进行索引
<a class=header-anchor href=#813-%e4%bd%bf%e7%94%a8dataframe%e7%9a%84%e5%88%97%e8%bf%9b%e8%a1%8c%e7%b4%a2%e5%bc%95></a></h3><p>人们经常想要将DataFrame的一个或多个列当做行索引来用，或者可能希望将行索引变成DataFrame的列。以下面这个DataFrame为例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11>11</a>
</span><span class=lnt id=hl-13-12><a class=lnlinks href=#hl-13-12>12</a>
</span><span class=lnt id=hl-13-13><a class=lnlinks href=#hl-13-13>13</a>
</span><span class=lnt id=hl-13-14><a class=lnlinks href=#hl-13-14>14</a>
</span><span class=lnt id=hl-13-15><a class=lnlinks href=#hl-13-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>29</span><span class=p>]:</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>7</span><span class=p>),</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=s1>&#39;c&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                             <span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=s1>&#39;d&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>30</span><span class=p>]:</span> <span class=n>frame</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>30</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>a</span>  <span class=n>b</span>    <span class=n>c</span>  <span class=n>d</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mi>0</span>  <span class=mi>7</span>  <span class=n>one</span>  <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mi>1</span>  <span class=mi>6</span>  <span class=n>one</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=mi>2</span>  <span class=mi>5</span>  <span class=n>one</span>  <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=mi>3</span>  <span class=mi>4</span>  <span class=n>two</span>  <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=mi>4</span>  <span class=mi>3</span>  <span class=n>two</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>  <span class=mi>5</span>  <span class=mi>2</span>  <span class=n>two</span>  <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>  <span class=mi>6</span>  <span class=mi>1</span>  <span class=n>two</span>  <span class=mi>3</span></span></span></code></pre></td></tr></table></div></div><p>DataFrame的set_index函数会将其一个或多个列转换为行索引，并创建一个新的DataFrame：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>31</span><span class=p>]:</span> <span class=n>frame2</span> <span class=o>=</span> <span class=n>frame</span><span class=o>.</span><span class=n>set_index</span><span class=p>([</span><span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>32</span><span class=p>]:</span> <span class=n>frame2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>32</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>       <span class=n>a</span>  <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>c</span>   <span class=n>d</span>      
</span></span><span class=line><span class=cl><span class=n>one</span> <span class=mi>0</span>  <span class=mi>0</span>  <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span>  <span class=mi>1</span>  <span class=mi>6</span>
</span></span><span class=line><span class=cl>    <span class=mi>2</span>  <span class=mi>2</span>  <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>two</span> <span class=mi>0</span>  <span class=mi>3</span>  <span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span>  <span class=mi>4</span>  <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=mi>2</span>  <span class=mi>5</span>  <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=mi>3</span>  <span class=mi>6</span>  <span class=mi>1</span></span></span></code></pre></td></tr></table></div></div><p>默认情况下，那些列会从DataFrame中移除，但也可以将其保留下来：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>33</span><span class=p>]:</span> <span class=n>frame</span><span class=o>.</span><span class=n>set_index</span><span class=p>([</span><span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>],</span> <span class=n>drop</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>33</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>       <span class=n>a</span>  <span class=n>b</span>    <span class=n>c</span>  <span class=n>d</span>
</span></span><span class=line><span class=cl><span class=n>c</span>   <span class=n>d</span>              
</span></span><span class=line><span class=cl><span class=n>one</span> <span class=mi>0</span>  <span class=mi>0</span>  <span class=mi>7</span>  <span class=n>one</span>  <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span>  <span class=mi>1</span>  <span class=mi>6</span>  <span class=n>one</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=mi>2</span>  <span class=mi>2</span>  <span class=mi>5</span>  <span class=n>one</span>  <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>two</span> <span class=mi>0</span>  <span class=mi>3</span>  <span class=mi>4</span>  <span class=n>two</span>  <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span>  <span class=mi>4</span>  <span class=mi>3</span>  <span class=n>two</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=mi>2</span>  <span class=mi>5</span>  <span class=mi>2</span>  <span class=n>two</span>  <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=mi>3</span>  <span class=mi>6</span>  <span class=mi>1</span>  <span class=n>two</span>  <span class=mi>3</span></span></span></code></pre></td></tr></table></div></div><p>reset_index的功能跟set_index刚好相反，层次化索引的级别会被转移到列里面：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>34</span><span class=p>]:</span> <span class=n>frame2</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>34</span><span class=p>]:</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=n>d</span>  <span class=n>a</span>  <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=n>one</span>  <span class=mi>0</span>  <span class=mi>0</span>  <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=n>one</span>  <span class=mi>1</span>  <span class=mi>1</span>  <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=n>one</span>  <span class=mi>2</span>  <span class=mi>2</span>  <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=n>two</span>  <span class=mi>0</span>  <span class=mi>3</span>  <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=n>two</span>  <span class=mi>1</span>  <span class=mi>4</span>  <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>  <span class=n>two</span>  <span class=mi>2</span>  <span class=mi>5</span>  <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>  <span class=n>two</span>  <span class=mi>3</span>  <span class=mi>6</span>  <span class=mi>1</span></span></span></code></pre></td></tr></table></div></div><h2 id=82-合并数据集>8.2 合并数据集
<a class=header-anchor href=#82-%e5%90%88%e5%b9%b6%e6%95%b0%e6%8d%ae%e9%9b%86></a></h2><p>pandas对象中的数据可以通过一些方式进行合并：</p><ul><li><code>pandas.merge</code>可根据一个或多个键将不同DataFrame中的行连接起来。SQL或其他关系型数据库的用户对此应该会比较熟悉，因为它实现的就是数据库的join操作。</li><li><code>pandas.concat</code>可以沿着一条轴将多个对象堆叠到一起。</li><li>实例方法<code>combine_first</code>可以将重复数据拼接在一起，用一个对象中的值填充另一个对象中的缺失值。</li></ul><p>我将分别对它们进行讲解，并给出一些例子。本书剩余部分的示例中将经常用到它们。</p><h3 id=821-数据库风格的dataframe合并>8.2.1 数据库风格的DataFrame合并
<a class=header-anchor href=#821-%e6%95%b0%e6%8d%ae%e5%ba%93%e9%a3%8e%e6%a0%bc%e7%9a%84dataframe%e5%90%88%e5%b9%b6></a></h3><p>数据集的合并（merge）或连接（join）运算是通过一个或多个键将行连接起来的。这些运算是关系型数据库（基于SQL）的核心。pandas的merge函数是对数据应用这些算法的主要切入点。</p><p>以一个简单的例子开始：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14>14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15>15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16>16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17>17</a>
</span><span class=lnt id=hl-17-18><a class=lnlinks href=#hl-17-18>18</a>
</span><span class=lnt id=hl-17-19><a class=lnlinks href=#hl-17-19>19</a>
</span><span class=lnt id=hl-17-20><a class=lnlinks href=#hl-17-20>20</a>
</span><span class=lnt id=hl-17-21><a class=lnlinks href=#hl-17-21>21</a>
</span><span class=lnt id=hl-17-22><a class=lnlinks href=#hl-17-22>22</a>
</span><span class=lnt id=hl-17-23><a class=lnlinks href=#hl-17-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>35</span><span class=p>]:</span> <span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                     <span class=s1>&#39;data1&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>7</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>36</span><span class=p>]:</span> <span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                     <span class=s1>&#39;data2&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>37</span><span class=p>]:</span> <span class=n>df1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>37</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data1</span> <span class=n>key</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=mi>0</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=mi>1</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=mi>2</span>   <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>      <span class=mi>3</span>   <span class=n>c</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>      <span class=mi>4</span>   <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>      <span class=mi>5</span>   <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>      <span class=mi>6</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>38</span><span class=p>]:</span> <span class=n>df2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>38</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data2</span> <span class=n>key</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=mi>0</span>   <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=mi>1</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=mi>2</span>   <span class=n>d</span></span></span></code></pre></td></tr></table></div></div><p>这是一种多对一的合并。df1中的数据有多个被标记为a和b的行，而df2中key列的每个值则仅对应一行。对这些对象调用merge即可得到：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2>2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3>3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4>4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5>5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6>6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7>7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8>8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>39</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>39</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data1</span> <span class=n>key</span>  <span class=n>data2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=mi>0</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=mi>1</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=mi>6</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>      <span class=mi>2</span>   <span class=n>a</span>      <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>      <span class=mi>4</span>   <span class=n>a</span>      <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>      <span class=mi>5</span>   <span class=n>a</span>      <span class=mi>0</span></span></span></code></pre></td></tr></table></div></div><p>注意，我并没有指明要用哪个列进行连接。如果没有指定，merge就会将重叠列的列名当做键。不过，最好明确指定一下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2>2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3>3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4>4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5>5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6>6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7>7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8>8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>40</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>40</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data1</span> <span class=n>key</span>  <span class=n>data2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=mi>0</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=mi>1</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=mi>6</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>      <span class=mi>2</span>   <span class=n>a</span>      <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>      <span class=mi>4</span>   <span class=n>a</span>      <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>      <span class=mi>5</span>   <span class=n>a</span>      <span class=mi>0</span></span></span></code></pre></td></tr></table></div></div><p>如果两个对象的列名不同，也可以分别进行指定：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>41</span><span class=p>]:</span> <span class=n>df3</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;lkey&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                     <span class=s1>&#39;data1&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>7</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>42</span><span class=p>]:</span> <span class=n>df4</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;rkey&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                     <span class=s1>&#39;data2&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>43</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df3</span><span class=p>,</span> <span class=n>df4</span><span class=p>,</span> <span class=n>left_on</span><span class=o>=</span><span class=s1>&#39;lkey&#39;</span><span class=p>,</span> <span class=n>right_on</span><span class=o>=</span><span class=s1>&#39;rkey&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>43</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data1</span> <span class=n>lkey</span>  <span class=n>data2</span> <span class=n>rkey</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=mi>0</span>    <span class=n>b</span>      <span class=mi>1</span>    <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=mi>1</span>    <span class=n>b</span>      <span class=mi>1</span>    <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=mi>6</span>    <span class=n>b</span>      <span class=mi>1</span>    <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>      <span class=mi>2</span>    <span class=n>a</span>      <span class=mi>0</span>    <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>      <span class=mi>4</span>    <span class=n>a</span>      <span class=mi>0</span>    <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>      <span class=mi>5</span>    <span class=n>a</span>      <span class=mi>0</span>    <span class=n>a</span></span></span></code></pre></td></tr></table></div></div><p>可能你已经注意到了，结果里面c和d以及与之相关的数据消失了。默认情况下，merge做的是“内连接”；结果中的键是交集。其他方式还有"left"、&ldquo;right"以及"outer&rdquo;。外连接求取的是键的并集，组合了左连接和右连接的效果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>44</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>44</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data1</span> <span class=n>key</span>  <span class=n>data2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>    <span class=mf>0.0</span>   <span class=n>b</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>    <span class=mf>1.0</span>   <span class=n>b</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>    <span class=mf>6.0</span>   <span class=n>b</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>    <span class=mf>2.0</span>   <span class=n>a</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>    <span class=mf>4.0</span>   <span class=n>a</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>    <span class=mf>5.0</span>   <span class=n>a</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>    <span class=mf>3.0</span>   <span class=n>c</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=mi>7</span>    <span class=n>NaN</span>   <span class=n>d</span>    <span class=mf>2.0</span></span></span></code></pre></td></tr></table></div></div><p>表8-1对这些选项进行了总结。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://gitee.com/wugenqiang/images/raw/master/02/1240-20201026235210681.png alt="表8-1 不同的连接类型"></p><p>多对多的合并有些不直观。看下面的例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span><span class=lnt id=hl-22-23><a class=lnlinks href=#hl-22-23>23</a>
</span><span class=lnt id=hl-22-24><a class=lnlinks href=#hl-22-24>24</a>
</span><span class=lnt id=hl-22-25><a class=lnlinks href=#hl-22-25>25</a>
</span><span class=lnt id=hl-22-26><a class=lnlinks href=#hl-22-26>26</a>
</span><span class=lnt id=hl-22-27><a class=lnlinks href=#hl-22-27>27</a>
</span><span class=lnt id=hl-22-28><a class=lnlinks href=#hl-22-28>28</a>
</span><span class=lnt id=hl-22-29><a class=lnlinks href=#hl-22-29>29</a>
</span><span class=lnt id=hl-22-30><a class=lnlinks href=#hl-22-30>30</a>
</span><span class=lnt id=hl-22-31><a class=lnlinks href=#hl-22-31>31</a>
</span><span class=lnt id=hl-22-32><a class=lnlinks href=#hl-22-32>32</a>
</span><span class=lnt id=hl-22-33><a class=lnlinks href=#hl-22-33>33</a>
</span><span class=lnt id=hl-22-34><a class=lnlinks href=#hl-22-34>34</a>
</span><span class=lnt id=hl-22-35><a class=lnlinks href=#hl-22-35>35</a>
</span><span class=lnt id=hl-22-36><a class=lnlinks href=#hl-22-36>36</a>
</span><span class=lnt id=hl-22-37><a class=lnlinks href=#hl-22-37>37</a>
</span><span class=lnt id=hl-22-38><a class=lnlinks href=#hl-22-38>38</a>
</span><span class=lnt id=hl-22-39><a class=lnlinks href=#hl-22-39>39</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>45</span><span class=p>]:</span> <span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                     <span class=s1>&#39;data1&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>6</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>46</span><span class=p>]:</span> <span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                     <span class=s1>&#39;data2&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>47</span><span class=p>]:</span> <span class=n>df1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>47</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data1</span> <span class=n>key</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=mi>0</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=mi>1</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=mi>2</span>   <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>      <span class=mi>3</span>   <span class=n>c</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>      <span class=mi>4</span>   <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>      <span class=mi>5</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>48</span><span class=p>]:</span> <span class=n>df2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>48</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data2</span> <span class=n>key</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=mi>0</span>   <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=mi>1</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=mi>2</span>   <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>      <span class=mi>3</span>   <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>      <span class=mi>4</span>   <span class=n>d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>49</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>49</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>    <span class=n>data1</span> <span class=n>key</span>  <span class=n>data2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>       <span class=mi>0</span>   <span class=n>b</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>       <span class=mi>0</span>   <span class=n>b</span>    <span class=mf>3.0</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>       <span class=mi>1</span>   <span class=n>b</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>       <span class=mi>1</span>   <span class=n>b</span>    <span class=mf>3.0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>       <span class=mi>2</span>   <span class=n>a</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>       <span class=mi>2</span>   <span class=n>a</span>    <span class=mf>2.0</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>       <span class=mi>3</span>   <span class=n>c</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=mi>7</span>       <span class=mi>4</span>   <span class=n>a</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl><span class=mi>8</span>       <span class=mi>4</span>   <span class=n>a</span>    <span class=mf>2.0</span>
</span></span><span class=line><span class=cl><span class=mi>9</span>       <span class=mi>5</span>   <span class=n>b</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=mi>10</span>      <span class=mi>5</span>   <span class=n>b</span>    <span class=mf>3.0</span></span></span></code></pre></td></tr></table></div></div><p>多对多连接产生的是行的笛卡尔积。由于左边的DataFrame有3个"b"行，右边的有2个，所以最终结果中就有6个"b"行。连接方式只影响出现在结果中的不同的键的值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>50</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;inner&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>50</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data1</span> <span class=n>key</span>  <span class=n>data2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=mi>0</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=mi>0</span>   <span class=n>b</span>      <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=mi>1</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>      <span class=mi>1</span>   <span class=n>b</span>      <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>      <span class=mi>5</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>      <span class=mi>5</span>   <span class=n>b</span>      <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>      <span class=mi>2</span>   <span class=n>a</span>      <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>7</span>      <span class=mi>2</span>   <span class=n>a</span>      <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>8</span>      <span class=mi>4</span>   <span class=n>a</span>      <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>9</span>      <span class=mi>4</span>   <span class=n>a</span>      <span class=mi>2</span></span></span></code></pre></td></tr></table></div></div><p>要根据多个键进行合并，传入一个由列名组成的列表即可：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14>14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15>15</a>
</span><span class=lnt id=hl-24-16><a class=lnlinks href=#hl-24-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>51</span><span class=p>]:</span> <span class=n>left</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key1&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                      <span class=s1>&#39;key2&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;one&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                      <span class=s1>&#39;lval&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>52</span><span class=p>]:</span> <span class=n>right</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key1&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=s1>&#39;key2&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=s1>&#39;rval&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>]})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>53</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>right</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;key1&#39;</span><span class=p>,</span> <span class=s1>&#39;key2&#39;</span><span class=p>],</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>53</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>key1</span> <span class=n>key2</span>  <span class=n>lval</span>  <span class=n>rval</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=n>foo</span>  <span class=n>one</span>   <span class=mf>1.0</span>   <span class=mf>4.0</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=n>foo</span>  <span class=n>one</span>   <span class=mf>1.0</span>   <span class=mf>5.0</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=n>foo</span>  <span class=n>two</span>   <span class=mf>2.0</span>   <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=n>bar</span>  <span class=n>one</span>   <span class=mf>3.0</span>   <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=n>bar</span>  <span class=n>two</span>   <span class=n>NaN</span>   <span class=mf>7.0</span></span></span></code></pre></td></tr></table></div></div><p>结果中会出现哪些键组合取决于所选的合并方式，你可以这样来理解：多个键形成一系列元组，并将其当做单个连接键（当然，实际上并不是这么回事）。</p><blockquote><p>注意：在进行列－列连接时，DataFrame对象中的索引会被丢弃。</p></blockquote><p>对于合并运算需要考虑的最后一个问题是对重复列名的处理。虽然你可以手工处理列名重叠的问题（查看前面介绍的重命名轴标签），但merge有一个更实用的suffixes选项，用于指定附加到左右两个DataFrame对象的重叠列名上的字符串：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17>17</a>
</span><span class=lnt id=hl-25-18><a class=lnlinks href=#hl-25-18>18</a>
</span><span class=lnt id=hl-25-19><a class=lnlinks href=#hl-25-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>54</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>right</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>54</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>key1</span> <span class=n>key2_x</span>  <span class=n>lval</span> <span class=n>key2_y</span>  <span class=n>rval</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=n>foo</span>    <span class=n>one</span>     <span class=mi>1</span>    <span class=n>one</span>     <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=n>foo</span>    <span class=n>one</span>     <span class=mi>1</span>    <span class=n>one</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=n>foo</span>    <span class=n>two</span>     <span class=mi>2</span>    <span class=n>one</span>     <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=n>foo</span>    <span class=n>two</span>     <span class=mi>2</span>    <span class=n>one</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=n>bar</span>    <span class=n>one</span>     <span class=mi>3</span>    <span class=n>one</span>     <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>  <span class=n>bar</span>    <span class=n>one</span>     <span class=mi>3</span>    <span class=n>two</span>     <span class=mi>7</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>55</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>right</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key1&#39;</span><span class=p>,</span> <span class=n>suffixes</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;_left&#39;</span><span class=p>,</span> <span class=s1>&#39;_right&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>55</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>key1</span> <span class=n>key2_left</span>  <span class=n>lval</span> <span class=n>key2_right</span>  <span class=n>rval</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=n>foo</span>       <span class=n>one</span>     <span class=mi>1</span>        <span class=n>one</span>     <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=n>foo</span>       <span class=n>one</span>     <span class=mi>1</span>        <span class=n>one</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=n>foo</span>       <span class=n>two</span>     <span class=mi>2</span>        <span class=n>one</span>     <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=n>foo</span>       <span class=n>two</span>     <span class=mi>2</span>        <span class=n>one</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=n>bar</span>       <span class=n>one</span>     <span class=mi>3</span>        <span class=n>one</span>     <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>  <span class=n>bar</span>       <span class=n>one</span>     <span class=mi>3</span>        <span class=n>two</span>     <span class=mi>7</span></span></span></code></pre></td></tr></table></div></div><p>merge的参数请参见表8-2。使用DataFrame的行索引合并是下一节的主题。</p><p>表8-2 merge函数的参数</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://gitee.com/wugenqiang/images/raw/master/02/1240-20201026235225177.png alt></p><p><img src=/imgs/img-lazy-loading.gif data-src=https://gitee.com/wugenqiang/images/raw/master/02/1240-20201026235230724.png alt></p><p>indicator 添加特殊的列_merge，它可以指明每个行的来源，它的值有left_only、right_only或both，根据每行的合并数据的来源。</p><h3 id=822-索引上的合并>8.2.2 索引上的合并
<a class=header-anchor href=#822-%e7%b4%a2%e5%bc%95%e4%b8%8a%e7%9a%84%e5%90%88%e5%b9%b6></a></h3><p>有时候，DataFrame中的连接键位于其索引中。在这种情况下，你可以传入left_index=True或right_index=True（或两个都传）以说明索引应该被用作连接键：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1> 1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2> 2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3> 3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4> 4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5> 5</a>
</span><span class=lnt id=hl-26-6><a class=lnlinks href=#hl-26-6> 6</a>
</span><span class=lnt id=hl-26-7><a class=lnlinks href=#hl-26-7> 7</a>
</span><span class=lnt id=hl-26-8><a class=lnlinks href=#hl-26-8> 8</a>
</span><span class=lnt id=hl-26-9><a class=lnlinks href=#hl-26-9> 9</a>
</span><span class=lnt id=hl-26-10><a class=lnlinks href=#hl-26-10>10</a>
</span><span class=lnt id=hl-26-11><a class=lnlinks href=#hl-26-11>11</a>
</span><span class=lnt id=hl-26-12><a class=lnlinks href=#hl-26-12>12</a>
</span><span class=lnt id=hl-26-13><a class=lnlinks href=#hl-26-13>13</a>
</span><span class=lnt id=hl-26-14><a class=lnlinks href=#hl-26-14>14</a>
</span><span class=lnt id=hl-26-15><a class=lnlinks href=#hl-26-15>15</a>
</span><span class=lnt id=hl-26-16><a class=lnlinks href=#hl-26-16>16</a>
</span><span class=lnt id=hl-26-17><a class=lnlinks href=#hl-26-17>17</a>
</span><span class=lnt id=hl-26-18><a class=lnlinks href=#hl-26-18>18</a>
</span><span class=lnt id=hl-26-19><a class=lnlinks href=#hl-26-19>19</a>
</span><span class=lnt id=hl-26-20><a class=lnlinks href=#hl-26-20>20</a>
</span><span class=lnt id=hl-26-21><a class=lnlinks href=#hl-26-21>21</a>
</span><span class=lnt id=hl-26-22><a class=lnlinks href=#hl-26-22>22</a>
</span><span class=lnt id=hl-26-23><a class=lnlinks href=#hl-26-23>23</a>
</span><span class=lnt id=hl-26-24><a class=lnlinks href=#hl-26-24>24</a>
</span><span class=lnt id=hl-26-25><a class=lnlinks href=#hl-26-25>25</a>
</span><span class=lnt id=hl-26-26><a class=lnlinks href=#hl-26-26>26</a>
</span><span class=lnt id=hl-26-27><a class=lnlinks href=#hl-26-27>27</a>
</span><span class=lnt id=hl-26-28><a class=lnlinks href=#hl-26-28>28</a>
</span><span class=lnt id=hl-26-29><a class=lnlinks href=#hl-26-29>29</a>
</span><span class=lnt id=hl-26-30><a class=lnlinks href=#hl-26-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>56</span><span class=p>]:</span> <span class=n>left1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>6</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>57</span><span class=p>]:</span> <span class=n>right1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;group_val&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>3.5</span><span class=p>,</span> <span class=mi>7</span><span class=p>]},</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>58</span><span class=p>]:</span> <span class=n>left1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>58</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>key</span>  <span class=n>value</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=n>a</span>      <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=n>b</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>   <span class=n>a</span>      <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>   <span class=n>a</span>      <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>   <span class=n>b</span>      <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>   <span class=n>c</span>      <span class=mi>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>59</span><span class=p>]:</span> <span class=n>right1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>59</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>group_val</span>
</span></span><span class=line><span class=cl><span class=n>a</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=n>b</span>        <span class=mf>7.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>60</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>left1</span><span class=p>,</span> <span class=n>right1</span><span class=p>,</span> <span class=n>left_on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=n>right_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>60</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>key</span>  <span class=n>value</span>  <span class=n>group_val</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=n>a</span>      <span class=mi>0</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>   <span class=n>a</span>      <span class=mi>2</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>   <span class=n>a</span>      <span class=mi>3</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=n>b</span>      <span class=mi>1</span>        <span class=mf>7.0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>   <span class=n>b</span>      <span class=mi>4</span>        <span class=mf>7.0</span></span></span></code></pre></td></tr></table></div></div><p>由于默认的merge方法是求取连接键的交集，因此你可以通过外连接的方式得到它们的并集：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1>1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2>2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3>3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4>4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5>5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6>6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7>7</a>
</span><span class=lnt id=hl-27-8><a class=lnlinks href=#hl-27-8>8</a>
</span><span class=lnt id=hl-27-9><a class=lnlinks href=#hl-27-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>61</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>left1</span><span class=p>,</span> <span class=n>right1</span><span class=p>,</span> <span class=n>left_on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=n>right_index</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>61</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>key</span>  <span class=n>value</span>  <span class=n>group_val</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=n>a</span>      <span class=mi>0</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>   <span class=n>a</span>      <span class=mi>2</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>   <span class=n>a</span>      <span class=mi>3</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=n>b</span>      <span class=mi>1</span>        <span class=mf>7.0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>   <span class=n>b</span>      <span class=mi>4</span>        <span class=mf>7.0</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>   <span class=n>c</span>      <span class=mi>5</span>        <span class=n>NaN</span></span></span></code></pre></td></tr></table></div></div><p>对于层次化索引的数据，事情就有点复杂了，因为索引的合并默认是多键合并：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1> 1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2> 2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3> 3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4> 4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5> 5</a>
</span><span class=lnt id=hl-28-6><a class=lnlinks href=#hl-28-6> 6</a>
</span><span class=lnt id=hl-28-7><a class=lnlinks href=#hl-28-7> 7</a>
</span><span class=lnt id=hl-28-8><a class=lnlinks href=#hl-28-8> 8</a>
</span><span class=lnt id=hl-28-9><a class=lnlinks href=#hl-28-9> 9</a>
</span><span class=lnt id=hl-28-10><a class=lnlinks href=#hl-28-10>10</a>
</span><span class=lnt id=hl-28-11><a class=lnlinks href=#hl-28-11>11</a>
</span><span class=lnt id=hl-28-12><a class=lnlinks href=#hl-28-12>12</a>
</span><span class=lnt id=hl-28-13><a class=lnlinks href=#hl-28-13>13</a>
</span><span class=lnt id=hl-28-14><a class=lnlinks href=#hl-28-14>14</a>
</span><span class=lnt id=hl-28-15><a class=lnlinks href=#hl-28-15>15</a>
</span><span class=lnt id=hl-28-16><a class=lnlinks href=#hl-28-16>16</a>
</span><span class=lnt id=hl-28-17><a class=lnlinks href=#hl-28-17>17</a>
</span><span class=lnt id=hl-28-18><a class=lnlinks href=#hl-28-18>18</a>
</span><span class=lnt id=hl-28-19><a class=lnlinks href=#hl-28-19>19</a>
</span><span class=lnt id=hl-28-20><a class=lnlinks href=#hl-28-20>20</a>
</span><span class=lnt id=hl-28-21><a class=lnlinks href=#hl-28-21>21</a>
</span><span class=lnt id=hl-28-22><a class=lnlinks href=#hl-28-22>22</a>
</span><span class=lnt id=hl-28-23><a class=lnlinks href=#hl-28-23>23</a>
</span><span class=lnt id=hl-28-24><a class=lnlinks href=#hl-28-24>24</a>
</span><span class=lnt id=hl-28-25><a class=lnlinks href=#hl-28-25>25</a>
</span><span class=lnt id=hl-28-26><a class=lnlinks href=#hl-28-26>26</a>
</span><span class=lnt id=hl-28-27><a class=lnlinks href=#hl-28-27>27</a>
</span><span class=lnt id=hl-28-28><a class=lnlinks href=#hl-28-28>28</a>
</span><span class=lnt id=hl-28-29><a class=lnlinks href=#hl-28-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>62</span><span class=p>]:</span> <span class=n>lefth</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key1&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Ohio&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                                <span class=s1>&#39;Nevada&#39;</span><span class=p>,</span> <span class=s1>&#39;Nevada&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=s1>&#39;key2&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2000</span><span class=p>,</span> <span class=mi>2001</span><span class=p>,</span> <span class=mi>2002</span><span class=p>,</span> <span class=mi>2001</span><span class=p>,</span> <span class=mi>2002</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mf>5.</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>63</span><span class=p>]:</span> <span class=n>righth</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>12</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=mi>6</span><span class=p>,</span> <span class=mi>2</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=n>index</span><span class=o>=</span><span class=p>[[</span><span class=s1>&#39;Nevada&#39;</span><span class=p>,</span> <span class=s1>&#39;Nevada&#39;</span><span class=p>,</span> <span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Ohio&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                               <span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Ohio&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                              <span class=p>[</span><span class=mi>2001</span><span class=p>,</span> <span class=mi>2000</span><span class=p>,</span> <span class=mi>2000</span><span class=p>,</span> <span class=mi>2000</span><span class=p>,</span> <span class=mi>2001</span><span class=p>,</span> <span class=mi>2002</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;event1&#39;</span><span class=p>,</span> <span class=s1>&#39;event2&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>64</span><span class=p>]:</span> <span class=n>lefth</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>64</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data</span>    <span class=n>key1</span>  <span class=n>key2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=mf>0.0</span>    <span class=n>Ohio</span>  <span class=mi>2000</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=mf>1.0</span>    <span class=n>Ohio</span>  <span class=mi>2001</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>   <span class=mf>2.0</span>    <span class=n>Ohio</span>  <span class=mi>2002</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>   <span class=mf>3.0</span>  <span class=n>Nevada</span>  <span class=mi>2001</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>   <span class=mf>4.0</span>  <span class=n>Nevada</span>  <span class=mi>2002</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>65</span><span class=p>]:</span> <span class=n>righth</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>65</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>             <span class=n>event1</span>  <span class=n>event2</span>
</span></span><span class=line><span class=cl><span class=n>Nevada</span> <span class=mi>2001</span>       <span class=mi>0</span>       <span class=mi>1</span>
</span></span><span class=line><span class=cl>       <span class=mi>2000</span>       <span class=mi>2</span>       <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>Ohio</span>   <span class=mi>2000</span>       <span class=mi>4</span>       <span class=mi>5</span>
</span></span><span class=line><span class=cl>       <span class=mi>2000</span>       <span class=mi>6</span>       <span class=mi>7</span>
</span></span><span class=line><span class=cl>       <span class=mi>2001</span>       <span class=mi>8</span>       <span class=mi>9</span>
</span></span><span class=line><span class=cl>       <span class=mi>2002</span>      <span class=mi>10</span>      <span class=mi>11</span></span></span></code></pre></td></tr></table></div></div><p>这种情况下，你必须以列表的形式指明用作合并键的多个列（注意用how=&lsquo;outer&rsquo;对重复索引值的处理）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span><span class=lnt id=hl-29-15><a class=lnlinks href=#hl-29-15>15</a>
</span><span class=lnt id=hl-29-16><a class=lnlinks href=#hl-29-16>16</a>
</span><span class=lnt id=hl-29-17><a class=lnlinks href=#hl-29-17>17</a>
</span><span class=lnt id=hl-29-18><a class=lnlinks href=#hl-29-18>18</a>
</span><span class=lnt id=hl-29-19><a class=lnlinks href=#hl-29-19>19</a>
</span><span class=lnt id=hl-29-20><a class=lnlinks href=#hl-29-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>66</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>lefth</span><span class=p>,</span> <span class=n>righth</span><span class=p>,</span> <span class=n>left_on</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;key1&#39;</span><span class=p>,</span> <span class=s1>&#39;key2&#39;</span><span class=p>],</span> <span class=n>right_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>66</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data</span>    <span class=n>key1</span>  <span class=n>key2</span>  <span class=n>event1</span>  <span class=n>event2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=mf>0.0</span>    <span class=n>Ohio</span>  <span class=mi>2000</span>       <span class=mi>4</span>       <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=mf>0.0</span>    <span class=n>Ohio</span>  <span class=mi>2000</span>       <span class=mi>6</span>       <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=mf>1.0</span>    <span class=n>Ohio</span>  <span class=mi>2001</span>       <span class=mi>8</span>       <span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>   <span class=mf>2.0</span>    <span class=n>Ohio</span>  <span class=mi>2002</span>      <span class=mi>10</span>      <span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>   <span class=mf>3.0</span>  <span class=n>Nevada</span>  <span class=mi>2001</span>       <span class=mi>0</span>       <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>67</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>lefth</span><span class=p>,</span> <span class=n>righth</span><span class=p>,</span> <span class=n>left_on</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;key1&#39;</span><span class=p>,</span> <span class=s1>&#39;key2&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>          <span class=n>right_index</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>67</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>data</span>    <span class=n>key1</span>  <span class=n>key2</span>  <span class=n>event1</span>  <span class=n>event2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=mf>0.0</span>    <span class=n>Ohio</span>  <span class=mi>2000</span>     <span class=mf>4.0</span>     <span class=mf>5.0</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=mf>0.0</span>    <span class=n>Ohio</span>  <span class=mi>2000</span>     <span class=mf>6.0</span>     <span class=mf>7.0</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=mf>1.0</span>    <span class=n>Ohio</span>  <span class=mi>2001</span>     <span class=mf>8.0</span>     <span class=mf>9.0</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>   <span class=mf>2.0</span>    <span class=n>Ohio</span>  <span class=mi>2002</span>    <span class=mf>10.0</span>    <span class=mf>11.0</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>   <span class=mf>3.0</span>  <span class=n>Nevada</span>  <span class=mi>2001</span>     <span class=mf>0.0</span>     <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>   <span class=mf>4.0</span>  <span class=n>Nevada</span>  <span class=mi>2002</span>     <span class=n>NaN</span>     <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>   <span class=n>NaN</span>  <span class=n>Nevada</span>  <span class=mi>2000</span>     <span class=mf>2.0</span>     <span class=mf>3.0</span></span></span></code></pre></td></tr></table></div></div><p>同时使用合并双方的索引也没问题：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span><span class=lnt id=hl-30-13><a class=lnlinks href=#hl-30-13>13</a>
</span><span class=lnt id=hl-30-14><a class=lnlinks href=#hl-30-14>14</a>
</span><span class=lnt id=hl-30-15><a class=lnlinks href=#hl-30-15>15</a>
</span><span class=lnt id=hl-30-16><a class=lnlinks href=#hl-30-16>16</a>
</span><span class=lnt id=hl-30-17><a class=lnlinks href=#hl-30-17>17</a>
</span><span class=lnt id=hl-30-18><a class=lnlinks href=#hl-30-18>18</a>
</span><span class=lnt id=hl-30-19><a class=lnlinks href=#hl-30-19>19</a>
</span><span class=lnt id=hl-30-20><a class=lnlinks href=#hl-30-20>20</a>
</span><span class=lnt id=hl-30-21><a class=lnlinks href=#hl-30-21>21</a>
</span><span class=lnt id=hl-30-22><a class=lnlinks href=#hl-30-22>22</a>
</span><span class=lnt id=hl-30-23><a class=lnlinks href=#hl-30-23>23</a>
</span><span class=lnt id=hl-30-24><a class=lnlinks href=#hl-30-24>24</a>
</span><span class=lnt id=hl-30-25><a class=lnlinks href=#hl-30-25>25</a>
</span><span class=lnt id=hl-30-26><a class=lnlinks href=#hl-30-26>26</a>
</span><span class=lnt id=hl-30-27><a class=lnlinks href=#hl-30-27>27</a>
</span><span class=lnt id=hl-30-28><a class=lnlinks href=#hl-30-28>28</a>
</span><span class=lnt id=hl-30-29><a class=lnlinks href=#hl-30-29>29</a>
</span><span class=lnt id=hl-30-30><a class=lnlinks href=#hl-30-30>30</a>
</span><span class=lnt id=hl-30-31><a class=lnlinks href=#hl-30-31>31</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>68</span><span class=p>]:</span> <span class=n>left2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([[</span><span class=mf>1.</span><span class=p>,</span> <span class=mf>2.</span><span class=p>],</span> <span class=p>[</span><span class=mf>3.</span><span class=p>,</span> <span class=mf>4.</span><span class=p>],</span> <span class=p>[</span><span class=mf>5.</span><span class=p>,</span> <span class=mf>6.</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                      <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                      <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Ohio&#39;</span><span class=p>,</span> <span class=s1>&#39;Nevada&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>69</span><span class=p>]:</span> <span class=n>right2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([[</span><span class=mf>7.</span><span class=p>,</span> <span class=mf>8.</span><span class=p>],</span> <span class=p>[</span><span class=mf>9.</span><span class=p>,</span> <span class=mf>10.</span><span class=p>],</span> <span class=p>[</span><span class=mf>11.</span><span class=p>,</span> <span class=mf>12.</span><span class=p>],</span> <span class=p>[</span><span class=mi>13</span><span class=p>,</span> <span class=mi>14</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                       <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Missouri&#39;</span><span class=p>,</span> <span class=s1>&#39;Alabama&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>70</span><span class=p>]:</span> <span class=n>left2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>70</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>Ohio</span>  <span class=n>Nevada</span>
</span></span><span class=line><span class=cl><span class=n>a</span>   <span class=mf>1.0</span>     <span class=mf>2.0</span>
</span></span><span class=line><span class=cl><span class=n>c</span>   <span class=mf>3.0</span>     <span class=mf>4.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>   <span class=mf>5.0</span>     <span class=mf>6.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>71</span><span class=p>]:</span> <span class=n>right2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>71</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>Missouri</span>  <span class=n>Alabama</span>
</span></span><span class=line><span class=cl><span class=n>b</span>       <span class=mf>7.0</span>      <span class=mf>8.0</span>
</span></span><span class=line><span class=cl><span class=n>c</span>       <span class=mf>9.0</span>     <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=n>d</span>      <span class=mf>11.0</span>     <span class=mf>12.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>      <span class=mf>13.0</span>     <span class=mf>14.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>72</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>left2</span><span class=p>,</span> <span class=n>right2</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>left_index</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>right_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>72</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>Ohio</span>  <span class=n>Nevada</span>  <span class=n>Missouri</span>  <span class=n>Alabama</span>
</span></span><span class=line><span class=cl><span class=n>a</span>   <span class=mf>1.0</span>     <span class=mf>2.0</span>       <span class=n>NaN</span>      <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>b</span>   <span class=n>NaN</span>     <span class=n>NaN</span>       <span class=mf>7.0</span>      <span class=mf>8.0</span>
</span></span><span class=line><span class=cl><span class=n>c</span>   <span class=mf>3.0</span>     <span class=mf>4.0</span>       <span class=mf>9.0</span>     <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=n>d</span>   <span class=n>NaN</span>     <span class=n>NaN</span>      <span class=mf>11.0</span>     <span class=mf>12.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>   <span class=mf>5.0</span>     <span class=mf>6.0</span>      <span class=mf>13.0</span>     <span class=mf>14.0</span></span></span></code></pre></td></tr></table></div></div><p>DataFrame还有一个便捷的join实例方法，它能更为方便地实现按索引合并。它还可用于合并多个带有相同或相似索引的DataFrame对象，但要求没有重叠的列。在上面那个例子中，我们可以编写：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1>1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2>2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3>3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4>4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5>5</a>
</span><span class=lnt id=hl-31-6><a class=lnlinks href=#hl-31-6>6</a>
</span><span class=lnt id=hl-31-7><a class=lnlinks href=#hl-31-7>7</a>
</span><span class=lnt id=hl-31-8><a class=lnlinks href=#hl-31-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>73</span><span class=p>]:</span> <span class=n>left2</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>right2</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>73</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>Ohio</span>  <span class=n>Nevada</span>  <span class=n>Missouri</span>  <span class=n>Alabama</span>
</span></span><span class=line><span class=cl><span class=n>a</span>   <span class=mf>1.0</span>     <span class=mf>2.0</span>       <span class=n>NaN</span>      <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>b</span>   <span class=n>NaN</span>     <span class=n>NaN</span>       <span class=mf>7.0</span>      <span class=mf>8.0</span>
</span></span><span class=line><span class=cl><span class=n>c</span>   <span class=mf>3.0</span>     <span class=mf>4.0</span>       <span class=mf>9.0</span>     <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=n>d</span>   <span class=n>NaN</span>     <span class=n>NaN</span>      <span class=mf>11.0</span>     <span class=mf>12.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>   <span class=mf>5.0</span>     <span class=mf>6.0</span>      <span class=mf>13.0</span>     <span class=mf>14.0</span></span></span></code></pre></td></tr></table></div></div><p>因为一些历史版本的遗留原因，DataFrame的join方法默认使用的是左连接，保留左边表的行索引。它还支持在调用的DataFrame的列上，连接传递的DataFrame索引：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1>1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2>2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3>3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4>4</a>
</span><span class=lnt id=hl-32-5><a class=lnlinks href=#hl-32-5>5</a>
</span><span class=lnt id=hl-32-6><a class=lnlinks href=#hl-32-6>6</a>
</span><span class=lnt id=hl-32-7><a class=lnlinks href=#hl-32-7>7</a>
</span><span class=lnt id=hl-32-8><a class=lnlinks href=#hl-32-8>8</a>
</span><span class=lnt id=hl-32-9><a class=lnlinks href=#hl-32-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>74</span><span class=p>]:</span> <span class=n>left1</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>right1</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>74</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>key</span>  <span class=n>value</span>  <span class=n>group_val</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>   <span class=n>a</span>      <span class=mi>0</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>   <span class=n>b</span>      <span class=mi>1</span>        <span class=mf>7.0</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>   <span class=n>a</span>      <span class=mi>2</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>   <span class=n>a</span>      <span class=mi>3</span>        <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>   <span class=n>b</span>      <span class=mi>4</span>        <span class=mf>7.0</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>   <span class=n>c</span>      <span class=mi>5</span>        <span class=n>NaN</span></span></span></code></pre></td></tr></table></div></div><p>最后，对于简单的索引合并，你还可以向join传入一组DataFrame，下一节会介绍更为通用的concat函数，也能实现此功能：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1> 1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2> 2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3> 3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4> 4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5> 5</a>
</span><span class=lnt id=hl-33-6><a class=lnlinks href=#hl-33-6> 6</a>
</span><span class=lnt id=hl-33-7><a class=lnlinks href=#hl-33-7> 7</a>
</span><span class=lnt id=hl-33-8><a class=lnlinks href=#hl-33-8> 8</a>
</span><span class=lnt id=hl-33-9><a class=lnlinks href=#hl-33-9> 9</a>
</span><span class=lnt id=hl-33-10><a class=lnlinks href=#hl-33-10>10</a>
</span><span class=lnt id=hl-33-11><a class=lnlinks href=#hl-33-11>11</a>
</span><span class=lnt id=hl-33-12><a class=lnlinks href=#hl-33-12>12</a>
</span><span class=lnt id=hl-33-13><a class=lnlinks href=#hl-33-13>13</a>
</span><span class=lnt id=hl-33-14><a class=lnlinks href=#hl-33-14>14</a>
</span><span class=lnt id=hl-33-15><a class=lnlinks href=#hl-33-15>15</a>
</span><span class=lnt id=hl-33-16><a class=lnlinks href=#hl-33-16>16</a>
</span><span class=lnt id=hl-33-17><a class=lnlinks href=#hl-33-17>17</a>
</span><span class=lnt id=hl-33-18><a class=lnlinks href=#hl-33-18>18</a>
</span><span class=lnt id=hl-33-19><a class=lnlinks href=#hl-33-19>19</a>
</span><span class=lnt id=hl-33-20><a class=lnlinks href=#hl-33-20>20</a>
</span><span class=lnt id=hl-33-21><a class=lnlinks href=#hl-33-21>21</a>
</span><span class=lnt id=hl-33-22><a class=lnlinks href=#hl-33-22>22</a>
</span><span class=lnt id=hl-33-23><a class=lnlinks href=#hl-33-23>23</a>
</span><span class=lnt id=hl-33-24><a class=lnlinks href=#hl-33-24>24</a>
</span><span class=lnt id=hl-33-25><a class=lnlinks href=#hl-33-25>25</a>
</span><span class=lnt id=hl-33-26><a class=lnlinks href=#hl-33-26>26</a>
</span><span class=lnt id=hl-33-27><a class=lnlinks href=#hl-33-27>27</a>
</span><span class=lnt id=hl-33-28><a class=lnlinks href=#hl-33-28>28</a>
</span><span class=lnt id=hl-33-29><a class=lnlinks href=#hl-33-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>75</span><span class=p>]:</span> <span class=n>another</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([[</span><span class=mf>7.</span><span class=p>,</span> <span class=mf>8.</span><span class=p>],</span> <span class=p>[</span><span class=mf>9.</span><span class=p>,</span> <span class=mf>10.</span><span class=p>],</span> <span class=p>[</span><span class=mf>11.</span><span class=p>,</span> <span class=mf>12.</span><span class=p>],</span> <span class=p>[</span><span class=mf>16.</span><span class=p>,</span> <span class=mf>17.</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                        <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>,</span> <span class=s1>&#39;f&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                        <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;New York&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;Oregon&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>76</span><span class=p>]:</span> <span class=n>another</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>76</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>New</span> <span class=n>York</span>  <span class=n>Oregon</span>
</span></span><span class=line><span class=cl><span class=n>a</span>       <span class=mf>7.0</span>     <span class=mf>8.0</span>
</span></span><span class=line><span class=cl><span class=n>c</span>       <span class=mf>9.0</span>    <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>      <span class=mf>11.0</span>    <span class=mf>12.0</span>
</span></span><span class=line><span class=cl><span class=n>f</span>      <span class=mf>16.0</span>    <span class=mf>17.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>77</span><span class=p>]:</span> <span class=n>left2</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>right2</span><span class=p>,</span> <span class=n>another</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>77</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>Ohio</span>  <span class=n>Nevada</span>  <span class=n>Missouri</span>  <span class=n>Alabama</span>  <span class=n>New</span> <span class=n>York</span>  <span class=n>Oregon</span>
</span></span><span class=line><span class=cl><span class=n>a</span>   <span class=mf>1.0</span>     <span class=mf>2.0</span>       <span class=n>NaN</span>      <span class=n>NaN</span>       <span class=mf>7.0</span>     <span class=mf>8.0</span>
</span></span><span class=line><span class=cl><span class=n>c</span>   <span class=mf>3.0</span>     <span class=mf>4.0</span>       <span class=mf>9.0</span>     <span class=mf>10.0</span>       <span class=mf>9.0</span>    <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>   <span class=mf>5.0</span>     <span class=mf>6.0</span>      <span class=mf>13.0</span>     <span class=mf>14.0</span>      <span class=mf>11.0</span>    <span class=mf>12.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>78</span><span class=p>]:</span> <span class=n>left2</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>right2</span><span class=p>,</span> <span class=n>another</span><span class=p>],</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>78</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>Ohio</span>  <span class=n>Nevada</span>  <span class=n>Missouri</span>  <span class=n>Alabama</span>  <span class=n>New</span> <span class=n>York</span>  <span class=n>Oregon</span>
</span></span><span class=line><span class=cl><span class=n>a</span>   <span class=mf>1.0</span>     <span class=mf>2.0</span>       <span class=n>NaN</span>      <span class=n>NaN</span>       <span class=mf>7.0</span>     <span class=mf>8.0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>   <span class=n>NaN</span>     <span class=n>NaN</span>       <span class=mf>7.0</span>      <span class=mf>8.0</span>       <span class=n>NaN</span>     <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>c</span>   <span class=mf>3.0</span>     <span class=mf>4.0</span>       <span class=mf>9.0</span>     <span class=mf>10.0</span>       <span class=mf>9.0</span>    <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=n>d</span>   <span class=n>NaN</span>     <span class=n>NaN</span>      <span class=mf>11.0</span>     <span class=mf>12.0</span>       <span class=n>NaN</span>     <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>e</span>   <span class=mf>5.0</span>     <span class=mf>6.0</span>      <span class=mf>13.0</span>     <span class=mf>14.0</span>      <span class=mf>11.0</span>    <span class=mf>12.0</span>
</span></span><span class=line><span class=cl><span class=n>f</span>   <span class=n>NaN</span>     <span class=n>NaN</span>       <span class=n>NaN</span>      <span class=n>NaN</span>      <span class=mf>16.0</span>    <span class=mf>17.0</span></span></span></code></pre></td></tr></table></div></div><h3 id=823-轴向连接>8.2.3 轴向连接
<a class=header-anchor href=#823-%e8%bd%b4%e5%90%91%e8%bf%9e%e6%8e%a5></a></h3><p>另一种数据合并运算也被称作连接（concatenation）、绑定（binding）或堆叠（stacking）。NumPy的concatenation函数可以用NumPy数组来做：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1> 1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2> 2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3> 3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4> 4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5> 5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6> 6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7> 7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8> 8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9> 9</a>
</span><span class=lnt id=hl-34-10><a class=lnlinks href=#hl-34-10>10</a>
</span><span class=lnt id=hl-34-11><a class=lnlinks href=#hl-34-11>11</a>
</span><span class=lnt id=hl-34-12><a class=lnlinks href=#hl-34-12>12</a>
</span><span class=lnt id=hl-34-13><a class=lnlinks href=#hl-34-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>79</span><span class=p>]:</span> <span class=n>arr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>12</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>80</span><span class=p>]:</span> <span class=n>arr</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>80</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>array</span><span class=p>([[</span> <span class=mi>0</span><span class=p>,</span>  <span class=mi>1</span><span class=p>,</span>  <span class=mi>2</span><span class=p>,</span>  <span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>       <span class=p>[</span> <span class=mi>4</span><span class=p>,</span>  <span class=mi>5</span><span class=p>,</span>  <span class=mi>6</span><span class=p>,</span>  <span class=mi>7</span><span class=p>],</span>
</span></span><span class=line><span class=cl>       <span class=p>[</span> <span class=mi>8</span><span class=p>,</span>  <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>81</span><span class=p>]:</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>arr</span><span class=p>,</span> <span class=n>arr</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>81</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>array</span><span class=p>([[</span> <span class=mi>0</span><span class=p>,</span>  <span class=mi>1</span><span class=p>,</span>  <span class=mi>2</span><span class=p>,</span>  <span class=mi>3</span><span class=p>,</span>  <span class=mi>0</span><span class=p>,</span>  <span class=mi>1</span><span class=p>,</span>  <span class=mi>2</span><span class=p>,</span>  <span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>       <span class=p>[</span> <span class=mi>4</span><span class=p>,</span>  <span class=mi>5</span><span class=p>,</span>  <span class=mi>6</span><span class=p>,</span>  <span class=mi>7</span><span class=p>,</span>  <span class=mi>4</span><span class=p>,</span>  <span class=mi>5</span><span class=p>,</span>  <span class=mi>6</span><span class=p>,</span>  <span class=mi>7</span><span class=p>],</span>
</span></span><span class=line><span class=cl>       <span class=p>[</span> <span class=mi>8</span><span class=p>,</span>  <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span>  <span class=mi>8</span><span class=p>,</span>  <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>]])</span></span></span></code></pre></td></tr></table></div></div><p>对于pandas对象（如Series和DataFrame），带有标签的轴使你能够进一步推广数组的连接运算。具体点说，你还需要考虑以下这些东西：</p><ul><li>如果对象在其它轴上的索引不同，我们应该合并这些轴的不同元素还是只使用交集？</li><li>连接的数据集是否需要在结果对象中可识别？</li><li>连接轴中保存的数据是否需要保留？许多情况下，DataFrame默认的整数标签最好在连接时删掉。</li></ul><p>pandas的concat函数提供了一种能够解决这些问题的可靠方式。我将给出一些例子来讲解其使用方式。假设有三个没有重叠索引的Series：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1>1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2>2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3>3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4>4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>82</span><span class=p>]:</span> <span class=n>s1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>83</span><span class=p>]:</span> <span class=n>s2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>84</span><span class=p>]:</span> <span class=n>s3</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;f&#39;</span><span class=p>,</span> <span class=s1>&#39;g&#39;</span><span class=p>])</span></span></span></code></pre></td></tr></table></div></div><p>对这些对象调用concat可以将值和索引粘合在一起：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1> 1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2> 2</a>
</span><span class=lnt id=hl-36-3><a class=lnlinks href=#hl-36-3> 3</a>
</span><span class=lnt id=hl-36-4><a class=lnlinks href=#hl-36-4> 4</a>
</span><span class=lnt id=hl-36-5><a class=lnlinks href=#hl-36-5> 5</a>
</span><span class=lnt id=hl-36-6><a class=lnlinks href=#hl-36-6> 6</a>
</span><span class=lnt id=hl-36-7><a class=lnlinks href=#hl-36-7> 7</a>
</span><span class=lnt id=hl-36-8><a class=lnlinks href=#hl-36-8> 8</a>
</span><span class=lnt id=hl-36-9><a class=lnlinks href=#hl-36-9> 9</a>
</span><span class=lnt id=hl-36-10><a class=lnlinks href=#hl-36-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>85</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s2</span><span class=p>,</span> <span class=n>s3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>85</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>c</span>    <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>d</span>    <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>e</span>    <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>f</span>    <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>g</span>    <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>int64</span></span></span></code></pre></td></tr></table></div></div><p>默认情况下，concat是在axis=0上工作的，最终产生一个新的Series。如果传入axis=1，则结果就会变成一个DataFrame（axis=1是列）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1> 1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2> 2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3> 3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4> 4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5> 5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6> 6</a>
</span><span class=lnt id=hl-37-7><a class=lnlinks href=#hl-37-7> 7</a>
</span><span class=lnt id=hl-37-8><a class=lnlinks href=#hl-37-8> 8</a>
</span><span class=lnt id=hl-37-9><a class=lnlinks href=#hl-37-9> 9</a>
</span><span class=lnt id=hl-37-10><a class=lnlinks href=#hl-37-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>86</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s2</span><span class=p>,</span> <span class=n>s3</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>86</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>     <span class=mi>0</span>    <span class=mi>1</span>    <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>a</span>  <span class=mf>0.0</span>  <span class=n>NaN</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mf>1.0</span>  <span class=n>NaN</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=n>NaN</span>  <span class=mf>2.0</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>d</span>  <span class=n>NaN</span>  <span class=mf>3.0</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>e</span>  <span class=n>NaN</span>  <span class=mf>4.0</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>f</span>  <span class=n>NaN</span>  <span class=n>NaN</span>  <span class=mf>5.0</span>
</span></span><span class=line><span class=cl><span class=n>g</span>  <span class=n>NaN</span>  <span class=n>NaN</span>  <span class=mf>6.0</span></span></span></code></pre></td></tr></table></div></div><p>这种情况下，另外的轴上没有重叠，从索引的有序并集（外连接）上就可以看出来。传入join=&lsquo;inner&rsquo;即可得到它们的交集：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1> 1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2> 2</a>
</span><span class=lnt id=hl-38-3><a class=lnlinks href=#hl-38-3> 3</a>
</span><span class=lnt id=hl-38-4><a class=lnlinks href=#hl-38-4> 4</a>
</span><span class=lnt id=hl-38-5><a class=lnlinks href=#hl-38-5> 5</a>
</span><span class=lnt id=hl-38-6><a class=lnlinks href=#hl-38-6> 6</a>
</span><span class=lnt id=hl-38-7><a class=lnlinks href=#hl-38-7> 7</a>
</span><span class=lnt id=hl-38-8><a class=lnlinks href=#hl-38-8> 8</a>
</span><span class=lnt id=hl-38-9><a class=lnlinks href=#hl-38-9> 9</a>
</span><span class=lnt id=hl-38-10><a class=lnlinks href=#hl-38-10>10</a>
</span><span class=lnt id=hl-38-11><a class=lnlinks href=#hl-38-11>11</a>
</span><span class=lnt id=hl-38-12><a class=lnlinks href=#hl-38-12>12</a>
</span><span class=lnt id=hl-38-13><a class=lnlinks href=#hl-38-13>13</a>
</span><span class=lnt id=hl-38-14><a class=lnlinks href=#hl-38-14>14</a>
</span><span class=lnt id=hl-38-15><a class=lnlinks href=#hl-38-15>15</a>
</span><span class=lnt id=hl-38-16><a class=lnlinks href=#hl-38-16>16</a>
</span><span class=lnt id=hl-38-17><a class=lnlinks href=#hl-38-17>17</a>
</span><span class=lnt id=hl-38-18><a class=lnlinks href=#hl-38-18>18</a>
</span><span class=lnt id=hl-38-19><a class=lnlinks href=#hl-38-19>19</a>
</span><span class=lnt id=hl-38-20><a class=lnlinks href=#hl-38-20>20</a>
</span><span class=lnt id=hl-38-21><a class=lnlinks href=#hl-38-21>21</a>
</span><span class=lnt id=hl-38-22><a class=lnlinks href=#hl-38-22>22</a>
</span><span class=lnt id=hl-38-23><a class=lnlinks href=#hl-38-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>87</span><span class=p>]:</span> <span class=n>s4</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>88</span><span class=p>]:</span> <span class=n>s4</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>88</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>f</span>    <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>g</span>    <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>int64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>89</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s4</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>89</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>     <span class=mi>0</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>a</span>  <span class=mf>0.0</span>  <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mf>1.0</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>f</span>  <span class=n>NaN</span>  <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>g</span>  <span class=n>NaN</span>  <span class=mi>6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>90</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s4</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>join</span><span class=o>=</span><span class=s1>&#39;inner&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>90</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=mi>0</span>  <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>a</span>  <span class=mi>0</span>  <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mi>1</span>  <span class=mi>1</span></span></span></code></pre></td></tr></table></div></div><p>在这个例子中，f和g标签消失了，是因为使用的是join=&lsquo;inner&rsquo;选项。</p><p>你可以通过join_axes指定要在其它轴上使用的索引：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1>1</a>
</span><span class=lnt id=hl-39-2><a class=lnlinks href=#hl-39-2>2</a>
</span><span class=lnt id=hl-39-3><a class=lnlinks href=#hl-39-3>3</a>
</span><span class=lnt id=hl-39-4><a class=lnlinks href=#hl-39-4>4</a>
</span><span class=lnt id=hl-39-5><a class=lnlinks href=#hl-39-5>5</a>
</span><span class=lnt id=hl-39-6><a class=lnlinks href=#hl-39-6>6</a>
</span><span class=lnt id=hl-39-7><a class=lnlinks href=#hl-39-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>91</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s4</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>join_axes</span><span class=o>=</span><span class=p>[[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>91</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>     <span class=mi>0</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>a</span>  <span class=mf>0.0</span>  <span class=mf>0.0</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=n>NaN</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mf>1.0</span>  <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>  <span class=n>NaN</span>  <span class=n>NaN</span></span></span></code></pre></td></tr></table></div></div><p>不过有个问题，参与连接的片段在结果中区分不开。假设你想要在连接轴上创建一个层次化索引。使用keys参数即可达到这个目的：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1> 1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2> 2</a>
</span><span class=lnt id=hl-40-3><a class=lnlinks href=#hl-40-3> 3</a>
</span><span class=lnt id=hl-40-4><a class=lnlinks href=#hl-40-4> 4</a>
</span><span class=lnt id=hl-40-5><a class=lnlinks href=#hl-40-5> 5</a>
</span><span class=lnt id=hl-40-6><a class=lnlinks href=#hl-40-6> 6</a>
</span><span class=lnt id=hl-40-7><a class=lnlinks href=#hl-40-7> 7</a>
</span><span class=lnt id=hl-40-8><a class=lnlinks href=#hl-40-8> 8</a>
</span><span class=lnt id=hl-40-9><a class=lnlinks href=#hl-40-9> 9</a>
</span><span class=lnt id=hl-40-10><a class=lnlinks href=#hl-40-10>10</a>
</span><span class=lnt id=hl-40-11><a class=lnlinks href=#hl-40-11>11</a>
</span><span class=lnt id=hl-40-12><a class=lnlinks href=#hl-40-12>12</a>
</span><span class=lnt id=hl-40-13><a class=lnlinks href=#hl-40-13>13</a>
</span><span class=lnt id=hl-40-14><a class=lnlinks href=#hl-40-14>14</a>
</span><span class=lnt id=hl-40-15><a class=lnlinks href=#hl-40-15>15</a>
</span><span class=lnt id=hl-40-16><a class=lnlinks href=#hl-40-16>16</a>
</span><span class=lnt id=hl-40-17><a class=lnlinks href=#hl-40-17>17</a>
</span><span class=lnt id=hl-40-18><a class=lnlinks href=#hl-40-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>92</span><span class=p>]:</span> <span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s1</span><span class=p>,</span> <span class=n>s3</span><span class=p>],</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span><span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;three&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>93</span><span class=p>]:</span> <span class=n>result</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>93</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>one</span>    <span class=n>a</span>    <span class=mi>0</span>
</span></span><span class=line><span class=cl>       <span class=n>b</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>two</span>    <span class=n>a</span>    <span class=mi>0</span>
</span></span><span class=line><span class=cl>       <span class=n>b</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>three</span>  <span class=n>f</span>    <span class=mi>5</span>
</span></span><span class=line><span class=cl>       <span class=n>g</span>    <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>int64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>94</span><span class=p>]:</span> <span class=n>result</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>94</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>         <span class=n>a</span>    <span class=n>b</span>    <span class=n>f</span>    <span class=n>g</span>
</span></span><span class=line><span class=cl><span class=n>one</span>    <span class=mf>0.0</span>  <span class=mf>1.0</span>  <span class=n>NaN</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>two</span>    <span class=mf>0.0</span>  <span class=mf>1.0</span>  <span class=n>NaN</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>three</span>  <span class=n>NaN</span>  <span class=n>NaN</span>  <span class=mf>5.0</span>  <span class=mf>6.0</span></span></span></code></pre></td></tr></table></div></div><p>如果沿着axis=1对Series进行合并，则keys就会成为DataFrame的列头：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1> 1</a>
</span><span class=lnt id=hl-41-2><a class=lnlinks href=#hl-41-2> 2</a>
</span><span class=lnt id=hl-41-3><a class=lnlinks href=#hl-41-3> 3</a>
</span><span class=lnt id=hl-41-4><a class=lnlinks href=#hl-41-4> 4</a>
</span><span class=lnt id=hl-41-5><a class=lnlinks href=#hl-41-5> 5</a>
</span><span class=lnt id=hl-41-6><a class=lnlinks href=#hl-41-6> 6</a>
</span><span class=lnt id=hl-41-7><a class=lnlinks href=#hl-41-7> 7</a>
</span><span class=lnt id=hl-41-8><a class=lnlinks href=#hl-41-8> 8</a>
</span><span class=lnt id=hl-41-9><a class=lnlinks href=#hl-41-9> 9</a>
</span><span class=lnt id=hl-41-10><a class=lnlinks href=#hl-41-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>95</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s2</span><span class=p>,</span> <span class=n>s3</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span><span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;three&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>95</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>one</span>  <span class=n>two</span>  <span class=n>three</span>
</span></span><span class=line><span class=cl><span class=n>a</span>  <span class=mf>0.0</span>  <span class=n>NaN</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>b</span>  <span class=mf>1.0</span>  <span class=n>NaN</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>c</span>  <span class=n>NaN</span>  <span class=mf>2.0</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>d</span>  <span class=n>NaN</span>  <span class=mf>3.0</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>e</span>  <span class=n>NaN</span>  <span class=mf>4.0</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>f</span>  <span class=n>NaN</span>  <span class=n>NaN</span>    <span class=mf>5.0</span>
</span></span><span class=line><span class=cl><span class=n>g</span>  <span class=n>NaN</span>  <span class=n>NaN</span>    <span class=mf>6.0</span></span></span></code></pre></td></tr></table></div></div><p>同样的逻辑也适用于DataFrame对象：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1> 1</a>
</span><span class=lnt id=hl-42-2><a class=lnlinks href=#hl-42-2> 2</a>
</span><span class=lnt id=hl-42-3><a class=lnlinks href=#hl-42-3> 3</a>
</span><span class=lnt id=hl-42-4><a class=lnlinks href=#hl-42-4> 4</a>
</span><span class=lnt id=hl-42-5><a class=lnlinks href=#hl-42-5> 5</a>
</span><span class=lnt id=hl-42-6><a class=lnlinks href=#hl-42-6> 6</a>
</span><span class=lnt id=hl-42-7><a class=lnlinks href=#hl-42-7> 7</a>
</span><span class=lnt id=hl-42-8><a class=lnlinks href=#hl-42-8> 8</a>
</span><span class=lnt id=hl-42-9><a class=lnlinks href=#hl-42-9> 9</a>
</span><span class=lnt id=hl-42-10><a class=lnlinks href=#hl-42-10>10</a>
</span><span class=lnt id=hl-42-11><a class=lnlinks href=#hl-42-11>11</a>
</span><span class=lnt id=hl-42-12><a class=lnlinks href=#hl-42-12>12</a>
</span><span class=lnt id=hl-42-13><a class=lnlinks href=#hl-42-13>13</a>
</span><span class=lnt id=hl-42-14><a class=lnlinks href=#hl-42-14>14</a>
</span><span class=lnt id=hl-42-15><a class=lnlinks href=#hl-42-15>15</a>
</span><span class=lnt id=hl-42-16><a class=lnlinks href=#hl-42-16>16</a>
</span><span class=lnt id=hl-42-17><a class=lnlinks href=#hl-42-17>17</a>
</span><span class=lnt id=hl-42-18><a class=lnlinks href=#hl-42-18>18</a>
</span><span class=lnt id=hl-42-19><a class=lnlinks href=#hl-42-19>19</a>
</span><span class=lnt id=hl-42-20><a class=lnlinks href=#hl-42-20>20</a>
</span><span class=lnt id=hl-42-21><a class=lnlinks href=#hl-42-21>21</a>
</span><span class=lnt id=hl-42-22><a class=lnlinks href=#hl-42-22>22</a>
</span><span class=lnt id=hl-42-23><a class=lnlinks href=#hl-42-23>23</a>
</span><span class=lnt id=hl-42-24><a class=lnlinks href=#hl-42-24>24</a>
</span><span class=lnt id=hl-42-25><a class=lnlinks href=#hl-42-25>25</a>
</span><span class=lnt id=hl-42-26><a class=lnlinks href=#hl-42-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>96</span><span class=p>]:</span> <span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>97</span><span class=p>]:</span> <span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=mi>5</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>                    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;three&#39;</span><span class=p>,</span> <span class=s1>&#39;four&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>98</span><span class=p>]:</span> <span class=n>df1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>98</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>one</span>  <span class=n>two</span>
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=mi>0</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mi>2</span>    <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>c</span>    <span class=mi>4</span>    <span class=mi>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>99</span><span class=p>]:</span> <span class=n>df2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>99</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>three</span>  <span class=n>four</span>
</span></span><span class=line><span class=cl><span class=n>a</span>      <span class=mi>5</span>     <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=n>c</span>      <span class=mi>7</span>     <span class=mi>8</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>100</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;level1&#39;</span><span class=p>,</span> <span class=s1>&#39;level2&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>100</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>level1</span>     <span class=n>level2</span>     
</span></span><span class=line><span class=cl>     <span class=n>one</span> <span class=n>two</span>  <span class=n>three</span> <span class=n>four</span>
</span></span><span class=line><span class=cl><span class=n>a</span>      <span class=mi>0</span>   <span class=mi>1</span>    <span class=mf>5.0</span>  <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>      <span class=mi>2</span>   <span class=mi>3</span>    <span class=n>NaN</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>c</span>      <span class=mi>4</span>   <span class=mi>5</span>    <span class=mf>7.0</span>  <span class=mf>8.0</span></span></span></code></pre></td></tr></table></div></div><p>如果传入的不是列表而是一个字典，则字典的键就会被当做keys选项的值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1>1</a>
</span><span class=lnt id=hl-43-2><a class=lnlinks href=#hl-43-2>2</a>
</span><span class=lnt id=hl-43-3><a class=lnlinks href=#hl-43-3>3</a>
</span><span class=lnt id=hl-43-4><a class=lnlinks href=#hl-43-4>4</a>
</span><span class=lnt id=hl-43-5><a class=lnlinks href=#hl-43-5>5</a>
</span><span class=lnt id=hl-43-6><a class=lnlinks href=#hl-43-6>6</a>
</span><span class=lnt id=hl-43-7><a class=lnlinks href=#hl-43-7>7</a>
</span><span class=lnt id=hl-43-8><a class=lnlinks href=#hl-43-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>101</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>({</span><span class=s1>&#39;level1&#39;</span><span class=p>:</span> <span class=n>df1</span><span class=p>,</span> <span class=s1>&#39;level2&#39;</span><span class=p>:</span> <span class=n>df2</span><span class=p>},</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>101</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>level1</span>     <span class=n>level2</span>     
</span></span><span class=line><span class=cl>     <span class=n>one</span> <span class=n>two</span>  <span class=n>three</span> <span class=n>four</span>
</span></span><span class=line><span class=cl><span class=n>a</span>      <span class=mi>0</span>   <span class=mi>1</span>    <span class=mf>5.0</span>  <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>      <span class=mi>2</span>   <span class=mi>3</span>    <span class=n>NaN</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>c</span>      <span class=mi>4</span>   <span class=mi>5</span>    <span class=mf>7.0</span>  <span class=mf>8.0</span></span></span></code></pre></td></tr></table></div></div><p>此外还有两个用于管理层次化索引创建方式的参数（参见表8-3）。举个例子，我们可以用names参数命名创建的轴级别：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1>1</a>
</span><span class=lnt id=hl-44-2><a class=lnlinks href=#hl-44-2>2</a>
</span><span class=lnt id=hl-44-3><a class=lnlinks href=#hl-44-3>3</a>
</span><span class=lnt id=hl-44-4><a class=lnlinks href=#hl-44-4>4</a>
</span><span class=lnt id=hl-44-5><a class=lnlinks href=#hl-44-5>5</a>
</span><span class=lnt id=hl-44-6><a class=lnlinks href=#hl-44-6>6</a>
</span><span class=lnt id=hl-44-7><a class=lnlinks href=#hl-44-7>7</a>
</span><span class=lnt id=hl-44-8><a class=lnlinks href=#hl-44-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>102</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;level1&#39;</span><span class=p>,</span> <span class=s1>&#39;level2&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>           <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;upper&#39;</span><span class=p>,</span> <span class=s1>&#39;lower&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>102</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>upper</span> <span class=n>level1</span>     <span class=n>level2</span>     
</span></span><span class=line><span class=cl><span class=n>lower</span>    <span class=n>one</span> <span class=n>two</span>  <span class=n>three</span> <span class=n>four</span>
</span></span><span class=line><span class=cl><span class=n>a</span>          <span class=mi>0</span>   <span class=mi>1</span>    <span class=mf>5.0</span>  <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>          <span class=mi>2</span>   <span class=mi>3</span>    <span class=n>NaN</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>c</span>          <span class=mi>4</span>   <span class=mi>5</span>    <span class=mf>7.0</span>  <span class=mf>8.0</span></span></span></code></pre></td></tr></table></div></div><p>最后一个关于DataFrame的问题是，DataFrame的行索引不包含任何相关数据：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1> 1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2> 2</a>
</span><span class=lnt id=hl-45-3><a class=lnlinks href=#hl-45-3> 3</a>
</span><span class=lnt id=hl-45-4><a class=lnlinks href=#hl-45-4> 4</a>
</span><span class=lnt id=hl-45-5><a class=lnlinks href=#hl-45-5> 5</a>
</span><span class=lnt id=hl-45-6><a class=lnlinks href=#hl-45-6> 6</a>
</span><span class=lnt id=hl-45-7><a class=lnlinks href=#hl-45-7> 7</a>
</span><span class=lnt id=hl-45-8><a class=lnlinks href=#hl-45-8> 8</a>
</span><span class=lnt id=hl-45-9><a class=lnlinks href=#hl-45-9> 9</a>
</span><span class=lnt id=hl-45-10><a class=lnlinks href=#hl-45-10>10</a>
</span><span class=lnt id=hl-45-11><a class=lnlinks href=#hl-45-11>11</a>
</span><span class=lnt id=hl-45-12><a class=lnlinks href=#hl-45-12>12</a>
</span><span class=lnt id=hl-45-13><a class=lnlinks href=#hl-45-13>13</a>
</span><span class=lnt id=hl-45-14><a class=lnlinks href=#hl-45-14>14</a>
</span><span class=lnt id=hl-45-15><a class=lnlinks href=#hl-45-15>15</a>
</span><span class=lnt id=hl-45-16><a class=lnlinks href=#hl-45-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>103</span><span class=p>]:</span> <span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>),</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>104</span><span class=p>]:</span> <span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>105</span><span class=p>]:</span> <span class=n>df1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>105</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>          <span class=n>a</span>         <span class=n>b</span>         <span class=n>c</span>         <span class=n>d</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mf>1.246435</span>  <span class=mf>1.007189</span> <span class=o>-</span><span class=mf>1.296221</span>  <span class=mf>0.274992</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mf>0.228913</span>  <span class=mf>1.352917</span>  <span class=mf>0.886429</span> <span class=o>-</span><span class=mf>2.001637</span>
</span></span><span class=line><span class=cl><span class=mi>2</span> <span class=o>-</span><span class=mf>0.371843</span>  <span class=mf>1.669025</span> <span class=o>-</span><span class=mf>0.438570</span> <span class=o>-</span><span class=mf>0.539741</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>106</span><span class=p>]:</span> <span class=n>df2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>106</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>          <span class=n>b</span>         <span class=n>d</span>         <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mf>0.476985</span>  <span class=mf>3.248944</span> <span class=o>-</span><span class=mf>1.021228</span>
</span></span><span class=line><span class=cl><span class=mi>1</span> <span class=o>-</span><span class=mf>0.577087</span>  <span class=mf>0.124121</span>  <span class=mf>0.302614</span></span></span></code></pre></td></tr></table></div></div><p>在这种情况下，传入ignore_index=True即可：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-46-1><a class=lnlinks href=#hl-46-1>1</a>
</span><span class=lnt id=hl-46-2><a class=lnlinks href=#hl-46-2>2</a>
</span><span class=lnt id=hl-46-3><a class=lnlinks href=#hl-46-3>3</a>
</span><span class=lnt id=hl-46-4><a class=lnlinks href=#hl-46-4>4</a>
</span><span class=lnt id=hl-46-5><a class=lnlinks href=#hl-46-5>5</a>
</span><span class=lnt id=hl-46-6><a class=lnlinks href=#hl-46-6>6</a>
</span><span class=lnt id=hl-46-7><a class=lnlinks href=#hl-46-7>7</a>
</span><span class=lnt id=hl-46-8><a class=lnlinks href=#hl-46-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>107</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>107</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>          <span class=n>a</span>         <span class=n>b</span>         <span class=n>c</span>         <span class=n>d</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mf>1.246435</span>  <span class=mf>1.007189</span> <span class=o>-</span><span class=mf>1.296221</span>  <span class=mf>0.274992</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mf>0.228913</span>  <span class=mf>1.352917</span>  <span class=mf>0.886429</span> <span class=o>-</span><span class=mf>2.001637</span>
</span></span><span class=line><span class=cl><span class=mi>2</span> <span class=o>-</span><span class=mf>0.371843</span>  <span class=mf>1.669025</span> <span class=o>-</span><span class=mf>0.438570</span> <span class=o>-</span><span class=mf>0.539741</span>
</span></span><span class=line><span class=cl><span class=mi>3</span> <span class=o>-</span><span class=mf>1.021228</span>  <span class=mf>0.476985</span>       <span class=n>NaN</span>  <span class=mf>3.248944</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=mf>0.302614</span> <span class=o>-</span><span class=mf>0.577087</span>       <span class=n>NaN</span>  <span class=mf>0.124121</span></span></span></code></pre></td></tr></table></div></div><p><img src=/imgs/img-lazy-loading.gif data-src=https://gitee.com/wugenqiang/images/raw/master/02/1240-20201026235319409.png alt="表8-3 concat函数的参数"></p><h3 id=824-合并重叠数据>8.2.4 合并重叠数据
<a class=header-anchor href=#824-%e5%90%88%e5%b9%b6%e9%87%8d%e5%8f%a0%e6%95%b0%e6%8d%ae></a></h3><p>还有一种数据组合问题不能用简单的合并（merge）或连接（concatenation）运算来处理。比如说，你可能有索引全部或部分重叠的两个数据集。举个有启发性的例子，我们使用NumPy的where函数，它表示一种等价于面向数组的if-else：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1> 1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2> 2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3> 3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4> 4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5> 5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6> 6</a>
</span><span class=lnt id=hl-47-7><a class=lnlinks href=#hl-47-7> 7</a>
</span><span class=lnt id=hl-47-8><a class=lnlinks href=#hl-47-8> 8</a>
</span><span class=lnt id=hl-47-9><a class=lnlinks href=#hl-47-9> 9</a>
</span><span class=lnt id=hl-47-10><a class=lnlinks href=#hl-47-10>10</a>
</span><span class=lnt id=hl-47-11><a class=lnlinks href=#hl-47-11>11</a>
</span><span class=lnt id=hl-47-12><a class=lnlinks href=#hl-47-12>12</a>
</span><span class=lnt id=hl-47-13><a class=lnlinks href=#hl-47-13>13</a>
</span><span class=lnt id=hl-47-14><a class=lnlinks href=#hl-47-14>14</a>
</span><span class=lnt id=hl-47-15><a class=lnlinks href=#hl-47-15>15</a>
</span><span class=lnt id=hl-47-16><a class=lnlinks href=#hl-47-16>16</a>
</span><span class=lnt id=hl-47-17><a class=lnlinks href=#hl-47-17>17</a>
</span><span class=lnt id=hl-47-18><a class=lnlinks href=#hl-47-18>18</a>
</span><span class=lnt id=hl-47-19><a class=lnlinks href=#hl-47-19>19</a>
</span><span class=lnt id=hl-47-20><a class=lnlinks href=#hl-47-20>20</a>
</span><span class=lnt id=hl-47-21><a class=lnlinks href=#hl-47-21>21</a>
</span><span class=lnt id=hl-47-22><a class=lnlinks href=#hl-47-22>22</a>
</span><span class=lnt id=hl-47-23><a class=lnlinks href=#hl-47-23>23</a>
</span><span class=lnt id=hl-47-24><a class=lnlinks href=#hl-47-24>24</a>
</span><span class=lnt id=hl-47-25><a class=lnlinks href=#hl-47-25>25</a>
</span><span class=lnt id=hl-47-26><a class=lnlinks href=#hl-47-26>26</a>
</span><span class=lnt id=hl-47-27><a class=lnlinks href=#hl-47-27>27</a>
</span><span class=lnt id=hl-47-28><a class=lnlinks href=#hl-47-28>28</a>
</span><span class=lnt id=hl-47-29><a class=lnlinks href=#hl-47-29>29</a>
</span><span class=lnt id=hl-47-30><a class=lnlinks href=#hl-47-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>108</span><span class=p>]:</span> <span class=n>a</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mf>2.5</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>,</span> <span class=mf>4.5</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>               <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;f&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>109</span><span class=p>]:</span> <span class=n>b</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float64</span><span class=p>),</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>               <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;f&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>110</span><span class=p>]:</span> <span class=n>b</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>111</span><span class=p>]:</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>111</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>f</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>e</span>    <span class=mf>2.5</span>
</span></span><span class=line><span class=cl><span class=n>d</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>c</span>    <span class=mf>3.5</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mf>4.5</span>
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>112</span><span class=p>]:</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>112</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>f</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=n>d</span>    <span class=mf>2.0</span>
</span></span><span class=line><span class=cl><span class=n>c</span>    <span class=mf>3.0</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mf>4.0</span>
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>113</span><span class=p>]:</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>isnull</span><span class=p>(</span><span class=n>a</span><span class=p>),</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>113</span><span class=p>]:</span> <span class=n>array</span><span class=p>([</span> <span class=mf>0.</span> <span class=p>,</span>  <span class=mf>2.5</span><span class=p>,</span>  <span class=mf>2.</span> <span class=p>,</span>  <span class=mf>3.5</span><span class=p>,</span>  <span class=mf>4.5</span><span class=p>,</span>  <span class=n>nan</span><span class=p>])</span></span></span></code></pre></td></tr></table></div></div><p>Series有一个combine_first方法，实现的也是一样的功能，还带有pandas的数据对齐：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1>1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2>2</a>
</span><span class=lnt id=hl-48-3><a class=lnlinks href=#hl-48-3>3</a>
</span><span class=lnt id=hl-48-4><a class=lnlinks href=#hl-48-4>4</a>
</span><span class=lnt id=hl-48-5><a class=lnlinks href=#hl-48-5>5</a>
</span><span class=lnt id=hl-48-6><a class=lnlinks href=#hl-48-6>6</a>
</span><span class=lnt id=hl-48-7><a class=lnlinks href=#hl-48-7>7</a>
</span><span class=lnt id=hl-48-8><a class=lnlinks href=#hl-48-8>8</a>
</span><span class=lnt id=hl-48-9><a class=lnlinks href=#hl-48-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>114</span><span class=p>]:</span> <span class=n>b</span><span class=p>[:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>combine_first</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>:])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>114</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>a</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>b</span>    <span class=mf>4.5</span>
</span></span><span class=line><span class=cl><span class=n>c</span>    <span class=mf>3.0</span>
</span></span><span class=line><span class=cl><span class=n>d</span>    <span class=mf>2.0</span>
</span></span><span class=line><span class=cl><span class=n>e</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=n>f</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span></span></span></code></pre></td></tr></table></div></div><p>对于DataFrame，combine_first自然也会在列上做同样的事情，因此你可以将其看做：用传递对象中的数据为调用对象的缺失数据“打补丁”：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1> 1</a>
</span><span class=lnt id=hl-49-2><a class=lnlinks href=#hl-49-2> 2</a>
</span><span class=lnt id=hl-49-3><a class=lnlinks href=#hl-49-3> 3</a>
</span><span class=lnt id=hl-49-4><a class=lnlinks href=#hl-49-4> 4</a>
</span><span class=lnt id=hl-49-5><a class=lnlinks href=#hl-49-5> 5</a>
</span><span class=lnt id=hl-49-6><a class=lnlinks href=#hl-49-6> 6</a>
</span><span class=lnt id=hl-49-7><a class=lnlinks href=#hl-49-7> 7</a>
</span><span class=lnt id=hl-49-8><a class=lnlinks href=#hl-49-8> 8</a>
</span><span class=lnt id=hl-49-9><a class=lnlinks href=#hl-49-9> 9</a>
</span><span class=lnt id=hl-49-10><a class=lnlinks href=#hl-49-10>10</a>
</span><span class=lnt id=hl-49-11><a class=lnlinks href=#hl-49-11>11</a>
</span><span class=lnt id=hl-49-12><a class=lnlinks href=#hl-49-12>12</a>
</span><span class=lnt id=hl-49-13><a class=lnlinks href=#hl-49-13>13</a>
</span><span class=lnt id=hl-49-14><a class=lnlinks href=#hl-49-14>14</a>
</span><span class=lnt id=hl-49-15><a class=lnlinks href=#hl-49-15>15</a>
</span><span class=lnt id=hl-49-16><a class=lnlinks href=#hl-49-16>16</a>
</span><span class=lnt id=hl-49-17><a class=lnlinks href=#hl-49-17>17</a>
</span><span class=lnt id=hl-49-18><a class=lnlinks href=#hl-49-18>18</a>
</span><span class=lnt id=hl-49-19><a class=lnlinks href=#hl-49-19>19</a>
</span><span class=lnt id=hl-49-20><a class=lnlinks href=#hl-49-20>20</a>
</span><span class=lnt id=hl-49-21><a class=lnlinks href=#hl-49-21>21</a>
</span><span class=lnt id=hl-49-22><a class=lnlinks href=#hl-49-22>22</a>
</span><span class=lnt id=hl-49-23><a class=lnlinks href=#hl-49-23>23</a>
</span><span class=lnt id=hl-49-24><a class=lnlinks href=#hl-49-24>24</a>
</span><span class=lnt id=hl-49-25><a class=lnlinks href=#hl-49-25>25</a>
</span><span class=lnt id=hl-49-26><a class=lnlinks href=#hl-49-26>26</a>
</span><span class=lnt id=hl-49-27><a class=lnlinks href=#hl-49-27>27</a>
</span><span class=lnt id=hl-49-28><a class=lnlinks href=#hl-49-28>28</a>
</span><span class=lnt id=hl-49-29><a class=lnlinks href=#hl-49-29>29</a>
</span><span class=lnt id=hl-49-30><a class=lnlinks href=#hl-49-30>30</a>
</span><span class=lnt id=hl-49-31><a class=lnlinks href=#hl-49-31>31</a>
</span><span class=lnt id=hl-49-32><a class=lnlinks href=#hl-49-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>115</span><span class=p>]:</span> <span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>1.</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mf>5.</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                     <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mf>2.</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mf>6.</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                     <span class=s1>&#39;c&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>4</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>116</span><span class=p>]:</span> <span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>5.</span><span class=p>,</span> <span class=mf>4.</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mf>3.</span><span class=p>,</span> <span class=mf>7.</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                     <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mf>3.</span><span class=p>,</span> <span class=mf>4.</span><span class=p>,</span> <span class=mf>6.</span><span class=p>,</span> <span class=mf>8.</span><span class=p>]})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>117</span><span class=p>]:</span> <span class=n>df1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>117</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>     <span class=n>a</span>    <span class=n>b</span>   <span class=n>c</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mf>1.0</span>  <span class=n>NaN</span>   <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=n>NaN</span>  <span class=mf>2.0</span>   <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=mf>5.0</span>  <span class=n>NaN</span>  <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=n>NaN</span>  <span class=mf>6.0</span>  <span class=mi>14</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>118</span><span class=p>]:</span> <span class=n>df2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>118</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>     <span class=n>a</span>    <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mf>5.0</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mf>4.0</span>  <span class=mf>3.0</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=n>NaN</span>  <span class=mf>4.0</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=mf>3.0</span>  <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=mf>7.0</span>  <span class=mf>8.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>119</span><span class=p>]:</span> <span class=n>df1</span><span class=o>.</span><span class=n>combine_first</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>119</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>     <span class=n>a</span>    <span class=n>b</span>     <span class=n>c</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mf>1.0</span>  <span class=n>NaN</span>   <span class=mf>2.0</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mf>4.0</span>  <span class=mf>2.0</span>   <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=mf>5.0</span>  <span class=mf>4.0</span>  <span class=mf>10.0</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=mf>3.0</span>  <span class=mf>6.0</span>  <span class=mf>14.0</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=mf>7.0</span>  <span class=mf>8.0</span>   <span class=n>NaN</span></span></span></code></pre></td></tr></table></div></div><h2 id=83-重塑和轴向旋转>8.3 重塑和轴向旋转
<a class=header-anchor href=#83-%e9%87%8d%e5%a1%91%e5%92%8c%e8%bd%b4%e5%90%91%e6%97%8b%e8%bd%ac></a></h2><p>有许多用于重新排列表格型数据的基础运算。这些函数也称作重塑（reshape）或轴向旋转（pivot）运算。</p><h3 id=831-重塑层次化索引>8.3.1 重塑层次化索引
<a class=header-anchor href=#831-%e9%87%8d%e5%a1%91%e5%b1%82%e6%ac%a1%e5%8c%96%e7%b4%a2%e5%bc%95></a></h3><p>层次化索引为DataFrame数据的重排任务提供了一种具有良好一致性的方式。主要功能有二：</p><ul><li>stack：将数据的列“旋转”为行。</li><li>unstack：将数据的行“旋转”为列。</li></ul><p>我将通过一系列的范例来讲解这些操作。接下来看一个简单的DataFrame，其中的行列索引均为字符串数组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-50-1><a class=lnlinks href=#hl-50-1> 1</a>
</span><span class=lnt id=hl-50-2><a class=lnlinks href=#hl-50-2> 2</a>
</span><span class=lnt id=hl-50-3><a class=lnlinks href=#hl-50-3> 3</a>
</span><span class=lnt id=hl-50-4><a class=lnlinks href=#hl-50-4> 4</a>
</span><span class=lnt id=hl-50-5><a class=lnlinks href=#hl-50-5> 5</a>
</span><span class=lnt id=hl-50-6><a class=lnlinks href=#hl-50-6> 6</a>
</span><span class=lnt id=hl-50-7><a class=lnlinks href=#hl-50-7> 7</a>
</span><span class=lnt id=hl-50-8><a class=lnlinks href=#hl-50-8> 8</a>
</span><span class=lnt id=hl-50-9><a class=lnlinks href=#hl-50-9> 9</a>
</span><span class=lnt id=hl-50-10><a class=lnlinks href=#hl-50-10>10</a>
</span><span class=lnt id=hl-50-11><a class=lnlinks href=#hl-50-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>120</span><span class=p>]:</span> <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                     <span class=n>index</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>Index</span><span class=p>([</span><span class=s1>&#39;Ohio&#39;</span><span class=p>,</span><span class=s1>&#39;Colorado&#39;</span><span class=p>],</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;state&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                     <span class=n>columns</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>Index</span><span class=p>([</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;three&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                     <span class=n>name</span><span class=o>=</span><span class=s1>&#39;number&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>121</span><span class=p>]:</span> <span class=n>data</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>121</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>number</span>    <span class=n>one</span>  <span class=n>two</span>  <span class=n>three</span>
</span></span><span class=line><span class=cl><span class=n>state</span>                    
</span></span><span class=line><span class=cl><span class=n>Ohio</span>        <span class=mi>0</span>    <span class=mi>1</span>      <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>Colorado</span>    <span class=mi>3</span>    <span class=mi>4</span>      <span class=mi>5</span></span></span></code></pre></td></tr></table></div></div><p>对该数据使用stack方法即可将列转换为行，得到一个Series：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-51-1><a class=lnlinks href=#hl-51-1> 1</a>
</span><span class=lnt id=hl-51-2><a class=lnlinks href=#hl-51-2> 2</a>
</span><span class=lnt id=hl-51-3><a class=lnlinks href=#hl-51-3> 3</a>
</span><span class=lnt id=hl-51-4><a class=lnlinks href=#hl-51-4> 4</a>
</span><span class=lnt id=hl-51-5><a class=lnlinks href=#hl-51-5> 5</a>
</span><span class=lnt id=hl-51-6><a class=lnlinks href=#hl-51-6> 6</a>
</span><span class=lnt id=hl-51-7><a class=lnlinks href=#hl-51-7> 7</a>
</span><span class=lnt id=hl-51-8><a class=lnlinks href=#hl-51-8> 8</a>
</span><span class=lnt id=hl-51-9><a class=lnlinks href=#hl-51-9> 9</a>
</span><span class=lnt id=hl-51-10><a class=lnlinks href=#hl-51-10>10</a>
</span><span class=lnt id=hl-51-11><a class=lnlinks href=#hl-51-11>11</a>
</span><span class=lnt id=hl-51-12><a class=lnlinks href=#hl-51-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>122</span><span class=p>]:</span> <span class=n>result</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>stack</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>123</span><span class=p>]:</span> <span class=n>result</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>123</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>     <span class=n>number</span>
</span></span><span class=line><span class=cl><span class=n>Ohio</span>      <span class=n>one</span>       <span class=mi>0</span>
</span></span><span class=line><span class=cl>          <span class=n>two</span>       <span class=mi>1</span>
</span></span><span class=line><span class=cl>          <span class=n>three</span>     <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>Colorado</span>  <span class=n>one</span>       <span class=mi>3</span>
</span></span><span class=line><span class=cl>          <span class=n>two</span>       <span class=mi>4</span>
</span></span><span class=line><span class=cl>          <span class=n>three</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>int64</span></span></span></code></pre></td></tr></table></div></div><p>对于一个层次化索引的Series，你可以用unstack将其重排为一个DataFrame：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-52-1><a class=lnlinks href=#hl-52-1>1</a>
</span><span class=lnt id=hl-52-2><a class=lnlinks href=#hl-52-2>2</a>
</span><span class=lnt id=hl-52-3><a class=lnlinks href=#hl-52-3>3</a>
</span><span class=lnt id=hl-52-4><a class=lnlinks href=#hl-52-4>4</a>
</span><span class=lnt id=hl-52-5><a class=lnlinks href=#hl-52-5>5</a>
</span><span class=lnt id=hl-52-6><a class=lnlinks href=#hl-52-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>124</span><span class=p>]:</span> <span class=n>result</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>124</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>number</span>    <span class=n>one</span>  <span class=n>two</span>  <span class=n>three</span>
</span></span><span class=line><span class=cl><span class=n>state</span>                    
</span></span><span class=line><span class=cl><span class=n>Ohio</span>        <span class=mi>0</span>    <span class=mi>1</span>      <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>Colorado</span>    <span class=mi>3</span>    <span class=mi>4</span>      <span class=mi>5</span></span></span></code></pre></td></tr></table></div></div><p>默认情况下，unstack操作的是最内层（stack也是如此）。传入分层级别的编号或名称即可对其它级别进行unstack操作：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-53-1><a class=lnlinks href=#hl-53-1> 1</a>
</span><span class=lnt id=hl-53-2><a class=lnlinks href=#hl-53-2> 2</a>
</span><span class=lnt id=hl-53-3><a class=lnlinks href=#hl-53-3> 3</a>
</span><span class=lnt id=hl-53-4><a class=lnlinks href=#hl-53-4> 4</a>
</span><span class=lnt id=hl-53-5><a class=lnlinks href=#hl-53-5> 5</a>
</span><span class=lnt id=hl-53-6><a class=lnlinks href=#hl-53-6> 6</a>
</span><span class=lnt id=hl-53-7><a class=lnlinks href=#hl-53-7> 7</a>
</span><span class=lnt id=hl-53-8><a class=lnlinks href=#hl-53-8> 8</a>
</span><span class=lnt id=hl-53-9><a class=lnlinks href=#hl-53-9> 9</a>
</span><span class=lnt id=hl-53-10><a class=lnlinks href=#hl-53-10>10</a>
</span><span class=lnt id=hl-53-11><a class=lnlinks href=#hl-53-11>11</a>
</span><span class=lnt id=hl-53-12><a class=lnlinks href=#hl-53-12>12</a>
</span><span class=lnt id=hl-53-13><a class=lnlinks href=#hl-53-13>13</a>
</span><span class=lnt id=hl-53-14><a class=lnlinks href=#hl-53-14>14</a>
</span><span class=lnt id=hl-53-15><a class=lnlinks href=#hl-53-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>125</span><span class=p>]:</span> <span class=n>result</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>125</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>   <span class=n>Ohio</span>  <span class=n>Colorado</span>
</span></span><span class=line><span class=cl><span class=n>number</span>                
</span></span><span class=line><span class=cl><span class=n>one</span>        <span class=mi>0</span>         <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>two</span>        <span class=mi>1</span>         <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>three</span>      <span class=mi>2</span>         <span class=mi>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>126</span><span class=p>]:</span> <span class=n>result</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=s1>&#39;state&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>126</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>   <span class=n>Ohio</span>  <span class=n>Colorado</span>
</span></span><span class=line><span class=cl><span class=n>number</span>                
</span></span><span class=line><span class=cl><span class=n>one</span>        <span class=mi>0</span>         <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>two</span>        <span class=mi>1</span>         <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>three</span>      <span class=mi>2</span>         <span class=mi>5</span></span></span></code></pre></td></tr></table></div></div><p>如果不是所有的级别值都能在各分组中找到的话，则unstack操作可能会引入缺失数据：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-54-1><a class=lnlinks href=#hl-54-1> 1</a>
</span><span class=lnt id=hl-54-2><a class=lnlinks href=#hl-54-2> 2</a>
</span><span class=lnt id=hl-54-3><a class=lnlinks href=#hl-54-3> 3</a>
</span><span class=lnt id=hl-54-4><a class=lnlinks href=#hl-54-4> 4</a>
</span><span class=lnt id=hl-54-5><a class=lnlinks href=#hl-54-5> 5</a>
</span><span class=lnt id=hl-54-6><a class=lnlinks href=#hl-54-6> 6</a>
</span><span class=lnt id=hl-54-7><a class=lnlinks href=#hl-54-7> 7</a>
</span><span class=lnt id=hl-54-8><a class=lnlinks href=#hl-54-8> 8</a>
</span><span class=lnt id=hl-54-9><a class=lnlinks href=#hl-54-9> 9</a>
</span><span class=lnt id=hl-54-10><a class=lnlinks href=#hl-54-10>10</a>
</span><span class=lnt id=hl-54-11><a class=lnlinks href=#hl-54-11>11</a>
</span><span class=lnt id=hl-54-12><a class=lnlinks href=#hl-54-12>12</a>
</span><span class=lnt id=hl-54-13><a class=lnlinks href=#hl-54-13>13</a>
</span><span class=lnt id=hl-54-14><a class=lnlinks href=#hl-54-14>14</a>
</span><span class=lnt id=hl-54-15><a class=lnlinks href=#hl-54-15>15</a>
</span><span class=lnt id=hl-54-16><a class=lnlinks href=#hl-54-16>16</a>
</span><span class=lnt id=hl-54-17><a class=lnlinks href=#hl-54-17>17</a>
</span><span class=lnt id=hl-54-18><a class=lnlinks href=#hl-54-18>18</a>
</span><span class=lnt id=hl-54-19><a class=lnlinks href=#hl-54-19>19</a>
</span><span class=lnt id=hl-54-20><a class=lnlinks href=#hl-54-20>20</a>
</span><span class=lnt id=hl-54-21><a class=lnlinks href=#hl-54-21>21</a>
</span><span class=lnt id=hl-54-22><a class=lnlinks href=#hl-54-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>127</span><span class=p>]:</span> <span class=n>s1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>128</span><span class=p>]:</span> <span class=n>s2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>129</span><span class=p>]:</span> <span class=n>data2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span> <span class=n>s2</span><span class=p>],</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>130</span><span class=p>]:</span> <span class=n>data2</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>130</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>one</span>  <span class=n>a</span>    <span class=mi>0</span>
</span></span><span class=line><span class=cl>     <span class=n>b</span>    <span class=mi>1</span>
</span></span><span class=line><span class=cl>     <span class=n>c</span>    <span class=mi>2</span>
</span></span><span class=line><span class=cl>     <span class=n>d</span>    <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>two</span>  <span class=n>c</span>    <span class=mi>4</span>
</span></span><span class=line><span class=cl>     <span class=n>d</span>    <span class=mi>5</span>
</span></span><span class=line><span class=cl>     <span class=n>e</span>    <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>int64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>131</span><span class=p>]:</span> <span class=n>data2</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>131</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>       <span class=n>a</span>    <span class=n>b</span>    <span class=n>c</span>    <span class=n>d</span>    <span class=n>e</span>
</span></span><span class=line><span class=cl><span class=n>one</span>  <span class=mf>0.0</span>  <span class=mf>1.0</span>  <span class=mf>2.0</span>  <span class=mf>3.0</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>two</span>  <span class=n>NaN</span>  <span class=n>NaN</span>  <span class=mf>4.0</span>  <span class=mf>5.0</span>  <span class=mf>6.0</span></span></span></code></pre></td></tr></table></div></div><p>stack默认会滤除缺失数据，因此该运算是可逆的：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-55-1><a class=lnlinks href=#hl-55-1> 1</a>
</span><span class=lnt id=hl-55-2><a class=lnlinks href=#hl-55-2> 2</a>
</span><span class=lnt id=hl-55-3><a class=lnlinks href=#hl-55-3> 3</a>
</span><span class=lnt id=hl-55-4><a class=lnlinks href=#hl-55-4> 4</a>
</span><span class=lnt id=hl-55-5><a class=lnlinks href=#hl-55-5> 5</a>
</span><span class=lnt id=hl-55-6><a class=lnlinks href=#hl-55-6> 6</a>
</span><span class=lnt id=hl-55-7><a class=lnlinks href=#hl-55-7> 7</a>
</span><span class=lnt id=hl-55-8><a class=lnlinks href=#hl-55-8> 8</a>
</span><span class=lnt id=hl-55-9><a class=lnlinks href=#hl-55-9> 9</a>
</span><span class=lnt id=hl-55-10><a class=lnlinks href=#hl-55-10>10</a>
</span><span class=lnt id=hl-55-11><a class=lnlinks href=#hl-55-11>11</a>
</span><span class=lnt id=hl-55-12><a class=lnlinks href=#hl-55-12>12</a>
</span><span class=lnt id=hl-55-13><a class=lnlinks href=#hl-55-13>13</a>
</span><span class=lnt id=hl-55-14><a class=lnlinks href=#hl-55-14>14</a>
</span><span class=lnt id=hl-55-15><a class=lnlinks href=#hl-55-15>15</a>
</span><span class=lnt id=hl-55-16><a class=lnlinks href=#hl-55-16>16</a>
</span><span class=lnt id=hl-55-17><a class=lnlinks href=#hl-55-17>17</a>
</span><span class=lnt id=hl-55-18><a class=lnlinks href=#hl-55-18>18</a>
</span><span class=lnt id=hl-55-19><a class=lnlinks href=#hl-55-19>19</a>
</span><span class=lnt id=hl-55-20><a class=lnlinks href=#hl-55-20>20</a>
</span><span class=lnt id=hl-55-21><a class=lnlinks href=#hl-55-21>21</a>
</span><span class=lnt id=hl-55-22><a class=lnlinks href=#hl-55-22>22</a>
</span><span class=lnt id=hl-55-23><a class=lnlinks href=#hl-55-23>23</a>
</span><span class=lnt id=hl-55-24><a class=lnlinks href=#hl-55-24>24</a>
</span><span class=lnt id=hl-55-25><a class=lnlinks href=#hl-55-25>25</a>
</span><span class=lnt id=hl-55-26><a class=lnlinks href=#hl-55-26>26</a>
</span><span class=lnt id=hl-55-27><a class=lnlinks href=#hl-55-27>27</a>
</span><span class=lnt id=hl-55-28><a class=lnlinks href=#hl-55-28>28</a>
</span><span class=lnt id=hl-55-29><a class=lnlinks href=#hl-55-29>29</a>
</span><span class=lnt id=hl-55-30><a class=lnlinks href=#hl-55-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>132</span><span class=p>]:</span> <span class=n>data2</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>132</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>       <span class=n>a</span>    <span class=n>b</span>    <span class=n>c</span>    <span class=n>d</span>    <span class=n>e</span>
</span></span><span class=line><span class=cl><span class=n>one</span>  <span class=mf>0.0</span>  <span class=mf>1.0</span>  <span class=mf>2.0</span>  <span class=mf>3.0</span>  <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>two</span>  <span class=n>NaN</span>  <span class=n>NaN</span>  <span class=mf>4.0</span>  <span class=mf>5.0</span>  <span class=mf>6.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>133</span><span class=p>]:</span> <span class=n>data2</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span><span class=o>.</span><span class=n>stack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>133</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>one</span>  <span class=n>a</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>     <span class=n>b</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl>     <span class=n>c</span>    <span class=mf>2.0</span>
</span></span><span class=line><span class=cl>     <span class=n>d</span>    <span class=mf>3.0</span>
</span></span><span class=line><span class=cl><span class=n>two</span>  <span class=n>c</span>    <span class=mf>4.0</span>
</span></span><span class=line><span class=cl>     <span class=n>d</span>    <span class=mf>5.0</span>
</span></span><span class=line><span class=cl>     <span class=n>e</span>    <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>134</span><span class=p>]:</span> <span class=n>data2</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span><span class=o>.</span><span class=n>stack</span><span class=p>(</span><span class=n>dropna</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>134</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>one</span>  <span class=n>a</span>    <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>     <span class=n>b</span>    <span class=mf>1.0</span>
</span></span><span class=line><span class=cl>     <span class=n>c</span>    <span class=mf>2.0</span>
</span></span><span class=line><span class=cl>     <span class=n>d</span>    <span class=mf>3.0</span>
</span></span><span class=line><span class=cl>     <span class=n>e</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl><span class=n>two</span>  <span class=n>a</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl>     <span class=n>b</span>    <span class=n>NaN</span>
</span></span><span class=line><span class=cl>     <span class=n>c</span>    <span class=mf>4.0</span>
</span></span><span class=line><span class=cl>     <span class=n>d</span>    <span class=mf>5.0</span>
</span></span><span class=line><span class=cl>     <span class=n>e</span>    <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span></span></span></code></pre></td></tr></table></div></div><p>在对DataFrame进行unstack操作时，作为旋转轴的级别将会成为结果中的最低级别：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-56-1><a class=lnlinks href=#hl-56-1> 1</a>
</span><span class=lnt id=hl-56-2><a class=lnlinks href=#hl-56-2> 2</a>
</span><span class=lnt id=hl-56-3><a class=lnlinks href=#hl-56-3> 3</a>
</span><span class=lnt id=hl-56-4><a class=lnlinks href=#hl-56-4> 4</a>
</span><span class=lnt id=hl-56-5><a class=lnlinks href=#hl-56-5> 5</a>
</span><span class=lnt id=hl-56-6><a class=lnlinks href=#hl-56-6> 6</a>
</span><span class=lnt id=hl-56-7><a class=lnlinks href=#hl-56-7> 7</a>
</span><span class=lnt id=hl-56-8><a class=lnlinks href=#hl-56-8> 8</a>
</span><span class=lnt id=hl-56-9><a class=lnlinks href=#hl-56-9> 9</a>
</span><span class=lnt id=hl-56-10><a class=lnlinks href=#hl-56-10>10</a>
</span><span class=lnt id=hl-56-11><a class=lnlinks href=#hl-56-11>11</a>
</span><span class=lnt id=hl-56-12><a class=lnlinks href=#hl-56-12>12</a>
</span><span class=lnt id=hl-56-13><a class=lnlinks href=#hl-56-13>13</a>
</span><span class=lnt id=hl-56-14><a class=lnlinks href=#hl-56-14>14</a>
</span><span class=lnt id=hl-56-15><a class=lnlinks href=#hl-56-15>15</a>
</span><span class=lnt id=hl-56-16><a class=lnlinks href=#hl-56-16>16</a>
</span><span class=lnt id=hl-56-17><a class=lnlinks href=#hl-56-17>17</a>
</span><span class=lnt id=hl-56-18><a class=lnlinks href=#hl-56-18>18</a>
</span><span class=lnt id=hl-56-19><a class=lnlinks href=#hl-56-19>19</a>
</span><span class=lnt id=hl-56-20><a class=lnlinks href=#hl-56-20>20</a>
</span><span class=lnt id=hl-56-21><a class=lnlinks href=#hl-56-21>21</a>
</span><span class=lnt id=hl-56-22><a class=lnlinks href=#hl-56-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>135</span><span class=p>]:</span> <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;left&#39;</span><span class=p>:</span> <span class=n>result</span><span class=p>,</span> <span class=s1>&#39;right&#39;</span><span class=p>:</span> <span class=n>result</span> <span class=o>+</span> <span class=mi>5</span><span class=p>},</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                   <span class=n>columns</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>Index</span><span class=p>([</span><span class=s1>&#39;left&#39;</span><span class=p>,</span> <span class=s1>&#39;right&#39;</span><span class=p>],</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;side&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>136</span><span class=p>]:</span> <span class=n>df</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>136</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>side</span>             <span class=n>left</span>  <span class=n>right</span>
</span></span><span class=line><span class=cl><span class=n>state</span>    <span class=n>number</span>             
</span></span><span class=line><span class=cl><span class=n>Ohio</span>     <span class=n>one</span>        <span class=mi>0</span>      <span class=mi>5</span>
</span></span><span class=line><span class=cl>         <span class=n>two</span>        <span class=mi>1</span>      <span class=mi>6</span>
</span></span><span class=line><span class=cl>         <span class=n>three</span>      <span class=mi>2</span>      <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=n>Colorado</span> <span class=n>one</span>        <span class=mi>3</span>      <span class=mi>8</span>
</span></span><span class=line><span class=cl>         <span class=n>two</span>        <span class=mi>4</span>      <span class=mi>9</span>
</span></span><span class=line><span class=cl>         <span class=n>three</span>      <span class=mi>5</span>     <span class=mi>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>137</span><span class=p>]:</span> <span class=n>df</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=s1>&#39;state&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>137</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>side</span>   <span class=n>left</span>          <span class=n>right</span>
</span></span><span class=line><span class=cl><span class=n>state</span>  <span class=n>Ohio</span> <span class=n>Colorado</span>  <span class=n>Ohio</span> <span class=n>Colorado</span>
</span></span><span class=line><span class=cl><span class=n>number</span>                             
</span></span><span class=line><span class=cl><span class=n>one</span>       <span class=mi>0</span>        <span class=mi>3</span>     <span class=mi>5</span>        <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>two</span>       <span class=mi>1</span>        <span class=mi>4</span>     <span class=mi>6</span>        <span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>three</span>     <span class=mi>2</span>        <span class=mi>5</span>     <span class=mi>7</span>       <span class=mi>10</span></span></span></code></pre></td></tr></table></div></div><p>当调用stack，我们可以指明轴的名字：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-57-1><a class=lnlinks href=#hl-57-1> 1</a>
</span><span class=lnt id=hl-57-2><a class=lnlinks href=#hl-57-2> 2</a>
</span><span class=lnt id=hl-57-3><a class=lnlinks href=#hl-57-3> 3</a>
</span><span class=lnt id=hl-57-4><a class=lnlinks href=#hl-57-4> 4</a>
</span><span class=lnt id=hl-57-5><a class=lnlinks href=#hl-57-5> 5</a>
</span><span class=lnt id=hl-57-6><a class=lnlinks href=#hl-57-6> 6</a>
</span><span class=lnt id=hl-57-7><a class=lnlinks href=#hl-57-7> 7</a>
</span><span class=lnt id=hl-57-8><a class=lnlinks href=#hl-57-8> 8</a>
</span><span class=lnt id=hl-57-9><a class=lnlinks href=#hl-57-9> 9</a>
</span><span class=lnt id=hl-57-10><a class=lnlinks href=#hl-57-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>138</span><span class=p>]:</span> <span class=n>df</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=s1>&#39;state&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>stack</span><span class=p>(</span><span class=s1>&#39;side&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>138</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>state</span>         <span class=n>Colorado</span>  <span class=n>Ohio</span>
</span></span><span class=line><span class=cl><span class=n>number</span> <span class=n>side</span>                 
</span></span><span class=line><span class=cl><span class=n>one</span>    <span class=n>left</span>          <span class=mi>3</span>     <span class=mi>0</span>
</span></span><span class=line><span class=cl>       <span class=n>right</span>         <span class=mi>8</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>two</span>    <span class=n>left</span>          <span class=mi>4</span>     <span class=mi>1</span>
</span></span><span class=line><span class=cl>       <span class=n>right</span>         <span class=mi>9</span>     <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=n>three</span>  <span class=n>left</span>          <span class=mi>5</span>     <span class=mi>2</span>
</span></span><span class=line><span class=cl>       <span class=n>right</span>        <span class=mi>10</span>     <span class=mi>7</span></span></span></code></pre></td></tr></table></div></div><h3 id=832-将长格式旋转为宽格式>8.3.2 将“长格式”旋转为“宽格式”
<a class=header-anchor href=#832-%e5%b0%86%e9%95%bf%e6%a0%bc%e5%bc%8f%e6%97%8b%e8%bd%ac%e4%b8%ba%e5%ae%bd%e6%a0%bc%e5%bc%8f></a></h3><p>多个时间序列数据通常是以所谓的“长格式”（long）或“堆叠格式”（stacked）存储在数据库和CSV中的。我们先加载一些示例数据，做一些时间序列规整和数据清洗：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1> 1</a>
</span><span class=lnt id=hl-58-2><a class=lnlinks href=#hl-58-2> 2</a>
</span><span class=lnt id=hl-58-3><a class=lnlinks href=#hl-58-3> 3</a>
</span><span class=lnt id=hl-58-4><a class=lnlinks href=#hl-58-4> 4</a>
</span><span class=lnt id=hl-58-5><a class=lnlinks href=#hl-58-5> 5</a>
</span><span class=lnt id=hl-58-6><a class=lnlinks href=#hl-58-6> 6</a>
</span><span class=lnt id=hl-58-7><a class=lnlinks href=#hl-58-7> 7</a>
</span><span class=lnt id=hl-58-8><a class=lnlinks href=#hl-58-8> 8</a>
</span><span class=lnt id=hl-58-9><a class=lnlinks href=#hl-58-9> 9</a>
</span><span class=lnt id=hl-58-10><a class=lnlinks href=#hl-58-10>10</a>
</span><span class=lnt id=hl-58-11><a class=lnlinks href=#hl-58-11>11</a>
</span><span class=lnt id=hl-58-12><a class=lnlinks href=#hl-58-12>12</a>
</span><span class=lnt id=hl-58-13><a class=lnlinks href=#hl-58-13>13</a>
</span><span class=lnt id=hl-58-14><a class=lnlinks href=#hl-58-14>14</a>
</span><span class=lnt id=hl-58-15><a class=lnlinks href=#hl-58-15>15</a>
</span><span class=lnt id=hl-58-16><a class=lnlinks href=#hl-58-16>16</a>
</span><span class=lnt id=hl-58-17><a class=lnlinks href=#hl-58-17>17</a>
</span><span class=lnt id=hl-58-18><a class=lnlinks href=#hl-58-18>18</a>
</span><span class=lnt id=hl-58-19><a class=lnlinks href=#hl-58-19>19</a>
</span><span class=lnt id=hl-58-20><a class=lnlinks href=#hl-58-20>20</a>
</span><span class=lnt id=hl-58-21><a class=lnlinks href=#hl-58-21>21</a>
</span><span class=lnt id=hl-58-22><a class=lnlinks href=#hl-58-22>22</a>
</span><span class=lnt id=hl-58-23><a class=lnlinks href=#hl-58-23>23</a>
</span><span class=lnt id=hl-58-24><a class=lnlinks href=#hl-58-24>24</a>
</span><span class=lnt id=hl-58-25><a class=lnlinks href=#hl-58-25>25</a>
</span><span class=lnt id=hl-58-26><a class=lnlinks href=#hl-58-26>26</a>
</span><span class=lnt id=hl-58-27><a class=lnlinks href=#hl-58-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>139</span><span class=p>]:</span> <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;examples/macrodata.csv&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>140</span><span class=p>]:</span> <span class=n>data</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>140</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>     <span class=n>year</span>  <span class=n>quarter</span>   <span class=n>realgdp</span>  <span class=n>realcons</span>  <span class=n>realinv</span>  <span class=n>realgovt</span>  <span class=n>realdpi</span>    <span class=n>cpi</span>  \
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mf>1959.0</span>      <span class=mf>1.0</span>  <span class=mf>2710.349</span>    <span class=mf>1707.4</span>  <span class=mf>286.898</span>   <span class=mf>470.045</span>   <span class=mf>1886.9</span>  <span class=mf>28.98</span>   
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mf>1959.0</span>      <span class=mf>2.0</span>  <span class=mf>2778.801</span>    <span class=mf>1733.7</span>  <span class=mf>310.859</span>   <span class=mf>481.301</span>   <span class=mf>1919.7</span>  <span class=mf>29.15</span>   
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=mf>1959.0</span>      <span class=mf>3.0</span>  <span class=mf>2775.488</span>    <span class=mf>1751.8</span>  <span class=mf>289.226</span>   <span class=mf>491.260</span>   <span class=mf>1916.4</span>  <span class=mf>29.35</span>   
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=mf>1959.0</span>      <span class=mf>4.0</span>  <span class=mf>2785.204</span>    <span class=mf>1753.7</span>  <span class=mf>299.356</span>   <span class=mf>484.052</span>   <span class=mf>1931.3</span>  <span class=mf>29.37</span>   
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=mf>1960.0</span>      <span class=mf>1.0</span>  <span class=mf>2847.699</span>    <span class=mf>1770.5</span>  <span class=mf>331.722</span>   <span class=mf>462.199</span>   <span class=mf>1955.5</span>  <span class=mf>29.54</span>   
</span></span><span class=line><span class=cl>      <span class=n>m1</span>  <span class=n>tbilrate</span>  <span class=n>unemp</span>      <span class=n>pop</span>  <span class=n>infl</span>  <span class=n>realint</span>  
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mf>139.7</span>      <span class=mf>2.82</span>    <span class=mf>5.8</span>  <span class=mf>177.146</span>  <span class=mf>0.00</span>     <span class=mf>0.00</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mf>141.7</span>      <span class=mf>3.08</span>    <span class=mf>5.1</span>  <span class=mf>177.830</span>  <span class=mf>2.34</span>     <span class=mf>0.74</span>  
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=mf>140.5</span>      <span class=mf>3.82</span>    <span class=mf>5.3</span>  <span class=mf>178.657</span>  <span class=mf>2.74</span>     <span class=mf>1.09</span>  
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=mf>140.0</span>      <span class=mf>4.33</span>    <span class=mf>5.6</span>  <span class=mf>179.386</span>  <span class=mf>0.27</span>     <span class=mf>4.06</span>  
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=mf>139.6</span>      <span class=mf>3.50</span>    <span class=mf>5.2</span>  <span class=mf>180.007</span>  <span class=mf>2.31</span>     <span class=mf>1.19</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>141</span><span class=p>]:</span> <span class=n>periods</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>PeriodIndex</span><span class=p>(</span><span class=n>year</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>year</span><span class=p>,</span> <span class=n>quarter</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>quarter</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                          <span class=n>name</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>142</span><span class=p>]:</span> <span class=n>columns</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Index</span><span class=p>([</span><span class=s1>&#39;realgdp&#39;</span><span class=p>,</span> <span class=s1>&#39;infl&#39;</span><span class=p>,</span> <span class=s1>&#39;unemp&#39;</span><span class=p>],</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;item&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>143</span><span class=p>]:</span> <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>reindex</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>columns</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>144</span><span class=p>]:</span> <span class=n>data</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=n>periods</span><span class=o>.</span><span class=n>to_timestamp</span><span class=p>(</span><span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;end&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>145</span><span class=p>]:</span> <span class=n>ldata</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>stack</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=mi>0</span><span class=p>:</span> <span class=s1>&#39;value&#39;</span><span class=p>})</span></span></span></code></pre></td></tr></table></div></div><p>这就是多个时间序列（或者其它带有两个或多个键的可观察数据，这里，我们的键是date和item）的长格式。表中的每行代表一次观察。</p><p>关系型数据库（如MySQL）中的数据经常都是这样存储的，因为固定架构（即列名和数据类型）有一个好处：随着表中数据的添加，item列中的值的种类能够增加。在前面的例子中，date和item通常就是主键（用关系型数据库的说法），不仅提供了关系完整性，而且提供了更为简单的查询支持。有的情况下，使用这样的数据会很麻烦，你可能会更喜欢DataFrame，不同的item值分别形成一列，date列中的时间戳则用作索引。DataFrame的pivot方法完全可以实现这个转换：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-59-1><a class=lnlinks href=#hl-59-1> 1</a>
</span><span class=lnt id=hl-59-2><a class=lnlinks href=#hl-59-2> 2</a>
</span><span class=lnt id=hl-59-3><a class=lnlinks href=#hl-59-3> 3</a>
</span><span class=lnt id=hl-59-4><a class=lnlinks href=#hl-59-4> 4</a>
</span><span class=lnt id=hl-59-5><a class=lnlinks href=#hl-59-5> 5</a>
</span><span class=lnt id=hl-59-6><a class=lnlinks href=#hl-59-6> 6</a>
</span><span class=lnt id=hl-59-7><a class=lnlinks href=#hl-59-7> 7</a>
</span><span class=lnt id=hl-59-8><a class=lnlinks href=#hl-59-8> 8</a>
</span><span class=lnt id=hl-59-9><a class=lnlinks href=#hl-59-9> 9</a>
</span><span class=lnt id=hl-59-10><a class=lnlinks href=#hl-59-10>10</a>
</span><span class=lnt id=hl-59-11><a class=lnlinks href=#hl-59-11>11</a>
</span><span class=lnt id=hl-59-12><a class=lnlinks href=#hl-59-12>12</a>
</span><span class=lnt id=hl-59-13><a class=lnlinks href=#hl-59-13>13</a>
</span><span class=lnt id=hl-59-14><a class=lnlinks href=#hl-59-14>14</a>
</span><span class=lnt id=hl-59-15><a class=lnlinks href=#hl-59-15>15</a>
</span><span class=lnt id=hl-59-16><a class=lnlinks href=#hl-59-16>16</a>
</span><span class=lnt id=hl-59-17><a class=lnlinks href=#hl-59-17>17</a>
</span><span class=lnt id=hl-59-18><a class=lnlinks href=#hl-59-18>18</a>
</span><span class=lnt id=hl-59-19><a class=lnlinks href=#hl-59-19>19</a>
</span><span class=lnt id=hl-59-20><a class=lnlinks href=#hl-59-20>20</a>
</span><span class=lnt id=hl-59-21><a class=lnlinks href=#hl-59-21>21</a>
</span><span class=lnt id=hl-59-22><a class=lnlinks href=#hl-59-22>22</a>
</span><span class=lnt id=hl-59-23><a class=lnlinks href=#hl-59-23>23</a>
</span><span class=lnt id=hl-59-24><a class=lnlinks href=#hl-59-24>24</a>
</span><span class=lnt id=hl-59-25><a class=lnlinks href=#hl-59-25>25</a>
</span><span class=lnt id=hl-59-26><a class=lnlinks href=#hl-59-26>26</a>
</span><span class=lnt id=hl-59-27><a class=lnlinks href=#hl-59-27>27</a>
</span><span class=lnt id=hl-59-28><a class=lnlinks href=#hl-59-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>147</span><span class=p>]:</span> <span class=n>pivoted</span> <span class=o>=</span> <span class=n>ldata</span><span class=o>.</span><span class=n>pivot</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=s1>&#39;item&#39;</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>148</span><span class=p>]:</span> <span class=n>pivoted</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>148</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>item</span>        <span class=n>infl</span>    <span class=n>realgdp</span>  <span class=n>unemp</span>
</span></span><span class=line><span class=cl><span class=n>date</span>                              
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.00</span>   <span class=mf>2710.349</span>    <span class=mf>5.8</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.34</span>   <span class=mf>2778.801</span>    <span class=mf>5.1</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.74</span>   <span class=mf>2775.488</span>    <span class=mf>5.3</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.27</span>   <span class=mf>2785.204</span>    <span class=mf>5.6</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>2.31</span>   <span class=mf>2847.699</span>    <span class=mf>5.2</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>0.14</span>   <span class=mf>2834.390</span>    <span class=mf>5.2</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.70</span>   <span class=mf>2839.022</span>    <span class=mf>5.6</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>1.21</span>   <span class=mf>2802.616</span>    <span class=mf>6.3</span>
</span></span><span class=line><span class=cl><span class=mi>1961</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span> <span class=o>-</span><span class=mf>0.40</span>   <span class=mf>2819.264</span>    <span class=mf>6.8</span>
</span></span><span class=line><span class=cl><span class=mi>1961</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>1.47</span>   <span class=mf>2872.005</span>    <span class=mf>7.0</span>
</span></span><span class=line><span class=cl><span class=o>...</span>          <span class=o>...</span>        <span class=o>...</span>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=mi>2007</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.75</span>  <span class=mf>13203.977</span>    <span class=mf>4.5</span>
</span></span><span class=line><span class=cl><span class=mi>2007</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>3.45</span>  <span class=mf>13321.109</span>    <span class=mf>4.7</span>
</span></span><span class=line><span class=cl><span class=mi>2007</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>6.38</span>  <span class=mf>13391.249</span>    <span class=mf>4.8</span>
</span></span><span class=line><span class=cl><span class=mi>2008</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>2.82</span>  <span class=mf>13366.865</span>    <span class=mf>4.9</span>
</span></span><span class=line><span class=cl><span class=mi>2008</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>8.53</span>  <span class=mf>13415.266</span>    <span class=mf>5.4</span>
</span></span><span class=line><span class=cl><span class=mi>2008</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span> <span class=o>-</span><span class=mf>3.16</span>  <span class=mf>13324.600</span>    <span class=mf>6.0</span>
</span></span><span class=line><span class=cl><span class=mi>2008</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>31</span> <span class=o>-</span><span class=mf>8.79</span>  <span class=mf>13141.920</span>    <span class=mf>6.9</span>
</span></span><span class=line><span class=cl><span class=mi>2009</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.94</span>  <span class=mf>12925.410</span>    <span class=mf>8.1</span>
</span></span><span class=line><span class=cl><span class=mi>2009</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>3.37</span>  <span class=mf>12901.504</span>    <span class=mf>9.2</span>
</span></span><span class=line><span class=cl><span class=mi>2009</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>3.56</span>  <span class=mf>12990.341</span>    <span class=mf>9.6</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=mi>203</span> <span class=n>rows</span> <span class=n>x</span> <span class=mi>3</span> <span class=n>columns</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>前两个传递的值分别用作行和列索引，最后一个可选值则是用于填充DataFrame的数据列。假设有两个需要同时重塑的数据列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-60-1><a class=lnlinks href=#hl-60-1> 1</a>
</span><span class=lnt id=hl-60-2><a class=lnlinks href=#hl-60-2> 2</a>
</span><span class=lnt id=hl-60-3><a class=lnlinks href=#hl-60-3> 3</a>
</span><span class=lnt id=hl-60-4><a class=lnlinks href=#hl-60-4> 4</a>
</span><span class=lnt id=hl-60-5><a class=lnlinks href=#hl-60-5> 5</a>
</span><span class=lnt id=hl-60-6><a class=lnlinks href=#hl-60-6> 6</a>
</span><span class=lnt id=hl-60-7><a class=lnlinks href=#hl-60-7> 7</a>
</span><span class=lnt id=hl-60-8><a class=lnlinks href=#hl-60-8> 8</a>
</span><span class=lnt id=hl-60-9><a class=lnlinks href=#hl-60-9> 9</a>
</span><span class=lnt id=hl-60-10><a class=lnlinks href=#hl-60-10>10</a>
</span><span class=lnt id=hl-60-11><a class=lnlinks href=#hl-60-11>11</a>
</span><span class=lnt id=hl-60-12><a class=lnlinks href=#hl-60-12>12</a>
</span><span class=lnt id=hl-60-13><a class=lnlinks href=#hl-60-13>13</a>
</span><span class=lnt id=hl-60-14><a class=lnlinks href=#hl-60-14>14</a>
</span><span class=lnt id=hl-60-15><a class=lnlinks href=#hl-60-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>149</span><span class=p>]:</span> <span class=n>ldata</span><span class=p>[</span><span class=s1>&#39;value2&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>ldata</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>150</span><span class=p>]:</span> <span class=n>ldata</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>150</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>        <span class=n>date</span>     <span class=n>item</span>     <span class=n>value</span>    <span class=n>value2</span>
</span></span><span class=line><span class=cl><span class=mi>0</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=n>realgdp</span>  <span class=mf>2710.349</span>  <span class=mf>0.523772</span>
</span></span><span class=line><span class=cl><span class=mi>1</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>     <span class=n>infl</span>     <span class=mf>0.000</span>  <span class=mf>0.000940</span>
</span></span><span class=line><span class=cl><span class=mi>2</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>    <span class=n>unemp</span>     <span class=mf>5.800</span>  <span class=mf>1.343810</span>
</span></span><span class=line><span class=cl><span class=mi>3</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=n>realgdp</span>  <span class=mf>2778.801</span> <span class=o>-</span><span class=mf>0.713544</span>
</span></span><span class=line><span class=cl><span class=mi>4</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>     <span class=n>infl</span>     <span class=mf>2.340</span> <span class=o>-</span><span class=mf>0.831154</span>
</span></span><span class=line><span class=cl><span class=mi>5</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>    <span class=n>unemp</span>     <span class=mf>5.100</span> <span class=o>-</span><span class=mf>2.370232</span>
</span></span><span class=line><span class=cl><span class=mi>6</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=n>realgdp</span>  <span class=mf>2775.488</span> <span class=o>-</span><span class=mf>1.860761</span>
</span></span><span class=line><span class=cl><span class=mi>7</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>     <span class=n>infl</span>     <span class=mf>2.740</span> <span class=o>-</span><span class=mf>0.860757</span>
</span></span><span class=line><span class=cl><span class=mi>8</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>    <span class=n>unemp</span>     <span class=mf>5.300</span>  <span class=mf>0.560145</span>
</span></span><span class=line><span class=cl><span class=mi>9</span> <span class=mi>1959</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>31</span>  <span class=n>realgdp</span>  <span class=mf>2785.204</span> <span class=o>-</span><span class=mf>1.265934</span></span></span></code></pre></td></tr></table></div></div><p>如果忽略最后一个参数，得到的DataFrame就会带有层次化的列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-61-1><a class=lnlinks href=#hl-61-1> 1</a>
</span><span class=lnt id=hl-61-2><a class=lnlinks href=#hl-61-2> 2</a>
</span><span class=lnt id=hl-61-3><a class=lnlinks href=#hl-61-3> 3</a>
</span><span class=lnt id=hl-61-4><a class=lnlinks href=#hl-61-4> 4</a>
</span><span class=lnt id=hl-61-5><a class=lnlinks href=#hl-61-5> 5</a>
</span><span class=lnt id=hl-61-6><a class=lnlinks href=#hl-61-6> 6</a>
</span><span class=lnt id=hl-61-7><a class=lnlinks href=#hl-61-7> 7</a>
</span><span class=lnt id=hl-61-8><a class=lnlinks href=#hl-61-8> 8</a>
</span><span class=lnt id=hl-61-9><a class=lnlinks href=#hl-61-9> 9</a>
</span><span class=lnt id=hl-61-10><a class=lnlinks href=#hl-61-10>10</a>
</span><span class=lnt id=hl-61-11><a class=lnlinks href=#hl-61-11>11</a>
</span><span class=lnt id=hl-61-12><a class=lnlinks href=#hl-61-12>12</a>
</span><span class=lnt id=hl-61-13><a class=lnlinks href=#hl-61-13>13</a>
</span><span class=lnt id=hl-61-14><a class=lnlinks href=#hl-61-14>14</a>
</span><span class=lnt id=hl-61-15><a class=lnlinks href=#hl-61-15>15</a>
</span><span class=lnt id=hl-61-16><a class=lnlinks href=#hl-61-16>16</a>
</span><span class=lnt id=hl-61-17><a class=lnlinks href=#hl-61-17>17</a>
</span><span class=lnt id=hl-61-18><a class=lnlinks href=#hl-61-18>18</a>
</span><span class=lnt id=hl-61-19><a class=lnlinks href=#hl-61-19>19</a>
</span><span class=lnt id=hl-61-20><a class=lnlinks href=#hl-61-20>20</a>
</span><span class=lnt id=hl-61-21><a class=lnlinks href=#hl-61-21>21</a>
</span><span class=lnt id=hl-61-22><a class=lnlinks href=#hl-61-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>151</span><span class=p>]:</span> <span class=n>pivoted</span> <span class=o>=</span> <span class=n>ldata</span><span class=o>.</span><span class=n>pivot</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=s1>&#39;item&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>152</span><span class=p>]:</span> <span class=n>pivoted</span><span class=p>[:</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>152</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>           <span class=n>value</span>                    <span class=n>value2</span>                    
</span></span><span class=line><span class=cl><span class=n>item</span>        <span class=n>infl</span>   <span class=n>realgdp</span> <span class=n>unemp</span>      <span class=n>infl</span>   <span class=n>realgdp</span>     <span class=n>unemp</span>
</span></span><span class=line><span class=cl><span class=n>date</span>                                                          
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.00</span>  <span class=mf>2710.349</span>   <span class=mf>5.8</span>  <span class=mf>0.000940</span>  <span class=mf>0.523772</span>  <span class=mf>1.343810</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.34</span>  <span class=mf>2778.801</span>   <span class=mf>5.1</span> <span class=o>-</span><span class=mf>0.831154</span> <span class=o>-</span><span class=mf>0.713544</span> <span class=o>-</span><span class=mf>2.370232</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.74</span>  <span class=mf>2775.488</span>   <span class=mf>5.3</span> <span class=o>-</span><span class=mf>0.860757</span> <span class=o>-</span><span class=mf>1.860761</span>  <span class=mf>0.560145</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.27</span>  <span class=mf>2785.204</span>   <span class=mf>5.6</span>  <span class=mf>0.119827</span> <span class=o>-</span><span class=mf>1.265934</span> <span class=o>-</span><span class=mf>1.063512</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>2.31</span>  <span class=mf>2847.699</span>   <span class=mf>5.2</span> <span class=o>-</span><span class=mf>2.359419</span>  <span class=mf>0.332883</span> <span class=o>-</span><span class=mf>0.199543</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>153</span><span class=p>]:</span> <span class=n>pivoted</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>][:</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>153</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>item</span>        <span class=n>infl</span>   <span class=n>realgdp</span>  <span class=n>unemp</span>
</span></span><span class=line><span class=cl><span class=n>date</span>                             
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.00</span>  <span class=mf>2710.349</span>    <span class=mf>5.8</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.34</span>  <span class=mf>2778.801</span>    <span class=mf>5.1</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.74</span>  <span class=mf>2775.488</span>    <span class=mf>5.3</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.27</span>  <span class=mf>2785.204</span>    <span class=mf>5.6</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>2.31</span>  <span class=mf>2847.699</span>    <span class=mf>5.2</span></span></span></code></pre></td></tr></table></div></div><p>注意，pivot其实就是用set_index创建层次化索引，再用unstack重塑：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-62-1><a class=lnlinks href=#hl-62-1> 1</a>
</span><span class=lnt id=hl-62-2><a class=lnlinks href=#hl-62-2> 2</a>
</span><span class=lnt id=hl-62-3><a class=lnlinks href=#hl-62-3> 3</a>
</span><span class=lnt id=hl-62-4><a class=lnlinks href=#hl-62-4> 4</a>
</span><span class=lnt id=hl-62-5><a class=lnlinks href=#hl-62-5> 5</a>
</span><span class=lnt id=hl-62-6><a class=lnlinks href=#hl-62-6> 6</a>
</span><span class=lnt id=hl-62-7><a class=lnlinks href=#hl-62-7> 7</a>
</span><span class=lnt id=hl-62-8><a class=lnlinks href=#hl-62-8> 8</a>
</span><span class=lnt id=hl-62-9><a class=lnlinks href=#hl-62-9> 9</a>
</span><span class=lnt id=hl-62-10><a class=lnlinks href=#hl-62-10>10</a>
</span><span class=lnt id=hl-62-11><a class=lnlinks href=#hl-62-11>11</a>
</span><span class=lnt id=hl-62-12><a class=lnlinks href=#hl-62-12>12</a>
</span><span class=lnt id=hl-62-13><a class=lnlinks href=#hl-62-13>13</a>
</span><span class=lnt id=hl-62-14><a class=lnlinks href=#hl-62-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>154</span><span class=p>]:</span> <span class=n>unstacked</span> <span class=o>=</span> <span class=n>ldata</span><span class=o>.</span><span class=n>set_index</span><span class=p>([</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=s1>&#39;item&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=s1>&#39;item&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>155</span><span class=p>]:</span> <span class=n>unstacked</span><span class=p>[:</span><span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>155</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>           <span class=n>value</span>                    <span class=n>value2</span>                    
</span></span><span class=line><span class=cl><span class=n>item</span>        <span class=n>infl</span>   <span class=n>realgdp</span> <span class=n>unemp</span>      <span class=n>infl</span>   <span class=n>realgdp</span>     <span class=n>unemp</span>
</span></span><span class=line><span class=cl><span class=n>date</span>                                                          
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.00</span>  <span class=mf>2710.349</span>   <span class=mf>5.8</span>  <span class=mf>0.000940</span>  <span class=mf>0.523772</span>  <span class=mf>1.343810</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.34</span>  <span class=mf>2778.801</span>   <span class=mf>5.1</span> <span class=o>-</span><span class=mf>0.831154</span> <span class=o>-</span><span class=mf>0.713544</span> <span class=o>-</span><span class=mf>2.370232</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.74</span>  <span class=mf>2775.488</span>   <span class=mf>5.3</span> <span class=o>-</span><span class=mf>0.860757</span> <span class=o>-</span><span class=mf>1.860761</span>  <span class=mf>0.560145</span>
</span></span><span class=line><span class=cl><span class=mi>1959</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>0.27</span>  <span class=mf>2785.204</span>   <span class=mf>5.6</span>  <span class=mf>0.119827</span> <span class=o>-</span><span class=mf>1.265934</span> <span class=o>-</span><span class=mf>1.063512</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>31</span>  <span class=mf>2.31</span>  <span class=mf>2847.699</span>   <span class=mf>5.2</span> <span class=o>-</span><span class=mf>2.359419</span>  <span class=mf>0.332883</span> <span class=o>-</span><span class=mf>0.199543</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>0.14</span>  <span class=mf>2834.390</span>   <span class=mf>5.2</span> <span class=o>-</span><span class=mf>0.970736</span> <span class=o>-</span><span class=mf>1.541996</span> <span class=o>-</span><span class=mf>1.307030</span>
</span></span><span class=line><span class=cl><span class=mi>1960</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>30</span>  <span class=mf>2.70</span>  <span class=mf>2839.022</span>   <span class=mf>5.6</span>  <span class=mf>0.377984</span>  <span class=mf>0.286350</span> <span class=o>-</span><span class=mf>0.753887</span></span></span></code></pre></td></tr></table></div></div><h3 id=833-将宽格式旋转为长格式>8.3.3 将“宽格式”旋转为“长格式”
<a class=header-anchor href=#833-%e5%b0%86%e5%ae%bd%e6%a0%bc%e5%bc%8f%e6%97%8b%e8%bd%ac%e4%b8%ba%e9%95%bf%e6%a0%bc%e5%bc%8f></a></h3><p>旋转DataFrame的逆运算是pandas.melt。它不是将一列转换到多个新的DataFrame，而是合并多个列成为一个，产生一个比输入长的DataFrame。看一个例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-63-1><a class=lnlinks href=#hl-63-1> 1</a>
</span><span class=lnt id=hl-63-2><a class=lnlinks href=#hl-63-2> 2</a>
</span><span class=lnt id=hl-63-3><a class=lnlinks href=#hl-63-3> 3</a>
</span><span class=lnt id=hl-63-4><a class=lnlinks href=#hl-63-4> 4</a>
</span><span class=lnt id=hl-63-5><a class=lnlinks href=#hl-63-5> 5</a>
</span><span class=lnt id=hl-63-6><a class=lnlinks href=#hl-63-6> 6</a>
</span><span class=lnt id=hl-63-7><a class=lnlinks href=#hl-63-7> 7</a>
</span><span class=lnt id=hl-63-8><a class=lnlinks href=#hl-63-8> 8</a>
</span><span class=lnt id=hl-63-9><a class=lnlinks href=#hl-63-9> 9</a>
</span><span class=lnt id=hl-63-10><a class=lnlinks href=#hl-63-10>10</a>
</span><span class=lnt id=hl-63-11><a class=lnlinks href=#hl-63-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>157</span><span class=p>]:</span> <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>                    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>]})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>158</span><span class=p>]:</span> <span class=n>df</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>158</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>A</span>  <span class=n>B</span>  <span class=n>C</span>  <span class=n>key</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=mi>1</span>  <span class=mi>4</span>  <span class=mi>7</span>  <span class=n>foo</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=mi>2</span>  <span class=mi>5</span>  <span class=mi>8</span>  <span class=n>bar</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=mi>3</span>  <span class=mi>6</span>  <span class=mi>9</span>  <span class=n>baz</span></span></span></code></pre></td></tr></table></div></div><p>key列可能是分组指标，其它的列是数据值。当使用pandas.melt，我们必须指明哪些列是分组指标。下面使用key作为唯一的分组指标：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-64-1><a class=lnlinks href=#hl-64-1> 1</a>
</span><span class=lnt id=hl-64-2><a class=lnlinks href=#hl-64-2> 2</a>
</span><span class=lnt id=hl-64-3><a class=lnlinks href=#hl-64-3> 3</a>
</span><span class=lnt id=hl-64-4><a class=lnlinks href=#hl-64-4> 4</a>
</span><span class=lnt id=hl-64-5><a class=lnlinks href=#hl-64-5> 5</a>
</span><span class=lnt id=hl-64-6><a class=lnlinks href=#hl-64-6> 6</a>
</span><span class=lnt id=hl-64-7><a class=lnlinks href=#hl-64-7> 7</a>
</span><span class=lnt id=hl-64-8><a class=lnlinks href=#hl-64-8> 8</a>
</span><span class=lnt id=hl-64-9><a class=lnlinks href=#hl-64-9> 9</a>
</span><span class=lnt id=hl-64-10><a class=lnlinks href=#hl-64-10>10</a>
</span><span class=lnt id=hl-64-11><a class=lnlinks href=#hl-64-11>11</a>
</span><span class=lnt id=hl-64-12><a class=lnlinks href=#hl-64-12>12</a>
</span><span class=lnt id=hl-64-13><a class=lnlinks href=#hl-64-13>13</a>
</span><span class=lnt id=hl-64-14><a class=lnlinks href=#hl-64-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>159</span><span class=p>]:</span> <span class=n>melted</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;key&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>160</span><span class=p>]:</span> <span class=n>melted</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>160</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>key</span> <span class=n>variable</span>  <span class=n>value</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=n>foo</span>        <span class=n>A</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=n>bar</span>        <span class=n>A</span>      <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=n>baz</span>        <span class=n>A</span>      <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=n>foo</span>        <span class=n>B</span>      <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=n>bar</span>        <span class=n>B</span>      <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>  <span class=n>baz</span>        <span class=n>B</span>      <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>  <span class=n>foo</span>        <span class=n>C</span>      <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=mi>7</span>  <span class=n>bar</span>        <span class=n>C</span>      <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=mi>8</span>  <span class=n>baz</span>        <span class=n>C</span>      <span class=mi>9</span></span></span></code></pre></td></tr></table></div></div><p>使用pivot，可以重塑回原来的样子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-65-1><a class=lnlinks href=#hl-65-1>1</a>
</span><span class=lnt id=hl-65-2><a class=lnlinks href=#hl-65-2>2</a>
</span><span class=lnt id=hl-65-3><a class=lnlinks href=#hl-65-3>3</a>
</span><span class=lnt id=hl-65-4><a class=lnlinks href=#hl-65-4>4</a>
</span><span class=lnt id=hl-65-5><a class=lnlinks href=#hl-65-5>5</a>
</span><span class=lnt id=hl-65-6><a class=lnlinks href=#hl-65-6>6</a>
</span><span class=lnt id=hl-65-7><a class=lnlinks href=#hl-65-7>7</a>
</span><span class=lnt id=hl-65-8><a class=lnlinks href=#hl-65-8>8</a>
</span><span class=lnt id=hl-65-9><a class=lnlinks href=#hl-65-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>161</span><span class=p>]:</span> <span class=n>reshaped</span> <span class=o>=</span> <span class=n>melted</span><span class=o>.</span><span class=n>pivot</span><span class=p>(</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=s1>&#39;variable&#39;</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>162</span><span class=p>]:</span> <span class=n>reshaped</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>162</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>variable</span>  <span class=n>A</span>  <span class=n>B</span>  <span class=n>C</span>
</span></span><span class=line><span class=cl><span class=n>key</span>              
</span></span><span class=line><span class=cl><span class=n>bar</span>       <span class=mi>2</span>  <span class=mi>5</span>  <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>baz</span>       <span class=mi>3</span>  <span class=mi>6</span>  <span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>foo</span>       <span class=mi>1</span>  <span class=mi>4</span>  <span class=mi>7</span></span></span></code></pre></td></tr></table></div></div><p>因为pivot的结果从列创建了一个索引，用作行标签，我们可以使用reset_index将数据移回列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-66-1><a class=lnlinks href=#hl-66-1>1</a>
</span><span class=lnt id=hl-66-2><a class=lnlinks href=#hl-66-2>2</a>
</span><span class=lnt id=hl-66-3><a class=lnlinks href=#hl-66-3>3</a>
</span><span class=lnt id=hl-66-4><a class=lnlinks href=#hl-66-4>4</a>
</span><span class=lnt id=hl-66-5><a class=lnlinks href=#hl-66-5>5</a>
</span><span class=lnt id=hl-66-6><a class=lnlinks href=#hl-66-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>163</span><span class=p>]:</span> <span class=n>reshaped</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>163</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=n>variable</span>  <span class=n>key</span>  <span class=n>A</span>  <span class=n>B</span>  <span class=n>C</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>         <span class=n>bar</span>  <span class=mi>2</span>  <span class=mi>5</span>  <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>         <span class=n>baz</span>  <span class=mi>3</span>  <span class=mi>6</span>  <span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>         <span class=n>foo</span>  <span class=mi>1</span>  <span class=mi>4</span>  <span class=mi>7</span></span></span></code></pre></td></tr></table></div></div><p>你还可以指定列的子集，作为值的列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-67-1><a class=lnlinks href=#hl-67-1>1</a>
</span><span class=lnt id=hl-67-2><a class=lnlinks href=#hl-67-2>2</a>
</span><span class=lnt id=hl-67-3><a class=lnlinks href=#hl-67-3>3</a>
</span><span class=lnt id=hl-67-4><a class=lnlinks href=#hl-67-4>4</a>
</span><span class=lnt id=hl-67-5><a class=lnlinks href=#hl-67-5>5</a>
</span><span class=lnt id=hl-67-6><a class=lnlinks href=#hl-67-6>6</a>
</span><span class=lnt id=hl-67-7><a class=lnlinks href=#hl-67-7>7</a>
</span><span class=lnt id=hl-67-8><a class=lnlinks href=#hl-67-8>8</a>
</span><span class=lnt id=hl-67-9><a class=lnlinks href=#hl-67-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>164</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;key&#39;</span><span class=p>],</span> <span class=n>value_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>164</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>   <span class=n>key</span> <span class=n>variable</span>  <span class=n>value</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>  <span class=n>foo</span>        <span class=n>A</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>  <span class=n>bar</span>        <span class=n>A</span>      <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>  <span class=n>baz</span>        <span class=n>A</span>      <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>  <span class=n>foo</span>        <span class=n>B</span>      <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>  <span class=n>bar</span>        <span class=n>B</span>      <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>  <span class=n>baz</span>        <span class=n>B</span>      <span class=mi>6</span></span></span></code></pre></td></tr></table></div></div><p>pandas.melt也可以不用分组指标：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-68-1><a class=lnlinks href=#hl-68-1> 1</a>
</span><span class=lnt id=hl-68-2><a class=lnlinks href=#hl-68-2> 2</a>
</span><span class=lnt id=hl-68-3><a class=lnlinks href=#hl-68-3> 3</a>
</span><span class=lnt id=hl-68-4><a class=lnlinks href=#hl-68-4> 4</a>
</span><span class=lnt id=hl-68-5><a class=lnlinks href=#hl-68-5> 5</a>
</span><span class=lnt id=hl-68-6><a class=lnlinks href=#hl-68-6> 6</a>
</span><span class=lnt id=hl-68-7><a class=lnlinks href=#hl-68-7> 7</a>
</span><span class=lnt id=hl-68-8><a class=lnlinks href=#hl-68-8> 8</a>
</span><span class=lnt id=hl-68-9><a class=lnlinks href=#hl-68-9> 9</a>
</span><span class=lnt id=hl-68-10><a class=lnlinks href=#hl-68-10>10</a>
</span><span class=lnt id=hl-68-11><a class=lnlinks href=#hl-68-11>11</a>
</span><span class=lnt id=hl-68-12><a class=lnlinks href=#hl-68-12>12</a>
</span><span class=lnt id=hl-68-13><a class=lnlinks href=#hl-68-13>13</a>
</span><span class=lnt id=hl-68-14><a class=lnlinks href=#hl-68-14>14</a>
</span><span class=lnt id=hl-68-15><a class=lnlinks href=#hl-68-15>15</a>
</span><span class=lnt id=hl-68-16><a class=lnlinks href=#hl-68-16>16</a>
</span><span class=lnt id=hl-68-17><a class=lnlinks href=#hl-68-17>17</a>
</span><span class=lnt id=hl-68-18><a class=lnlinks href=#hl-68-18>18</a>
</span><span class=lnt id=hl-68-19><a class=lnlinks href=#hl-68-19>19</a>
</span><span class=lnt id=hl-68-20><a class=lnlinks href=#hl-68-20>20</a>
</span><span class=lnt id=hl-68-21><a class=lnlinks href=#hl-68-21>21</a>
</span><span class=lnt id=hl-68-22><a class=lnlinks href=#hl-68-22>22</a>
</span><span class=lnt id=hl-68-23><a class=lnlinks href=#hl-68-23>23</a>
</span><span class=lnt id=hl-68-24><a class=lnlinks href=#hl-68-24>24</a>
</span><span class=lnt id=hl-68-25><a class=lnlinks href=#hl-68-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>165</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>value_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>165</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>variable</span>  <span class=n>value</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>        <span class=n>A</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>        <span class=n>A</span>      <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>        <span class=n>A</span>      <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>        <span class=n>B</span>      <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>        <span class=n>B</span>      <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>        <span class=n>B</span>      <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>        <span class=n>C</span>      <span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=mi>7</span>        <span class=n>C</span>      <span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=mi>8</span>        <span class=n>C</span>      <span class=mi>9</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>166</span><span class=p>]:</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>value_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>166</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl>  <span class=n>variable</span> <span class=n>value</span>
</span></span><span class=line><span class=cl><span class=mi>0</span>      <span class=n>key</span>   <span class=n>foo</span>
</span></span><span class=line><span class=cl><span class=mi>1</span>      <span class=n>key</span>   <span class=n>bar</span>
</span></span><span class=line><span class=cl><span class=mi>2</span>      <span class=n>key</span>   <span class=n>baz</span>
</span></span><span class=line><span class=cl><span class=mi>3</span>        <span class=n>A</span>     <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=mi>4</span>        <span class=n>A</span>     <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=mi>5</span>        <span class=n>A</span>     <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=mi>6</span>        <span class=n>B</span>     <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=mi>7</span>        <span class=n>B</span>     <span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=mi>8</span>        <span class=n>B</span>     <span class=mi>6</span></span></span></code></pre></td></tr></table></div></div><h2 id=84-总结>8.4 总结
<a class=header-anchor href=#84-%e6%80%bb%e7%bb%93></a></h2><p>现在你已经掌握了pandas数据导入、清洗、重塑，我们可以进一步学习<code>matplotlib</code>数据可视化。我们在稍后会回到pandas，学习更高级的分析。</p></div><footer class=post-footer><div class=post-tags><a href=/tags/python/>python</a></div><div class=post-share-tools><div class=post-share-loading><i class="fa-solid fa-ellipsis fa-spin"></i></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class=a2a_dd href=https://www.addtoany.com/share></a><a class=a2a_button_wechat></a><a class=a2a_button_qzone></a><a class=a2a_button_sina_weibo></a><a class=a2a_button_douban></a><a class=a2a_button_facebook></a><a class=a2a_button_x></a><a class=a2a_button_email></a><a class=a2a_button_printfriendly></a></div></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="Rich - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="Rich - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
第八章 数据规整：聚合、合并和重塑</li><li class=post-copyright-author><strong>本文作者： </strong>Rich</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=//localhost:1313/chinese/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91/ title="第八章 数据规整：聚合、合并和重塑">//localhost:1313/chinese/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/white.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/rss.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/chinese/%E7%A8%8B%E6%8A%80/python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D/ rel=next title="Python pandas数据分析基础100问(有重复)"><i class="fa fa-chevron-left"></i> Python pandas数据分析基础100问(有重复)</a></div><div class="post-nav-prev post-nav-item"><a href=/chinese/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch02-python%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80%E5%92%8Cipython%E4%BB%A5%E5%8F%8Ajupyternotebooks/ rel=prev title="第二章 Python 语法基础，IPython 和 Jupyter Notebooks">第二章 Python 语法基础，IPython 和 Jupyter Notebooks
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div id=i18n-translate class=i18n-translate><i class="fa fa-language"></i><div id=lang-select class=lang-select><div id=lang-selected class=selected-option><span class="flag-icon flag-icon-zh-cn"></span>
<span class=selected-language>简体中文</span>
<i class="fa fa-chevron-down"></i></div><div id=lang-options class=lang-options><div class=lang-option lang-code=zh-cn lang-name=简体中文 lang-url=/chinese/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91/><span class="flag-icon flag-icon-zh-cn"></span>
<span class=lang-name>简体中文</span></div></div></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rich</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.147.7 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>萌ICP备20250629号</a>
<img src=/imgs/gongan.png alt=萌公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>萌公网安备 31011402009770 号</a></div><div class=custom-footer>Website source code <a href=https://github.com/hugo-next/hugo-theme-next/blob/develop/exampleSite/layouts/partials/custom_footer.html target=_blank>here</a></div></div></footer><script class=next-config data-name=page type=application/json>{"clipboard":{"js":{"alias":"clipboard","file":"dist/clipboard.min.js","name":"clipboard.js","version":"2.0.11"}},"comments":false,"expired":false,"isHome":false,"isPage":true,"path":"ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91","permalink":"//localhost:1313/chinese/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91/","title":"第八章 数据规整：聚合、合并和重塑","toc":true,"waline":{"commentcnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/comment.js","name":"comment","version":"2.15.8"}}}</script><script type=text/javascript src=//localhost:1313/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=//localhost:1313/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"hostname":"//localhost:1313/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":true,"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"slideInRight","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":true},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"//localhost:1313/js/3rd"}},"version":"4.8.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.js?=1750130235" defer></script><script type=text/javascript src="/js/clipboard.js?=1750130236" defer></script></body></html>