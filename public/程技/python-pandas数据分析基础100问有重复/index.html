<!doctype html><html lang=zh-CN data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.147.7"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="Python pandas数据分析基础100问(有重复)"><meta itemprop=description content="保持简单的易用性和强大的功能。"><meta name=description content="保持简单的易用性和强大的功能。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=keywords content="pandas"><meta property="og:type" content="article"><meta property="og:title" content="Python pandas数据分析基础100问(有重复)"><meta property="og:description" content="保持简单的易用性和强大的功能。"><meta property="og:image" content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="//localhost:1313/%E7%A8%8B%E6%8A%80/python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D/"><meta property="og:site_name" content="樊尘刹记"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rich"><meta property="article:published_time" content="2023-09-25 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2023-09-25 00:00:00 +0000 UTC"><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.css?=1750130313"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><link rel=stylesheet type=text/css href="/css/custom_style.css?=1750130313"><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Python pandas数据分析基础100问(有重复) - 樊尘刹记</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>樊尘刹记</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>红尘湮灭，唯有尘刹</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-example"><a href=/ class="menus-parent hvr-icon-pulse" rel=section><i class="fa fa-angles-down hvr-icon"></i>语法示例
<span class=menu-item-shrink-icon><i class="fa fa-angle-right"></i></span></a><ul class=menu-children><li class=menu-child-item><a href=/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>语法高亮</a></li><li class=menu-child-item><a href=/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>数学公式</a></li><li class=menu-child-item><a href=/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>流程图</a></li></ul></li><li class="menu-item menu-item-archives"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>0</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rich src=/imgs/img-lazy-loading.gif data-src=https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif><p class=site-author-name itemprop=name>Rich</p><div class=site-description itemprop=description>保持简单的易用性和强大的功能。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>0</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>8</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>99</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/richbridge title="Github → https://github.com/richbridge" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/richfan-38 title="知乎 → https://www.zhihu.com/people/richfan-38" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div><div class="mydefined animated" itemprop=custom><span>支持自定义CSS和Sidebar布局啦💄💄💄</span></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-i18n-translate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/richbridge rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/%E7%A8%8B%E6%8A%80/python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="保持简单的易用性和强大的功能。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Python pandas数据分析基础100问(有重复)"><meta itemprop=description content="题目来自B站上看的一个讲爬虫的老师发的视频，不过代码没完全照那人的来，由于在平板上写的代码，就没有执行结果，感兴趣自行到B站搜原视频。



1


import pandas as pd



1、将list转为dataframe"></span><header class=post-header><h1 class=post-title itemprop="name headline">Python pandas数据分析基础100问(有重复)</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2023-09-25 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-09-25 00:00:00 +0000 UTC">2023-09-25
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E7%A8%8B%E6%8A%80/ itemprop=url rel=index><span itemprop=name>程技</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>8780</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>18分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/%E7%A8%8B%E6%8A%80/python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>题目来自B站上看的一个讲爬虫的老师发的视频，不过代码没完全照那人的来，由于在平板上写的代码，就没有执行结果，感兴趣自行到B站搜原视频。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import pandas as pd</span></span></code></pre></td></tr></table></div></div><p>1、将list转为dataframe</p><a id=more></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ls = [(&#34;join&#34;, 25, &#34;male&#34;), (&#34;lisa&#34;, 29, &#34;female&#34;), (&#34;david&#34;, 27, &#34;male&#34;)``df = pd.DataFrame(ls, columns=[&#34;name&#34;, &#34;age&#34;, &#34;gender&#34;])``display(df)</span></span></code></pre></td></tr></table></div></div><p>2、从csv文件中读取数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df = pd.read_csv(&#34;filenpath&#34;, encoding=&#34;utf8&#34;)``# filepath_or_buffer: filepath 文件路径``# usecols: 需要读取的行列表``# nrows: 读取的行数``# na_values: 空值``# encoding: 编码格式</span></span></code></pre></td></tr></table></div></div><p>3、将dataframe导入到mysql</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from sqlalchemy import create_engine``from sqlclchemy.type import *``df = pd.DataFrame() # 数据集``# 创建引擎``conn = create_engine(&#34;mysql+mysqlconnector://username:password@127.0.0.1:3306/db_name&#34;)``# 写入到数据库``df.to_sql(&#34;table_name&#34;, engine)</span></span></code></pre></td></tr></table></div></div><p>4、查看一个dataframe的行数、列数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 行``df.shape[0]``# 列``df.shape[1]</span></span></code></pre></td></tr></table></div></div><p>5、查看dataframe的列名</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.columns # serise格式``df.columns.tolist() # list格式</span></span></code></pre></td></tr></table></div></div><p>6、查看dataframe索引</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.index # series格式``df.index.tolist()</span></span></code></pre></td></tr></table></div></div><p>7、查看pandas库的版本号</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pd.__version__</span></span></code></pre></td></tr></table></div></div><p>8、从csv文件里读取数据，并创建一个dataframe</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df = pd.read_csv(&#34;filepath&#34;, encoding=&#39;utf8&#39;)</span></span></code></pre></td></tr></table></div></div><p>9、查看dataframe的列的数据类型</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.dtypes</span></span></code></pre></td></tr></table></div></div><p>10、查看dataframe摘要统计描述信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.describe() # count/mean/std/min/max 1-4分位数，1-10分位数``# include: 统计哪些列，默认为None，全部``# exclude: 排除列``# percentiles: 分位点,默认为None,4分位</span></span></code></pre></td></tr></table></div></div><p>11、dataframe提取行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.loc[index_name] # 单行``df.loc[index_name1, index_name2] # 多行``df.iloc[start_index: end_index] # 连续多行，不包含end</span></span></code></pre></td></tr></table></div></div><p>12、dataframe提取列</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;col_name&#34;] # 单列``df[[&#34;col_1&#34;, &#34;col_2&#34;, ....]] # 多列``df.iloc[:, col_index] # 单列``df.iloc[:, col_start_index: col_end_index] # 按列索引取 连续多列</span></span></code></pre></td></tr></table></div></div><p>13、选择datafram的行和列</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.loc[[indexName1, indexName2..], [colName1, colName2...]]  # 按行列名提取``   ``df.iloc[[startIndex: endIndex], [colStartIndex: colEndIndex]] # 按行列索引提取，不包括end</span></span></code></pre></td></tr></table></div></div><p>14、筛选dataframe的行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 使用列条件筛选行``df[df[列名条件]] # 单条件``df[(条件1) &amp; (条件2)] # 多条件，每一个单条件用()包起来，连接符号：&amp;-与，|-或，～非``# 示例：筛选出年龄小于等于30，且收入大于等于30万的男性``df[(df[&#34;age&#34;]&lt;=30) &amp; (df[&#34;income&#34;]&gt;=300000) &amp; df[&#34;gender&#34;]==&#34;male&#34;]</span></span></code></pre></td></tr></table></div></div><p>15、筛选dataframe的行和列</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[(条件1) &amp; (条件2)][[colName1, colName2....]] # 筛选行之后再选择需要的列``df.loc[行筛选条件, [colName1, colName2]] # 使用列进行行条件筛选，同时限定输出列</span></span></code></pre></td></tr></table></div></div><p>16、根据某一列的值对一个dataframe进行排序</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.sort_values(by=[&#34;col1&#34;, &#34;col2&#34;], ascending=True) # 默认升序</span></span></code></pre></td></tr></table></div></div><p>17、对dataframe进行数据透视操作，即实现excel中的数据透视表功能</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=s1>&#39;行索引&#39;</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;列索引&#39;</span><span class=p>,</span> <span class=n>values</span><span class=o>=</span><span class=s2>&#34;统计列&#34;</span><span class=p>,</span> <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;函数名&#39;</span><span class=p>)</span><span class=err>``</span><span class=c1># aggfunc 支持 sum/mean/count/min/max等</span></span></span></code></pre></td></tr></table></div></div><p>18、对dataframe进行聚合操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.groupby(by=[&#34;索引列1&#34;, &#34;索引列2&#34;])[&#39;统计列&#39;].agg([&#34;函数1&#34;, &#34;函数2&#34;, &#34;函数3&#34;])</span></span></code></pre></td></tr></table></div></div><p>19、对多个dataframe实现合并操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 纵向合并` `pd.merge(df_left, df_right, on=[&#34;合并列1&#34;, &#34;合并列2&#34;], how=&#34;inner or left or right or outer&#34;)``# 横向合并``pd.concat([df_1, df_2, df_3]) # 常用于拥有相同格式的多个数据集</span></span></code></pre></td></tr></table></div></div><p>20、删除dataframe中的一列或多列数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.drop(columns=[&#34;需要删除的列&#34;], inplace=True) # 默认是生成一个新的数据集，inplace=False``   ``df.dorp(subset=[&#34;需要删除的列&#34;], axis=1, inplace=True)</span></span></code></pre></td></tr></table></div></div><p>21、向dataframe中添加一行数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.iloc[df.shape[0]] = index_array</span></span></code></pre></td></tr></table></div></div><p>22、删除dataframe中的一行或多行数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.drop(subset=[1, 3], axis=0, inplace=True)</span></span></code></pre></td></tr></table></div></div><p>23、使用索引选择dataframe中某个范围内的行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[1: 4] # 提取第一行到第四行</span></span></code></pre></td></tr></table></div></div><p>24、使用某一列选择dataframe中某个范围内的行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.set_index(&#34;name&#34;).loc[&#34;start_indexName&#34;: &#34;end_indexName&#34;] # 连续索引名``# 不连续行，在列表中用逗号分隔即可</span></span></code></pre></td></tr></table></div></div><p>25、在dataframe中按特定条件取行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[df[&#34;name&#34;] == &#34;小杨&#34;] # 单条件、单取值``df[df[&#34;name&#34;] in [&#34;小杨&#34;, &#34;小李&#34;]] # 单条件、多取值``df[(df[&#34;name&#34;] in [&#34;小杨&#34;, &#34;小李&#34;]) &amp; (df[&#34;age&#34;] &gt;= 30)] # 多条件</span></span></code></pre></td></tr></table></div></div><p>26、修改dataframe的列名</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 修改``df.rename(columns={&#34;原列名&#34;: &#34;修改后的列名&#34;}, inplace=True)``# 重新设置``df.columns = [新的列名数组]</span></span></code></pre></td></tr></table></div></div><p>27、计算dataframe中某一列的总和</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;colName&#34;].sum()</span></span></code></pre></td></tr></table></div></div><p>28、计算dataframe中某一列的平均值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;col_name&#34;].mean() # 返回浮点类型</span></span></code></pre></td></tr></table></div></div><p>29、计算dataframe中某一列的中位数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;col_name&#34;].median() # 返回浮点类型</span></span></code></pre></td></tr></table></div></div><p>30、计算dataframe中某一列的标准差</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;col_name&#34;].std()</span></span></code></pre></td></tr></table></div></div><p>31、计算dataframe中某一列的方差</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>df</span><span class=p>[</span><span class=s2>&#34;col_name&#34;</span><span class=p>]</span><span class=o>.</span><span class=k>var</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>32、计算dataframe中某一列的最大值和最小值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;col_name&#34;].max()``df[&#34;col_name&#34;].min()</span></span></code></pre></td></tr></table></div></div><p>33、查找dataframe某个单元格</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.loc[row, col]</span></span></code></pre></td></tr></table></div></div><p>34、dataframe重命名列名</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.rename(columns={&#34;key&#34;: &#34;value&#34;}, inplace=True)</span></span></code></pre></td></tr></table></div></div><p>35、替换dataframe中的特定值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 单列-1``df[&#34;col_name&#34;].replace(to_replace=&#34;replace_str&#34;, value=&#34;str_new&#34;, regex=True)``# 单列-2``df[&#34;col_name&#34;].map(lambda x: str(x).replace(&#34;replace_str&#34;, &#34;str_new&#34;))</span></span></code></pre></td></tr></table></div></div><p>36、如何将dataframe中的特定制替换成缺失值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df = df.replace(replace_value, np.nan) # 空值：np.nan pd.NaT</span></span></code></pre></td></tr></table></div></div><p>37、将dataframe中的空值进行填充</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.fillna(value, inplace=True)``# value = -999, 直接填充值``# value = &#34;ffill&#34;, 使用上一个非空值进行填充``# value = &#34;bfill&#34;, 使用后一个非空值进行填充``# value = {&#34;col1&#34;: value1, &#34;col2&#34;: value2}, 传入字典，不同列填充不同的值</span></span></code></pre></td></tr></table></div></div><p>38、删除dataframe中的缺失值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.dropna(subset=[&#34;col1&#34;, &#34;col2&#34;], how=&#39;any&#39;, axis=0, inplace=True)``# subset: 用来判断是否删除的列``# axis: 0-删除行, 1-删除列``# how: any-一旦存在空值就删除, all-全为空时删除``# thresh: 0-1的浮点数，空值占比大于一定比例时删除</span></span></code></pre></td></tr></table></div></div><p>39、在dataframe中使用聚合函数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.groupby(by=[&#34;col1&#34;, &#34;col2&#34;]).mean()``# 也可以使用count/sum等函数</span></span></code></pre></td></tr></table></div></div><p>40、在pandas中创建一个空的数据帧</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df = pd.DataFrame()</span></span></code></pre></td></tr></table></div></div><p>41、在pandas中进行分组、聚合</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.groupby(by=[&#34;col1_groupby&#34;, &#34;col2_groupby&#34;])[&#34;col1_calculate&#34;, &#34;col2_calculate&#34;].agg(&#34;func1&#34;, &#34;func2&#34;[, ....])</span></span></code></pre></td></tr></table></div></div><p>42、对dataframe中的数据进行类型转换</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;col_name&#34;] = df[&#34;col_name&#34;].astype(np.int)</span></span></code></pre></td></tr></table></div></div><p>43、如何使用pandas中的迭代循环方法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>for index,row in df.iterrows():`    `print(index, row)</span></span></code></pre></td></tr></table></div></div><p>44、如何使用pandas中的交叉表(列联表)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pd.crosstab(df[&#34;col_index&#34;], df[&#34;col_feature&#34;]) # 默认是统计次数</span></span></code></pre></td></tr></table></div></div><p>45、如何在pandas中使用重塑(reshape)数据？</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.pivot(index=&#34;col_index&#34;, columns=&#34;col_feature&#34;, values=&#34;col_calculate&#34;)</span></span></code></pre></td></tr></table></div></div><p>46、如何在pandas中使用变因子(factorize)函数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-46-1><a class=lnlinks href=#hl-46-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;new&#34;] = pd.factorize(df[&#34;class&#34;]) # 相当于是把字符串类别变量进行数值化</span></span></code></pre></td></tr></table></div></div><p>47、在dataframe中创建随机日期列</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>start_date = &#39;2023-01-01&#39;``end_date = &#39;2023-07-27&#39;``data_range = pd.date_range(start=start_date, end=end_date)``   ``# size=df.shape[0] 即可创建一个跟dataframe等长的列``df[&#34;random_date&#34;] = pd.Series(np.random.choice(date_range, size=df.shape[0]))</span></span></code></pre></td></tr></table></div></div><p>48、如何在pandas中使用字符串函数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># to_uppercase 字符串中的字母转为大写``# to_lowercase 字符串中的字母转为小写``# strip 去除字符串两侧的空格``# replace 将字符串中的一个子字符串替换成另外一个子字符串``# contains 判断字符串是否包含给定的子字符串``# startwith 判断字符串是否以给定字符串开头``# endwith 判断字符串是否以给定字符串结尾``# split 切分字符串``   ``df[&#39;col_name&#39;] = df[&#39;col_name&#39;].str.strip() # 对某一列去除空格``df[&#39;col_name&#39;] = df[&#39;col_name&#39;].str.strip().str.to_lowercase() # 对某一列去除空格，然后字母转小写</span></span></code></pre></td></tr></table></div></div><p>49、如何在dataframe中使用字符串拆分函数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[[&#39;col_1&#39;, &#39;col2&#39;]] = df[&#39;col_to_split&#39;].str.split(&#34;用来切分的字符串&#34;, expand=True)</span></span></code></pre></td></tr></table></div></div><p>50、如何对dataframe进行标准化处理</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-50-1><a class=lnlinks href=#hl-50-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import pandas as pd``from sklearn.preprocessing import StandardScaler``   ``df_new = StandardScaler().fit_transform(df)</span></span></code></pre></td></tr></table></div></div><p>51、如何对dataframe进行归一化处理</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-51-1><a class=lnlinks href=#hl-51-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import sklearn.preprocessing import MinMaxScaler``df_new = MinMaxScaler().fit_transform(df)</span></span></code></pre></td></tr></table></div></div><p>52、在pandas中使用数据透视表进行数据汇总</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-52-1><a class=lnlinks href=#hl-52-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pd.pivot_table(df, values=&#34;计算列&#34;, index=&#39;索引列&#39;, columns=&#34;特征列&#34;, agg=&#34;func_name&#34;)``# 跟pivot也没有太大差别</span></span></code></pre></td></tr></table></div></div><p>53、在dataframe中使用groupby进行数据汇总</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-53-1><a class=lnlinks href=#hl-53-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.groupby(by=[&#34;col_name1&#34;, &#34;col_name2&#34;]).sum() # .mean .max .std</span></span></code></pre></td></tr></table></div></div><p>54、如何在Series中使用rolling函数进行移动窗口统计？</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-54-1><a class=lnlinks href=#hl-54-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import pandas as pd``import numpy as np``se = pd.Series(np.random.randn(10))``&gt;&gt;&gt; se``0   -0.974864``1    1.916511``2    0.760756``3    0.110363``4   -0.137077``5    0.186016``6   -0.759734``7   -1.529321``8   -1.571819``9    0.123134``   ``se_rolling = se.rolling(window=3).mean()``&gt;&gt;&gt; se_rolling` `0         NaN``1         NaN``2    0.567468``3    0.929210``4    0.244681``5    0.053101``6   -0.236932``7   -0.701013``8   -1.286958``9   -0.992669``   ``计算逻辑：由于index为0、1时，由于不足移动数量，结果为NaN``index2 =（index0+index1+index2 ）/ 3``index3 =（ index1+index2+index3）/ 3``   ``# 语法``DataFrame.rolling(`    `window, # 表示时间窗的大小，数值表示计算统计量的观测值的数量即向前几个数据`    `min_periods=None, # 每个窗口最少包含的观测值数量，小于这个值的窗口结果为NA，值可以是int，默认None。`    `center=False, # 把窗口的标签设置为居中。布尔型，默认False，居右`    `win_type=None, # 窗口的类型。截取窗的各种函数。字符串类型，默认为None。`    `on=None, # 可选参数。对于dataframe而言，指定要计算滚动窗口的列。值为列名。`    `axis=0, # 默认为0，即对列进行计算`    `closed=None # 定义区间的开闭，默认是左开右闭的即默认为right,默认是左开右闭的即默认为right`    `)</span></span></code></pre></td></tr></table></div></div><p>55、在pandas中使用shift函数进行时间序列处理</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-55-1><a class=lnlinks href=#hl-55-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import pandas as pd``import numpy as np``import datetime``   ``# 创建一个时间数组``date_range = pd.date_range(start=&#39;2023-01-01&#39;, end=&#39;2023-07-28&#39;, periods=10)``# 创建一个Serise``se = pd.Series(np.random.randn(10), index=date_range)``&gt;&gt;&gt; se``2023-01-01 00:00:00    0.294050``2023-01-24 02:40:00   -0.324300``2023-02-16 05:20:00    0.345552``2023-03-11 08:00:00   -1.519163``2023-04-03 10:40:00    0.446149``2023-04-26 13:20:00    1.109210``2023-05-19 16:00:00    1.061693``2023-06-11 18:40:00   -1.417034``2023-07-04 21:20:00   -0.218537``2023-07-28 00:00:00   -0.365196``   ``# shift数据前滞 或 后滞``result = se.shift(periods=3, freq=datetime.timedelta(-3))``&gt;&gt;&gt; result``2022-12-23 00:00:00    0.294050``2023-01-15 02:40:00   -0.324300``2023-02-07 05:20:00    0.345552``2023-03-02 08:00:00   -1.519163``2023-03-25 10:40:00    0.446149``2023-04-17 13:20:00    1.109210``2023-05-10 16:00:00    1.061693``2023-06-02 18:40:00   -1.417034``2023-06-25 21:20:00   -0.218537``2023-07-19 00:00:00   -0.365196``   ``# DataFrame.shift(periods=1, freq=None, axis=0)``# periods可以理解为移动幅度的次数，负数表示前滞，正数表示后滞。``# freq为None时，移动的是其他数据的值，即移动periods*1个单位长度。可以设为一个timedelta对象。适用于索引为时间序列数据时。``# axis默认为0，表示对列操作。如果为行则表示对行操作。</span></span></code></pre></td></tr></table></div></div><p>56、如何在pandas中使用set_index函数设置索引</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-56-1><a class=lnlinks href=#hl-56-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.set_index(keys=[&#39;a&#39;, &#39;b&#39;]) # 将a\b两列设置为索引``   ``# set_index(keys, drop=True, inplace=False)``# drop: 是否删除原本的列，默认True-删除``# inplace: 是否原地修改，默认False-否</span></span></code></pre></td></tr></table></div></div><p>57、如何在pandas中使用reset_index函数重置索引</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-57-1><a class=lnlinks href=#hl-57-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.reset_index() # 什么都不传入，默认把所有层级的索引重置为新的字段``   ``# reset_index(level=None, drop=False, inplace=False)``# level: 需要重置的索引层级``# drop: 是否删除，默认False``# inplace: 是否原地操作，默认False</span></span></code></pre></td></tr></table></div></div><p>58、如何在pandas中使用map进行数据操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># map函数用于列操作``# 数据映射``mapping_dict = {&#34;male&#34;:0, &#34;female&#34;:1}``df[&#34;gender&#34;] = df[&#34;gender&#34;].map(mapping_dict)``   ``# 更常见的操作是向map传入一个函数``def mapping(x):`    `mapping_dict = {&#34;male&#34;:0, &#34;female&#34;:1}`    `return mapping_dict[x]``df[&#34;gender&#34;] = df[&#34;gender&#34;].map(mapping)``   ``# 传入匿名函数``df[&#34;gender&#34;] = df[&#34;gender&#34;].map(lambda x: lambda 1 if x==&#34;female&#34; else 0)</span></span></code></pre></td></tr></table></div></div><p>59、如何在pandas中使用apply函数进行元素级函数应用</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-59-1><a class=lnlinks href=#hl-59-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># apply函数用于单元格级的操作``def multiply_by_2(x)`    `return x*2``df_new = df.apply(multiply_by_2) # df中的每一个元素都乘以2``   ``# 个人比较常用的操作：``df_new = df.groupby(groupby).apply(lambda df: pd.Series({`    `&#39;cnt&#39;: df.shape[0],`    `&#39;bad_cnt&#39;: df[label].sum(),`    `# 当标签类型只有0、1的时候，可以使用均值计算坏账率`    `&#39;bad_rate&#39;: df[label].mean(),`    `&#39;begin_date&#39;: df[apply_time_label].min(),`    `&#39;end_date&#39;: df[apply_time_label].max()})).reset_index()`    `# 造特征``df[&#34;col_new&#34;] = df.apply(lambda x: x[&#34;col1&#34;] if x[&#34;col&#34;]&gt;=100 else x[&#34;col2&#34;], axis=1)</span></span></code></pre></td></tr></table></div></div><p>60、如何在pandas中使用agg函数进行分组聚合操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-60-1><a class=lnlinks href=#hl-60-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.groupby([&#39;col_1&#39;, &#34;col_2&#34;]).agg({&#34;col3&#34;:&#34;sum&#34;, &#34;col4&#34;:&#34;mean&#34;})</span></span></code></pre></td></tr></table></div></div><p>61、如何在pandas中使用transform函数进行分组变换操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-61-1><a class=lnlinks href=#hl-61-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 通过分组后的计算，取到对分组结果进行赋值的效果``df[&#34;col_new&#34;] = df.groupby(&#39;col1&#39;)[&#39;col_calculate&#39;].transform(lambda x: x.mean())</span></span></code></pre></td></tr></table></div></div><p>62、如何在pandas中使用stack和unstack函数进行数据透视操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-62-1><a class=lnlinks href=#hl-62-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1># stack: 列转行``import pandas as pd``import numpy as np``df = pd.DataFrame({&#34;name&#34;: [&#39;alice&#39;, &#39;bob&#39;, &#39;charlie&#39;],`        `&#34;year&#34;: [2020, 2021, 2022],`        `&#34;age&#34;: [20, 30, 40]})``df.set_index(&#34;year&#34;, inplace=True)``&gt;&gt;&gt; df`         `name  age``year`              `2020    alice   20``2021      bob   30``2022  charlie   40``   ``df.stack() # 列转行-创建新dataframe``&gt;&gt;&gt;` `year`      `2020  name      alice`      `age          20``2021  name        bob`      `age          30``2022  name    charlie`      `age          40``   ``# unstack: 行转列``df.stack().unstack() # 行转列-还原为原来的效果</span></span></span></code></pre></td></tr></table></div></div><p>63、如何在pandas中使用crosstab函数进行数据透视操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-63-1><a class=lnlinks href=#hl-63-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pd.crosstab(index, # 行`            `columns, # 列`            `values=None, # 聚合列`            `aggfunc=None, # 聚合函数`            `rownames=None, # 行-分组名称`            `colnames=None, # 列-分组名称`            `dropna=True, # 是否删除空值`            `normalize=False) # 是否标准化</span></span></code></pre></td></tr></table></div></div><p>64、在pandas中使用cut函数对数据进行离散化(分箱)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-64-1><a class=lnlinks href=#hl-64-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pd.cut(x=df[&#34;age&#34;], bins=10, right=True, labels=None)``# bins: 为整数表示分箱数量(等宽分)，为列表时表示切分点``# right: True-左开右闭``# labels: 分箱后显示的分箱名``# retbins=False, 是否返回分箱边界值</span></span></code></pre></td></tr></table></div></div><p>65、如何在pandas中使用qcut函数对数据进行等频分箱</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-65-1><a class=lnlinks href=#hl-65-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>qcut(x, # 待分箱的数据`     `q, # 等频分箱数量`     `labels=None, # 分箱后箱体名`     `retbins=False, # 是否返回分箱边界值`     `precision=3, # 分位数精度`     `duplicates=&#39;raise&#39; # 切分点重复如何处理`     `)</span></span></code></pre></td></tr></table></div></div><p>66、在pandas中使用interpolate函数进行数据插值操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-66-1><a class=lnlinks href=#hl-66-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.interpolate(method=&#39;liner&#39;, axis=0, limit=None, inplace=False)``# liner-线性插值</span></span></code></pre></td></tr></table></div></div><p>67、在pandas中使用bfill 和 ffill 函数进行数据填充操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-67-1><a class=lnlinks href=#hl-67-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.bfill() # 使用后值填充``df.ffill() # 使用前值填充</span></span></code></pre></td></tr></table></div></div><p>68、在pandas中使用正则表达式进行数据过滤操作</p><p><a href="http://mp.weixin.qq.com/s?__biz=MzU1NzAyODM4NQ==&amp;mid=2247485198&amp;idx=1&amp;sn=69c501b9727f18d654fc3fecf06f2f64&amp;chksm=fc3d4240cb4acb563bd285ce223d997bd5797713abbac6f14ce3d3804172d02837bc3b86a428&amp;scene=21#wechat_redirect" title="【python 基础】re 正则表达式" rel="noopener external nofollow noreferrer" target=_blank class=exturl>【python 基础】re 正则表达式
<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-68-1><a class=lnlinks href=#hl-68-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># pd.Series.str.contains(pat, case=True, flags=0, na=None, regex=True)``# pat: 字符类型 字符序列或者正则表达式``# case: 布尔类型 是否区分大小写``# flags: int类型 默认0 标志传递到re模块 比如flags=re.INGNORECASE 等价于 case=False``# na: 默认NaN 填写缺失值的值 可以随意指定``# regex: 布尔类型 默认True 假定pat为正则表达式 针对特殊字符需要设置regex=False``df = pd.DataFrame({&#34;name&#34;: [&#34;alice&#34;, &#34;bob&#34;, &#34;charlie&#34;, &#34;diana&#34;, &#34;emily&#34;],`                   `&#34;age&#34;: [10, 20, 30, 40, 50],`                   `&#34;email&#34;: [&#34;alice@qq.com&#34;, &#34;bob@163.com&#34;, &#34;charlie@yahoo.com&#34;, &#34;diana@gmail.com&#34;, &#34;emily@hotmail.com&#34;]})``&gt;&gt;&gt; df`      `name  age              email``0    alice   10       alice@qq.com``1      bob   20        bob@163.com``2  charlie   30  charlie@yahoo.com``3    diana   40    diana@gmail.com``4    emily   50  emily@hotmail.com``   ``df[df[&#34;email&#34;].str.contains(pat=&#34;gmail&#34;)]``&gt;&gt;&gt; ``    name  age            email``3  diana   40  diana@gmail.com``   ``df[df[&#34;email&#34;].str.contains(pat=&#34;gmail|qq&#34;, case=False)]``&gt;&gt;&gt; ``    name  age            email``0  alice   10     alice@qq.com``3  diana   40  diana@gmail.com</span></span></code></pre></td></tr></table></div></div><p>69、如何在pandas中使用diff函数进行时间序列处理</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-69-1><a class=lnlinks href=#hl-69-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 使用场景：现有某个用户的操作日志，想知道上一次操作跟下一次操作的间隔时间是多少。``date_range = pd.date_range(&#39;2023-01-01&#39;, periods=5)``se = pd.Series(data=date_range)``&gt;&gt;&gt; se``0   2023-01-01``1   2023-01-02``2   2023-01-03``3   2023-01-04``4   2023-01-05``   ``se_diff = se.diff() # 不填数字表示一阶，填了数字表示多阶，递减``&gt;&gt;&gt; se_diff``0      NaT``1   1 days``2   1 days``3   1 days``4   1 days</span></span></code></pre></td></tr></table></div></div><p>70、在dataframe中使用dropna进行删除空值的操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-70-1><a class=lnlinks href=#hl-70-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pd.DataFrame.dropna(axis=0, how=&#39;any&#39;, thresh=None, subset=None, inplace=True)``# subset: 用来判断是否删除的列``# axis: 0-删除行, 1-删除列``# how: any-一旦存在空值就删除, all-全为空时删除``# thresh: 0-1的浮点数，空值占比大于一定比例时删除``# inplace: 是否原地操作</span></span></code></pre></td></tr></table></div></div><p>71、如何在panda中使用join函数进行数据拼接操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-71-1><a class=lnlinks href=#hl-71-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 类似于sql中的join，但不会自动合并相同列名的字段``# 只要两个表列名不同，不加任何参数就可以直接用。``# 如果两个表有重复的列名，需指定 lsuffix（左侧数据重列列使用的列名后缀）, rsuffix 参数。``# 参数的意义与 merge 方法基本相同。``   ``df1.join(df2, on=[&#34;col1&#34;, &#34;col2&#34;], how=&#39;inner&#39;)</span></span></code></pre></td></tr></table></div></div><p><img src=/imgs/img-lazy-loading.gif data-src="https://mmbiz.qpic.cn/mmbiz_png/phUvdvw2lot9RwMjBXxQxEic8dFea6rnKToZ0oSjlbGH3DZDDav6YaYn2fHDG4iaKMmpIqhyicqic6FWkY4NYT5dzQ/640?wx_fmt=png" alt></p><p>72、如何在pandas中使用get_dummies函数进行哑变量编码操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-72-1><a class=lnlinks href=#hl-72-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=n>df</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pd</span><span class=p>.</span><span class=nf>DataFrame</span><span class=p>(</span><span class=err>{</span><span class=s2>&#34;color&#34;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;red&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;blue&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;green&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;red&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;grey&#34;</span><span class=p>]</span><span class=err>}</span><span class=p>)</span><span class=o>``&gt;&gt;&gt;</span><span class=w> </span><span class=n>df</span><span class=o>`</span><span class=w>   </span><span class=o>`</span><span class=n>color</span><span class=o>``</span><span class=mi>0</span><span class=w>    </span><span class=n>red</span><span class=o>``</span><span class=mi>1</span><span class=w>   </span><span class=n>blue</span><span class=o>``</span><span class=mi>2</span><span class=w>  </span><span class=n>green</span><span class=o>``</span><span class=mi>3</span><span class=w>    </span><span class=n>red</span><span class=o>``</span><span class=mi>4</span><span class=w>   </span><span class=n>grey</span><span class=o>``</span><span class=w>   </span><span class=o>``</span><span class=n>pd</span><span class=p>.</span><span class=nf>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>])</span><span class=o>``&gt;&gt;&gt;</span><span class=w> </span><span class=o>``</span><span class=w>   </span><span class=n>blue</span><span class=w>  </span><span class=n>green</span><span class=w>  </span><span class=n>grey</span><span class=w>  </span><span class=n>red</span><span class=o>``</span><span class=mi>0</span><span class=w>     </span><span class=mi>0</span><span class=w>      </span><span class=mi>0</span><span class=w>     </span><span class=mi>0</span><span class=w>    </span><span class=mi>1</span><span class=o>``</span><span class=mi>1</span><span class=w>     </span><span class=mi>1</span><span class=w>      </span><span class=mi>0</span><span class=w>     </span><span class=mi>0</span><span class=w>    </span><span class=mi>0</span><span class=o>``</span><span class=mi>2</span><span class=w>     </span><span class=mi>0</span><span class=w>      </span><span class=mi>1</span><span class=w>     </span><span class=mi>0</span><span class=w>    </span><span class=mi>0</span><span class=o>``</span><span class=mi>3</span><span class=w>     </span><span class=mi>0</span><span class=w>      </span><span class=mi>0</span><span class=w>     </span><span class=mi>0</span><span class=w>    </span><span class=mi>1</span><span class=o>``</span><span class=mi>4</span><span class=w>     </span><span class=mi>0</span><span class=w>      </span><span class=mi>0</span><span class=w>     </span><span class=mi>1</span><span class=w>    </span><span class=mi>0</span></span></span></code></pre></td></tr></table></div></div><p>73、如何将dataframe中的某一列转为int类型</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-73-1><a class=lnlinks href=#hl-73-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#39;col_name&#39;] = df[&#39;col_name&#39;].astype(np.int)</span></span></code></pre></td></tr></table></div></div><p>74、如何将dataframe中的某一列转为float类型</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-74-1><a class=lnlinks href=#hl-74-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 方法1``df[&#39;col_name&#39;] = df[&#39;col_name&#39;].astype(np.float)``# 方法2``df[&#39;col_name&#39;] = df[&#39;col_name&#39;].map(lambda x: float(x))``   ``不管是转为int还是float，都需要把数据中的特殊字符(如：NA, NULL等)转为空值，再转为需要的类型</span></span></code></pre></td></tr></table></div></div><p>75、如何使用to_excel进行excel数据写入操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-75-1><a class=lnlinks href=#hl-75-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.to_excel(excel_writer=&#34;文件路径&#34;,`    `sheet_name=&#34;Sheet1&#34;, # sheet表名`    `)</span></span></code></pre></td></tr></table></div></div><p>76、如何使用to_json将数据保存为json文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-76-1><a class=lnlinks href=#hl-76-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.to_json(path_or_buf=&#34;df.json&#34;, orient=None)``# orient:``#     split: 将json文件转换为多个文件，每个文件包含dafaframe中的一行``#     records: 将json文件转换为一个列表，每个元素是dataframe中的一行``#     index: 将json文件转换为一个字典，键是列名，值是一行记录``#     columns: 将json文件转换为一个字典，键是列名，值是一列记录``#     values: 将json文件转换为一个二维数组，每行是dataframe的一行记录</span></span></code></pre></td></tr></table></div></div><p>77、如何在pandas中使用plot函数画出柱形图</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-77-1><a class=lnlinks href=#hl-77-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import pandas as pd``import numpy as np``import matplotlib.pyplot as plt``   ``df = pd.DataFrame({&#34;name&#34;: [&#34;tom&#34;, &#34;jerry&#34;, &#34;mickey&#34;, &#34;minnie&#34;, &#34;donald&#34;],`        `&#34;age&#34;: [25, 23, 28, 27, 26],`        `&#34;score&#34;: [80, 90, 75, 85, 95]})``df.plot(kind=&#34;bar&#34;, x=&#34;name&#34;, y=&#39;score&#39;)``# plt.show() # jupyter需要执行plt.show才能在界面上显示图片</span></span></code></pre></td></tr></table></div></div><p>78、如何在pandas中使用plot函数画出折线图</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-78-1><a class=lnlinks href=#hl-78-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 当设置的标签信息有中文时，一般要先做一些设置``plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;] # 显示中文``plt.rcParams[&#39;axes.unicode_minus&#39;]=False # 取消使用unicode的负号``   ``plt.plot(df[&#34;col_x&#34;], df[&#34;col_y&#34;])``plt.title(&#34;图标题&#34;)``plt.xlabel(&#34;x轴名&#34;)``ply.ylabel(&#34;y轴名&#34;)``plt.show()</span></span></code></pre></td></tr></table></div></div><p>79、如何在pandas中使用plot函数画散点图</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-79-1><a class=lnlinks href=#hl-79-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.plot(kind=&#34;scatter&#34;, x=&#34;name&#34;, y=&#39;score&#39;)</span></span></code></pre></td></tr></table></div></div><p>80、如何在pandas中使用plot函数画出箱线图</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-80-1><a class=lnlinks href=#hl-80-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 方法1``df.plot(kind=&#34;box&#34;, x=&#34;name&#34;, y=&#39;score&#39;)``# 方法2``df.plot.box() # 默认对所有数值列绘制箱线图</span></span></code></pre></td></tr></table></div></div><p><img src=/imgs/img-lazy-loading.gif data-src="https://mmbiz.qpic.cn/mmbiz_png/phUvdvw2lot9RwMjBXxQxEic8dFea6rnK6eO7MOA4IHpPQ6vjiatXzXkXdR04qK1KwvSoxYvBWeMroH6055l8rWQ/640?wx_fmt=png" alt></p><p>81、如何在pandas中使用plot函数画出面积图</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-81-1><a class=lnlinks href=#hl-81-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pd.DataFrame.plot.area(x=None, y=None)``# 不传入x/y则是一个多列堆叠的面积图</span></span></code></pre></td></tr></table></div></div><p>82、如何在pandas中使用plot函数绘制饼图</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-82-1><a class=lnlinks href=#hl-82-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.plot(kind=&#39;pie&#39;, y=&#34;绘制饼图的列&#34;)</span></span></code></pre></td></tr></table></div></div><p>83、如何在pandas中对一列数据的正数和负数进行分组聚合操作</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-83-1><a class=lnlinks href=#hl-83-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=n>import</span><span class=w> </span><span class=n>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>pd</span><span class=o>``</span><span class=n>df</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pd</span><span class=p>.</span><span class=nf>DataFrame</span><span class=p>(</span><span class=err>{</span><span class=s2>&#34;val&#34;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=o>-</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=o>-</span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=p>]</span><span class=err>}</span><span class=p>)</span><span class=o>``</span><span class=n>df</span><span class=p>[</span><span class=s2>&#34;positive&#34;</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>df</span><span class=p>[</span><span class=s2>&#34;val&#34;</span><span class=p>]</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=o>``</span><span class=n>df</span><span class=p>[</span><span class=s2>&#34;negative&#34;</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>df</span><span class=p>[</span><span class=s2>&#34;val&#34;</span><span class=p>]</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span><span class=o>``</span><span class=n>df_result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>df</span><span class=p>.</span><span class=nf>groupby</span><span class=p>(</span><span class=k>by</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;positive&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;negative&#34;</span><span class=p>]).</span><span class=nf>agg</span><span class=p>(</span><span class=err>{</span><span class=s2>&#34;val&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;sum&#34;</span><span class=err>}</span><span class=p>)</span><span class=o>``</span><span class=n>df_result</span><span class=o>`</span><span class=w> </span><span class=o>`</span><span class=c1># 不知道意义在哪....</span></span></span></code></pre></td></tr></table></div></div><p>84、如何在pandas中实现两列的拼接</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-84-1><a class=lnlinks href=#hl-84-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#34;new&#34;] = df[&#34;col_1&#34;] + df[&#34;col_2&#34;]</span></span></code></pre></td></tr></table></div></div><p>85、如何对数据框中的字符串进行模糊匹配</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-85-1><a class=lnlinks href=#hl-85-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># pd.Series.str.contains(pat, case=True, flags=0, na=None, regex=True)``# pat: 字符类型 字符序列或者正则表达式``# case: 布尔类型 是否区分大小写``# flags: int类型 默认0 标志传递到re模块 比如flags=re.INGNORECASE 等价于 case=False``# na: 默认NaN 填写缺失值的值 可以随意指定``# regex: 布尔类型 默认True 假定pat为正则表达式 针对特殊字符需要设置regex=False</span></span></code></pre></td></tr></table></div></div><p>86、如何使用pandas处理文本数据</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-86-1><a class=lnlinks href=#hl-86-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># lower() / upper() 字母转小写、大写``# strip() 去除首尾空格``# split() 字符串切分``# contains() 判断字符串是否包含指定文本``# replace() 文本替换``# extract() 从字符串中提取指定的文本``df[&#39;col_new&#39;] = df[&#34;col&#34;].str.func()</span></span></code></pre></td></tr></table></div></div><p>87、如何在dataframe中找到重复的行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-87-1><a class=lnlinks href=#hl-87-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.duplicated(subset=[&#34;col_1&#34;, &#34;col2&#34;])``# subset: 判断是否重复的字段``# axis=0,默认判断重复行</span></span></code></pre></td></tr></table></div></div><p>88、如何查看数的异常值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-88-1><a class=lnlinks href=#hl-88-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 通过数据描述信息，判断是否存在异常值``import pandas as pd``df.describe()``   ``# 通过箱线图，判断是否存在异常值``from matplotlib import pyplot as plt``plt.boxplot(df)` `# df可以是一个Series，也可以是一个DataFrame``# 当df是一个DataFrame时，建议选取处于同一数量级，不然画出来的图就很难判断</span></span></code></pre></td></tr></table></div></div><p>89、如何查找dataframe中的缺失值</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-89-1><a class=lnlinks href=#hl-89-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 使用某一列判断，得到存在空值的行``df[df[&#39;col&#39;].isnull()]``   ``# 判断整个dataframe每个字段的数量``df.isnull().sum()``   ``# info可以获取数据集信息``df.info()</span></span></code></pre></td></tr></table></div></div><p>90、如何在dataframe中获取某一列的值只出现一次的所有行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-90-1><a class=lnlinks href=#hl-90-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>se_value_counts = df[&#39;col&#39;].value_counts()``df[df[&#34;col&#34;].isin(se_value_counts[se_value_counts==1].index)]</span></span></code></pre></td></tr></table></div></div><p>91、如何在pandas中求相邻元素的差异</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-91-1><a class=lnlinks href=#hl-91-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#39;col&#39;].diff()` `# 当col字段是时间时，求的是前后两条记录的时间差``# 当col字段是数值时，求的是间隔元素的差值</span></span></code></pre></td></tr></table></div></div><p>92、如何将dataframe中的某一列中包含的字符串进行拆分</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-92-1><a class=lnlinks href=#hl-92-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 新字段是一个列表，并且没找到切分符号会返回空值``df[&#39;col_new&#39;] = df[&#39;col&#39;].str.split(&#34;_&#34;)``   ``# 取切分后的第一个值``df[&#34;col_new&#34;] = df[&#34;col&#34;].map(lambda x: str(x).split(&#34;_&#34;)[0])</span></span></code></pre></td></tr></table></div></div><p>93、如何使用pandas 对某一列数据进行md5加密</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-93-1><a class=lnlinks href=#hl-93-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 联合建模时，对姓名、手机号、身份证等敏感信息进行加密``import hashlib``df[&#39;col_md5&#39;] = df[&#34;col&#34;].map(lambda x: hashlib.md5(x).hexdigest())</span></span></code></pre></td></tr></table></div></div><p>94、如何在pandas中使用groupby和agg进行分组聚合</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-94-1><a class=lnlinks href=#hl-94-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df.groupby(by=[&#34;col_1&#34;, &#34;col_2&#34;]).agg({&#34;score&#34;: &#34;sum&#34;, &#34;age&#34;: &#34;mean&#34;})</span></span></code></pre></td></tr></table></div></div><p>95、如何在dataframe中使用cumsum函数进行累计计算</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-95-1><a class=lnlinks href=#hl-95-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 整个dataframe横向或纵向求和, 0-横向,1-纵向``df.cumsum(axis=1)</span></span></code></pre></td></tr></table></div></div><p>96、如何将dataframe根据某一列的值进行过滤</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-96-1><a class=lnlinks href=#hl-96-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 筛选出年龄 大于 30 的 男性``df[(df[&#39;age&#39;]&gt;30) &amp; df[&#39;gender&#39;]==&#39;male&#39;]</span></span></code></pre></td></tr></table></div></div><p>97、如何使用pandas中的值计算出新的一列</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-97-1><a class=lnlinks href=#hl-97-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df[&#39;new&#39;] = 0.4 * df[&#34;col&#34;] + 0.6*100</span></span></code></pre></td></tr></table></div></div><p>98、如何为dataframe的每个元素使用一个自定义函数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-98-1><a class=lnlinks href=#hl-98-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>def test(x)`    `return x+1``df_new = df.apply(test)</span></span></code></pre></td></tr></table></div></div><p>99、如何使用pandas对数据进行预处理</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-99-1><a class=lnlinks href=#hl-99-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 读取数据``df = pd.read_csv(datapath) # pd.read_excel(datapath, sheet_name)``# 描述信息``df.describe()``# 数据详情``df.info()``# 类型转换``df[&#34;col&#34;] = df[&#34;col&#34;].astype(np.int)``# 删除空值``df.dropna()``# 删除重复值``df.drop_duplicates()``# 填充空值``df.fillna()</span></span></code></pre></td></tr></table></div></div><p>100、如何从一个csv文件中读取数据，将其中的数值数据进行聚合，并计算每个聚合后的组的中位数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-100-1><a class=lnlinks href=#hl-100-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 读取数据``df = pd.read_csv(datapath, encoding=&#39;utf-8&#39;)``# 删除重复值``df.drop_duplicates(inplace=True)``# 删除空值``df.dropna(subset=[...], inplace=True, how=&#39;any&#39;)``# 分组聚合``df.groupby(by=[&#34;col_1&#34;, &#34;col_2&#34;]).agg({&#34;col_cal&#34;: &#34;median&#34;})</span></span></code></pre></td></tr></table></div></div><p>本文转自
<a href=https://mp.weixin.qq.com/s/ER3s5yjMwMzQqiEr8YwYJQ title=https://mp.weixin.qq.com/s/ER3s5yjMwMzQqiEr8YwYJQ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://mp.weixin.qq.com/s/ER3s5yjMwMzQqiEr8YwYJQ
<i class="fa fa-external-link-alt"></i>
</a>，如有侵权，请联系删除。</p></div><footer class=post-footer><div class=post-tags><a href=/tags/pandas/>pandas</a></div><div class=post-share-tools><div class=post-share-loading><i class="fa-solid fa-ellipsis fa-spin"></i></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class=a2a_dd href=https://www.addtoany.com/share></a><a class=a2a_button_wechat></a><a class=a2a_button_qzone></a><a class=a2a_button_sina_weibo></a><a class=a2a_button_douban></a><a class=a2a_button_facebook></a><a class=a2a_button_x></a><a class=a2a_button_email></a><a class=a2a_button_printfriendly></a></div></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="Rich - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="Rich - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Python pandas数据分析基础100问(有重复)</li><li class=post-copyright-author><strong>本文作者： </strong>Rich</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=//localhost:1313/%E7%A8%8B%E6%8A%80/python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D/ title="Python pandas数据分析基础100问(有重复)">//localhost:1313/%E7%A8%8B%E6%8A%80/python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/white.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/rss.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/%E7%A8%8B%E6%8A%80/python/pycharm%E4%BC%98%E5%8C%96%E4%BD%BF%E7%94%A8/ rel=next title="PyCharm 优化使用"><i class="fa fa-chevron-left"></i> PyCharm 优化使用</a></div><div class="post-nav-prev post-nav-item"><a href=/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch08-%E6%95%B0%E6%8D%AE%E8%A7%84%E6%95%B4%E8%81%9A%E5%90%88%E5%90%88%E5%B9%B6%E5%92%8C%E9%87%8D%E5%A1%91/ rel=prev title="第八章 数据规整：聚合、合并和重塑">第八章 数据规整：聚合、合并和重塑
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div id=i18n-translate class=i18n-translate><i class="fa fa-language"></i><div id=lang-select class=lang-select><div id=lang-selected class=selected-option><span class="flag-icon flag-icon-zh-cn"></span>
<span class=selected-language>简体中文</span>
<i class="fa fa-chevron-down"></i></div><div id=lang-options class=lang-options><div class=lang-option lang-code=zh-cn lang-name=简体中文 lang-url=/%E7%A8%8B%E6%8A%80/python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D/><span class="flag-icon flag-icon-zh-cn"></span>
<span class=lang-name>简体中文</span></div></div></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rich</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.147.7 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>萌ICP备20250629号</a>
<img src=/imgs/gongan.png alt=萌公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>萌公网安备 31011402009770 号</a></div><div class=custom-footer>Website source code <a href=https://github.com/hugo-next/hugo-theme-next/blob/develop/exampleSite/layouts/partials/custom_footer.html target=_blank>here</a></div></div></footer><script class=next-config data-name=page type=application/json>{"clipboard":{"js":{"alias":"clipboard","file":"dist/clipboard.min.js","name":"clipboard.js","version":"2.0.11"}},"comments":false,"expired":false,"isHome":false,"isPage":true,"path":"python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D","permalink":"//localhost:1313/%E7%A8%8B%E6%8A%80/python-pandas%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80100%E9%97%AE%E6%9C%89%E9%87%8D%E5%A4%8D/","title":"Python pandas数据分析基础100问(有重复)","toc":true,"waline":{"commentcnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/comment.js","name":"comment","version":"2.15.8"}}}</script><script type=text/javascript src=//localhost:1313/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=//localhost:1313/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"hostname":"//localhost:1313/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":true,"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"slideInRight","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":true},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"//localhost:1313/js/3rd"}},"version":"4.8.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.js?=1750130313" defer></script><script type=text/javascript src="/js/clipboard.js?=1750130313" defer></script></body></html>