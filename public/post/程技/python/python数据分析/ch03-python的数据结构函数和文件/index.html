<!doctype html><html lang=zh-CN data-theme=dark><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.147.7"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="第三章 Python 的数据结构、函数和文件"><meta itemprop=description content="保持简单的易用性和强大的功能。"><meta name=description content="保持简单的易用性和强大的功能。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=keywords content="python"><meta property="og:type" content="article"><meta property="og:title" content="第三章 Python 的数据结构、函数和文件"><meta property="og:description" content="保持简单的易用性和强大的功能。"><meta property="og:image" content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="//localhost:1313/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch03-python%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%87%BD%E6%95%B0%E5%92%8C%E6%96%87%E4%BB%B6/"><meta property="og:site_name" content="樊尘刹记"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Rich"><meta property="article:published_time" content="2023-09-25 00:00:00 +0000 UTC"><meta property="article:modified_time" content="2023-09-25 00:00:00 +0000 UTC"><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=//localhost:1313/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.css?=1750130938"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><link rel=stylesheet type=text/css href="/css/custom_style.css?=1750130938"><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>第三章 Python 的数据结构、函数和文件 - 樊尘刹记</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>樊尘刹记</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>红尘湮灭，唯有尘刹</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>629</span></a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友链</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#311-元组>3.1.1 元组</a></li><li><a href=#312-拆分元组>3.1.2 拆分元组</a></li><li><a href=#313-tuple方法>3.1.3 tuple方法</a></li><li><a href=#314-列表>3.1.4 列表</a></li><li><a href=#315-添加和删除元素>3.1.5 添加和删除元素</a></li><li><a href=#316-串联和组合列表>3.1.6 串联和组合列表</a></li><li><a href=#317-排序>3.1.7 排序</a></li><li><a href=#318-二分搜索和维护已排序的列表>3.1.8 二分搜索和维护已排序的列表</a></li><li><a href=#319-切片>3.1.9 切片</a></li><li><a href=#3110-序列函数>3.1.10 序列函数</a></li><li><a href=#3111-enumerate函数>3.1.11 enumerate函数</a></li><li><a href=#3112-sorted函数>3.1.12 sorted函数</a></li><li><a href=#3113-zip函数>3.1.13 zip函数</a></li><li><a href=#3114-reversed函数>3.1.14 reversed函数</a></li><li><a href=#3115-字典>3.1.15 字典</a></li><li><a href=#3116-用序列创建字典>3.1.16 用序列创建字典</a></li><li><a href=#3117-默认值>3.1.17 默认值</a></li><li><a href=#3118-有效的键类型>3.1.18 有效的键类型</a></li><li><a href=#3119-集合>3.1.19 集合</a></li><li><a href=#3120-列表集合和字典推导式>3.1.20 列表、集合和字典推导式</a></li><li><a href=#3121-嵌套列表推导式>3.1.21 嵌套列表推导式</a></li></ul><ul><li><a href=#321-命名空间作用域和局部函数>3.2.1 命名空间、作用域，和局部函数</a></li><li><a href=#322-返回多个值>3.2.2 返回多个值</a></li><li><a href=#323-函数也是对象>3.2.3 函数也是对象</a></li><li><a href=#324-匿名lambda函数>3.2.4 匿名（lambda）函数</a></li><li><a href=#325-柯里化部分参数应用>3.2.5 柯里化：部分参数应用</a></li><li><a href=#326-生成器>3.2.6 生成器</a></li><li><a href=#327-生成器表达式>3.2.7 生成器表达式</a></li><li><a href=#328-itertools模块>3.2.8 itertools模块</a></li><li><a href=#329-错误和异常处理>3.2.9 错误和异常处理</a></li><li><a href=#3210-ipython的异常>3.2.10 IPython的异常</a></li></ul><ul><li><a href=#331-文件的字节和unicode>3.3.1 文件的字节和Unicode</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Rich src=/imgs/img-lazy-loading.gif data-src=https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif><p class=site-author-name itemprop=name>Rich</p><div class=site-description itemprop=description>保持简单的易用性和强大的功能。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>629</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>8</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>99</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/richbridge title="Github → https://github.com/richbridge" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/richfan-38 title="知乎 → https://www.zhihu.com/people/richfan-38" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站</a></li></ul></div><div class="mydefined animated" itemprop=custom><span>支持自定义CSS和Sidebar布局啦💄💄💄</span></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="0001-01-01 00:00:00 +0000 UTC"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=2702735></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=5708></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2025-01-24 00:00:00 +0000 UTC"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-i18n-translate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/richbridge rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=//localhost:1313/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch03-python%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%87%BD%E6%95%B0%E5%92%8C%E6%96%87%E4%BB%B6/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="https://jsd.cdn.zzko.cn/gh/richbridge/picx-images-hosting@master/avatar.avif"><meta itemprop=name content="Rich"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Rich"><meta itemprop=description content="保持简单的易用性和强大的功能。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="第三章 Python 的数据结构、函数和文件"><meta itemprop=description content="
    🐹 本章讨论Python的内置功能，这些功能本书会用到很多。虽然扩展库，比如pandas和Numpy，使处理大数据集很方便，但它们是和Python的内置数据处理工具一同使用的。"></span><header class=post-header><h1 class=post-title itemprop="name headline">第三章 Python 的数据结构、函数和文件</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2023-09-25 00:00:00 +00:00" itemprop="dateCreated datePublished" datetime="2023-09-25 00:00:00 +0000 UTC">2023-09-25
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E7%A8%8B%E6%8A%80/ itemprop=url rel=index><span itemprop=name>程技</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>13150</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>27分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch03-python%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%87%BD%E6%95%B0%E5%92%8C%E6%96%87%E4%BB%B6/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><blockquote><p>🐹 本章讨论Python的内置功能，这些功能本书会用到很多。虽然扩展库，比如pandas和Numpy，使处理大数据集很方便，但它们是和Python的内置数据处理工具一同使用的。</p><a id=more></a><p>我们会从Python最基础的数据结构开始：元组、列表、字典和集合。然后会讨论创建你自己的、可重复使用的Python函数。最后，会学习Python的文件对象，以及如何与本地硬盘交互。</p></blockquote><h1 id=31-数据结构和序列>3.1 数据结构和序列
<a class=header-anchor href=#31-%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e5%92%8c%e5%ba%8f%e5%88%97></a></h1><p>Python的数据结构简单而强大。通晓它们才能成为熟练的Python程序员。</p><h2 id=311-元组>3.1.1 元组
<a class=header-anchor href=#311-%e5%85%83%e7%bb%84></a></h2><p>元组是一个固定长度，不可改变的Python序列对象。创建元组的最简单方式，是用逗号分隔一列值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>1</span><span class=p>]:</span> <span class=n>tup</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>2</span><span class=p>]:</span> <span class=n>tup</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>2</span><span class=p>]:</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>当用复杂的表达式定义元组，最好将值放到圆括号内，如下所示：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>3</span><span class=p>]:</span> <span class=n>nested_tup</span> <span class=o>=</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>),</span> <span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>4</span><span class=p>]:</span> <span class=n>nested_tup</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>4</span><span class=p>]:</span> <span class=p>((</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>),</span> <span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><p>用<code>tuple</code>可以将任意序列或迭代器转换成元组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>5</span><span class=p>]:</span> <span class=nb>tuple</span><span class=p>([</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>5</span><span class=p>]:</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>6</span><span class=p>]:</span> <span class=n>tup</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=s1>&#39;string&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>7</span><span class=p>]:</span> <span class=n>tup</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>7</span><span class=p>]:</span> <span class=p>(</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=s1>&#39;t&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=s1>&#39;i&#39;</span><span class=p>,</span> <span class=s1>&#39;n&#39;</span><span class=p>,</span> <span class=s1>&#39;g&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>可以用方括号访问元组中的元素。和C、C++、JAVA等语言一样，序列是从0开始的：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>8</span><span class=p>]:</span> <span class=n>tup</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>8</span><span class=p>]:</span> <span class=s1>&#39;s&#39;</span></span></span></code></pre></td></tr></table></div></div><p>元组中存储的对象可能是可变对象。<strong>一旦创建了元组，元组中的对象就不能修改了</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7>7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>9</span><span class=p>]:</span> <span class=n>tup</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>([</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=kc>True</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>10</span><span class=p>]:</span> <span class=n>tup</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span>                                 <span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ipython</span><span class=o>-</span><span class=nb>input</span><span class=o>-</span><span class=mi>10</span><span class=o>-</span><span class=n>c7308343b841</span><span class=o>&gt;</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>1</span> <span class=n>tup</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span><span class=p>:</span> <span class=s1>&#39;tuple&#39;</span> <span class=nb>object</span> <span class=n>does</span> <span class=ow>not</span> <span class=n>support</span> <span class=n>item</span> <span class=n>assignment</span></span></span></code></pre></td></tr></table></div></div><p>如果元组中的某个对象是可变的，比如列表，可以在原位进行修改：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>11</span><span class=p>]:</span> <span class=n>tup</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>12</span><span class=p>]:</span> <span class=n>tup</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>12</span><span class=p>]:</span> <span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=kc>True</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>可以用加号运算符将元组串联起来：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>13</span><span class=p>]:</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=s1>&#39;bar&#39;</span><span class=p>,)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>13</span><span class=p>]:</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>元组乘以一个整数，像列表一样，会将几个元组的复制串联起来：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>14</span><span class=p>]:</span> <span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>14</span><span class=p>]:</span> <span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>对象本身并没有被复制，只是引用了它。</p><h2 id=312-拆分元组>3.1.2 拆分元组
<a class=header-anchor href=#312-%e6%8b%86%e5%88%86%e5%85%83%e7%bb%84></a></h2><p>如果你想将元组赋值给类似元组的变量，Python会试图拆分等号右边的值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>15</span><span class=p>]:</span> <span class=n>tup</span> <span class=o>=</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>16</span><span class=p>]:</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=n>tup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>17</span><span class=p>]:</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>17</span><span class=p>]:</span> <span class=mi>5</span></span></span></code></pre></td></tr></table></div></div><p>即使含有元组的元组也会被拆分：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>18</span><span class=p>]:</span> <span class=n>tup</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>19</span><span class=p>]:</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span> <span class=o>=</span> <span class=n>tup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>20</span><span class=p>]:</span> <span class=n>d</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>20</span><span class=p>]:</span> <span class=mi>7</span></span></span></code></pre></td></tr></table></div></div><p>使用这个功能，你可以很容易地替换变量的名字，其它语言可能是这样：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>tmp</span> <span class=o>=</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=n>tmp</span></span></span></code></pre></td></tr></table></div></div><p>但是在Python中，替换可以这样做：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>21</span><span class=p>]:</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>22</span><span class=p>]:</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>22</span><span class=p>]:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>23</span><span class=p>]:</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>23</span><span class=p>]:</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>24</span><span class=p>]:</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>25</span><span class=p>]:</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>25</span><span class=p>]:</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>26</span><span class=p>]:</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>26</span><span class=p>]:</span> <span class=mi>1</span></span></span></code></pre></td></tr></table></div></div><p>变量拆分常用来迭代元组或列表序列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>27</span><span class=p>]:</span> <span class=n>seq</span> <span class=o>=</span> <span class=p>[(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>),</span> <span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>28</span><span class=p>]:</span> <span class=k>for</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>seq</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>     <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;a=</span><span class=si>{0}</span><span class=s1>, b=</span><span class=si>{1}</span><span class=s1>, c=</span><span class=si>{2}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>c</span><span class=o>=</span><span class=mi>9</span></span></span></code></pre></td></tr></table></div></div><p>另一个常见用法是从函数返回多个值。后面会详解。</p><p>Python最近新增了更多高级的元组拆分功能，允许从元组的开头“摘取”几个元素。它使用了特殊的语法<code>*rest</code>，这也用在函数签名中以抓取任意长度列表的位置参数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4>4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5>5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6>6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7>7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8>8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>29</span><span class=p>]:</span> <span class=n>values</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>30</span><span class=p>]:</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=o>*</span><span class=n>rest</span> <span class=o>=</span> <span class=n>values</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>31</span><span class=p>]:</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>31</span><span class=p>]:</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>32</span><span class=p>]:</span> <span class=n>rest</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>32</span><span class=p>]:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p><code>rest</code>的部分是想要舍弃的部分，rest的名字不重要。作为惯用写法，许多Python程序员会将不需要的变量使用下划线：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>33</span><span class=p>]:</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=o>*</span><span class=n>_</span> <span class=o>=</span> <span class=n>values</span></span></span></code></pre></td></tr></table></div></div><h2 id=313-tuple方法>3.1.3 tuple方法
<a class=header-anchor href=#313-tuple%e6%96%b9%e6%b3%95></a></h2><p>因为元组的大小和内容不能修改，它的实例方法都很轻量。其中一个很有用的就是<code>count</code>（也适用于列表），它可以统计某个值得出现频率：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>34</span><span class=p>]:</span> <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>35</span><span class=p>]:</span> <span class=n>a</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>35</span><span class=p>]:</span> <span class=mi>4</span></span></span></code></pre></td></tr></table></div></div><h2 id=314-列表>3.1.4 列表
<a class=header-anchor href=#314-%e5%88%97%e8%a1%a8></a></h2><p>与元组对比，列表的长度可变、内容可以被修改。你可以用方括号定义，或用<code>list</code>函数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>36</span><span class=p>]:</span> <span class=n>a_list</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>37</span><span class=p>]:</span> <span class=n>tup</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>38</span><span class=p>]:</span> <span class=n>b_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>tup</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>39</span><span class=p>]:</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>39</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>40</span><span class=p>]:</span> <span class=n>b_list</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;peekaboo&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>41</span><span class=p>]:</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>41</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;peekaboo&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>列表和元组的语义接近，在许多函数中可以交叉使用。</p><p><code>list</code>函数常用来在数据处理中实体化迭代器或生成器：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4>4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5>5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6>6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>42</span><span class=p>]:</span> <span class=n>gen</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>43</span><span class=p>]:</span> <span class=n>gen</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>43</span><span class=p>]:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>44</span><span class=p>]:</span> <span class=nb>list</span><span class=p>(</span><span class=n>gen</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>44</span><span class=p>]:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><h2 id=315-添加和删除元素>3.1.5 添加和删除元素
<a class=header-anchor href=#315-%e6%b7%bb%e5%8a%a0%e5%92%8c%e5%88%a0%e9%99%a4%e5%85%83%e7%b4%a0></a></h2><p>可以用<code>append</code>在列表末尾添加元素：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2>2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3>3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>45</span><span class=p>]:</span> <span class=n>b_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;dwarf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>46</span><span class=p>]:</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>46</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;peekaboo&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>,</span> <span class=s1>&#39;dwarf&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p><code>insert</code>可以在特定的位置插入元素：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2>2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3>3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>47</span><span class=p>]:</span> <span class=n>b_list</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>48</span><span class=p>]:</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>48</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;peekaboo&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>,</span> <span class=s1>&#39;dwarf&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>插入的序号必须在0和列表长度之间。</p><blockquote><p>警告：与<code>append</code>相比，<code>insert</code>耗费的计算量大，因为对后续元素的引用必须在内部迁移，以便为新元素提供空间。如果要在序列的头部和尾部插入元素，你可能需要使用<code>collections.deque</code>，一个双尾部队列。</p></blockquote><p>insert的逆运算是pop，它移除并返回指定位置的元素：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1>1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2>2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3>3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4>4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>49</span><span class=p>]:</span> <span class=n>b_list</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>49</span><span class=p>]:</span> <span class=s1>&#39;peekaboo&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>50</span><span class=p>]:</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>50</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>,</span> <span class=s1>&#39;dwarf&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>可以用<code>remove</code>去除某个值，<code>remove</code>会先寻找第一个值并除去：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1>1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2>2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3>3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4>4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5>5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6>6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7>7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8>8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>51</span><span class=p>]:</span> <span class=n>b_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>52</span><span class=p>]:</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>52</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>,</span> <span class=s1>&#39;dwarf&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>53</span><span class=p>]:</span> <span class=n>b_list</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=s1>&#39;foo&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>54</span><span class=p>]:</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>54</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>,</span> <span class=s1>&#39;dwarf&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>如果不考虑性能，使用<code>append</code>和<code>remove</code>，可以把Python的列表当做完美的“多重集”数据结构。</p><p>用<code>in</code>可以检查列表是否包含某个值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1>1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>55</span><span class=p>]:</span> <span class=s1>&#39;dwarf&#39;</span> <span class=ow>in</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>55</span><span class=p>]:</span> <span class=kc>True</span></span></span></code></pre></td></tr></table></div></div><p>否定<code>in</code>可以再加一个not：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1>1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>56</span><span class=p>]:</span> <span class=s1>&#39;dwarf&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>b_list</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>56</span><span class=p>]:</span> <span class=kc>False</span></span></span></code></pre></td></tr></table></div></div><p>在列表中检查是否存在某个值远比字典和集合速度慢，因为Python是<strong>线性搜索</strong>列表中的值，但在字典和集合中，在同样的时间内还可以检查其它项（基于哈希表）。</p><h2 id=316-串联和组合列表>3.1.6 串联和组合列表
<a class=header-anchor href=#316-%e4%b8%b2%e8%81%94%e5%92%8c%e7%bb%84%e5%90%88%e5%88%97%e8%a1%a8></a></h2><p>与元组类似，可以用加号将两个列表串联起来：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1>1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>57</span><span class=p>]:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>57</span><span class=p>]:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)]</span></span></span></code></pre></td></tr></table></div></div><p>如果已经定义了一个列表，用<code>extend</code>方法可以追加多个元素：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1>1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2>2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3>3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4>4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5>5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>58</span><span class=p>]:</span> <span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>59</span><span class=p>]:</span> <span class=n>x</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>60</span><span class=p>]:</span> <span class=n>x</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>60</span><span class=p>]:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)]</span></span></span></code></pre></td></tr></table></div></div><p>通过加法将列表串联的计算量较大，因为要新建一个列表，并且要复制对象。用<code>extend</code>追加元素，尤其是到一个大列表中，更为可取。因此：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1>1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2>2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>everything</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>list_of_lists</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>everything</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>要比串联方法快：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1>1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2>2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>everything</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>list_of_lists</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>everything</span> <span class=o>=</span> <span class=n>everything</span> <span class=o>+</span> <span class=n>chunk</span></span></span></code></pre></td></tr></table></div></div><h2 id=317-排序>3.1.7 排序
<a class=header-anchor href=#317-%e6%8e%92%e5%ba%8f></a></h2><p>你可以用<code>sort</code>函数将一个列表原地排序（不创建新的对象）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1>1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2>2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3>3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4>4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5>5</a>
</span><span class=lnt id=hl-28-6><a class=lnlinks href=#hl-28-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>61</span><span class=p>]:</span> <span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>62</span><span class=p>]:</span> <span class=n>a</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>63</span><span class=p>]:</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>63</span><span class=p>]:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p><code>sort</code>有一些选项，有时会很好用。其中之一是二级排序key，可以用这个key进行排序。例如，我们可以按长度对字符串进行排序：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1>1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2>2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3>3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4>4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5>5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>64</span><span class=p>]:</span> <span class=n>b</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;saw&#39;</span><span class=p>,</span> <span class=s1>&#39;small&#39;</span><span class=p>,</span> <span class=s1>&#39;He&#39;</span><span class=p>,</span> <span class=s1>&#39;foxes&#39;</span><span class=p>,</span> <span class=s1>&#39;six&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>65</span><span class=p>]:</span> <span class=n>b</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=nb>len</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>66</span><span class=p>]:</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>66</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;He&#39;</span><span class=p>,</span> <span class=s1>&#39;saw&#39;</span><span class=p>,</span> <span class=s1>&#39;six&#39;</span><span class=p>,</span> <span class=s1>&#39;small&#39;</span><span class=p>,</span> <span class=s1>&#39;foxes&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>稍后，我们会学习<code>sorted</code>函数，它可以产生一个排好序的序列副本。</p><h2 id=318-二分搜索和维护已排序的列表>3.1.8 二分搜索和维护已排序的列表
<a class=header-anchor href=#318-%e4%ba%8c%e5%88%86%e6%90%9c%e7%b4%a2%e5%92%8c%e7%bb%b4%e6%8a%a4%e5%b7%b2%e6%8e%92%e5%ba%8f%e7%9a%84%e5%88%97%e8%a1%a8></a></h2><p><code>bisect</code>模块支持二分查找，和向已排序的列表插入值。<code>bisect.bisect</code>可以找到插入值后仍保证排序的位置，<code>bisect.insort</code>是向这个位置插入值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span><span class=lnt id=hl-30-13><a class=lnlinks href=#hl-30-13>13</a>
</span><span class=lnt id=hl-30-14><a class=lnlinks href=#hl-30-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>67</span><span class=p>]:</span> <span class=kn>import</span> <span class=nn>bisect</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>68</span><span class=p>]:</span> <span class=n>c</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>69</span><span class=p>]:</span> <span class=n>bisect</span><span class=o>.</span><span class=n>bisect</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>69</span><span class=p>]:</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>70</span><span class=p>]:</span> <span class=n>bisect</span><span class=o>.</span><span class=n>bisect</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>70</span><span class=p>]:</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>71</span><span class=p>]:</span> <span class=n>bisect</span><span class=o>.</span><span class=n>insort</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>72</span><span class=p>]:</span> <span class=n>c</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>72</span><span class=p>]:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>注意：<code>bisect</code>模块不会检查列表是否已排好序，进行检查的话会耗费大量计算。因此，对未排序的列表使用<code>bisect</code>不会产生错误，但结果不一定正确。</p></blockquote><h2 id=319-切片>3.1.9 切片
<a class=header-anchor href=#319-%e5%88%87%e7%89%87></a></h2><p>用切边可以选取大多数序列类型的一部分，切片的基本形式是在方括号中使用<code>start:stop</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1>1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2>2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3>3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>73</span><span class=p>]:</span> <span class=n>seq</span> <span class=o>=</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>74</span><span class=p>]:</span> <span class=n>seq</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>74</span><span class=p>]:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>切片也可以被序列赋值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1>1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2>2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3>3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>75</span><span class=p>]:</span> <span class=n>seq</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>76</span><span class=p>]:</span> <span class=n>seq</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>76</span><span class=p>]:</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>切片的起始元素是包括的，不包含结束元素。因此，结果中包含的元素个数是<code>stop - start</code>。</p><p><code>start</code>或<code>stop</code>都可以被省略，省略之后，分别默认序列的开头和结尾：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1>1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2>2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3>3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4>4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>77</span><span class=p>]:</span> <span class=n>seq</span><span class=p>[:</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>77</span><span class=p>]:</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>78</span><span class=p>]:</span> <span class=n>seq</span><span class=p>[</span><span class=mi>3</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>78</span><span class=p>]:</span> <span class=p>[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>负数表明从后向前切片：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1>1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2>2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3>3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4>4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>79</span><span class=p>]:</span> <span class=n>seq</span><span class=p>[</span><span class=o>-</span><span class=mi>4</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>79</span><span class=p>]:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>80</span><span class=p>]:</span> <span class=n>seq</span><span class=p>[</span><span class=o>-</span><span class=mi>6</span><span class=p>:</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>80</span><span class=p>]:</span> <span class=p>[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>需要一段时间来熟悉使用切片，尤其是当你之前学的是R或MATLAB。图3-1展示了正整数和负整数的切片。在图中，指数标示在边缘以表明切片是在哪里开始哪里结束的。</p><p><img src=/imgs/img-lazy-loading.gif data-src=http://upload-images.jianshu.io/upload_images/7178691-522e2b688b755ff3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240 alt="图3-1 Python切片演示"></p><p>在第二个冒号后面使用<code>step</code>，可以隔一个取一个元素：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1>1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>81</span><span class=p>]:</span> <span class=n>seq</span><span class=p>[::</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>81</span><span class=p>]:</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>一个聪明的方法是使用<code>-1</code>，它可以将列表或元组颠倒过来：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1>1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>82</span><span class=p>]:</span> <span class=n>seq</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>82</span><span class=p>]:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>7</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><h2 id=3110-序列函数>3.1.10 序列函数
<a class=header-anchor href=#3110-%e5%ba%8f%e5%88%97%e5%87%bd%e6%95%b0></a></h2><p>Python有一些有用的序列函数。</p><h2 id=3111-enumerate函数>3.1.11 enumerate函数
<a class=header-anchor href=#3111-enumerate%e5%87%bd%e6%95%b0></a></h2><p>迭代一个序列时，你可能想跟踪当前项的序号。手动的方法可能是下面这样：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1>1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2>2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3>3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>collection</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=c1># do something with value</span>
</span></span><span class=line><span class=cl>   <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span></span></span></code></pre></td></tr></table></div></div><p>因为这么做很常见，Python内建了一个<code>enumerate</code>函数，可以返回<code>(i, value)</code>元组序列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1>1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>collection</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=c1># do something with value</span></span></span></code></pre></td></tr></table></div></div><p>当你索引数据时，使用<code>enumerate</code>的一个好方法是计算序列（唯一的）<code>dict</code>映射到位置的值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1>1</a>
</span><span class=lnt id=hl-39-2><a class=lnlinks href=#hl-39-2>2</a>
</span><span class=lnt id=hl-39-3><a class=lnlinks href=#hl-39-3>3</a>
</span><span class=lnt id=hl-39-4><a class=lnlinks href=#hl-39-4>4</a>
</span><span class=lnt id=hl-39-5><a class=lnlinks href=#hl-39-5>5</a>
</span><span class=lnt id=hl-39-6><a class=lnlinks href=#hl-39-6>6</a>
</span><span class=lnt id=hl-39-7><a class=lnlinks href=#hl-39-7>7</a>
</span><span class=lnt id=hl-39-8><a class=lnlinks href=#hl-39-8>8</a>
</span><span class=lnt id=hl-39-9><a class=lnlinks href=#hl-39-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>83</span><span class=p>]:</span> <span class=n>some_list</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>84</span><span class=p>]:</span> <span class=n>mapping</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>85</span><span class=p>]:</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>some_list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>     <span class=n>mapping</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>86</span><span class=p>]:</span> <span class=n>mapping</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>86</span><span class=p>]:</span> <span class=p>{</span><span class=s1>&#39;bar&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h2 id=3112-sorted函数>3.1.12 sorted函数
<a class=header-anchor href=#3112-sorted%e5%87%bd%e6%95%b0></a></h2><p><code>sorted</code>函数可以从任意序列的元素返回一个新的排好序的列表：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1>1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2>2</a>
</span><span class=lnt id=hl-40-3><a class=lnlinks href=#hl-40-3>3</a>
</span><span class=lnt id=hl-40-4><a class=lnlinks href=#hl-40-4>4</a>
</span><span class=lnt id=hl-40-5><a class=lnlinks href=#hl-40-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>87</span><span class=p>]:</span> <span class=nb>sorted</span><span class=p>([</span><span class=mi>7</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>87</span><span class=p>]:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>88</span><span class=p>]:</span> <span class=nb>sorted</span><span class=p>(</span><span class=s1>&#39;horse race&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>88</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>,</span> <span class=s1>&#39;h&#39;</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=s1>&#39;s&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p><code>sorted</code>函数可以接受和<code>sort</code>相同的参数。</p><h2 id=3113-zip函数>3.1.13 zip函数
<a class=header-anchor href=#3113-zip%e5%87%bd%e6%95%b0></a></h2><p><code>zip</code>可以将多个列表、元组或其它序列成对组合成一个元组列表：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1>1</a>
</span><span class=lnt id=hl-41-2><a class=lnlinks href=#hl-41-2>2</a>
</span><span class=lnt id=hl-41-3><a class=lnlinks href=#hl-41-3>3</a>
</span><span class=lnt id=hl-41-4><a class=lnlinks href=#hl-41-4>4</a>
</span><span class=lnt id=hl-41-5><a class=lnlinks href=#hl-41-5>5</a>
</span><span class=lnt id=hl-41-6><a class=lnlinks href=#hl-41-6>6</a>
</span><span class=lnt id=hl-41-7><a class=lnlinks href=#hl-41-7>7</a>
</span><span class=lnt id=hl-41-8><a class=lnlinks href=#hl-41-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>89</span><span class=p>]:</span> <span class=n>seq1</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;baz&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>90</span><span class=p>]:</span> <span class=n>seq2</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=s1>&#39;three&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>91</span><span class=p>]:</span> <span class=n>zipped</span> <span class=o>=</span> <span class=nb>zip</span><span class=p>(</span><span class=n>seq1</span><span class=p>,</span> <span class=n>seq2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>92</span><span class=p>]:</span> <span class=nb>list</span><span class=p>(</span><span class=n>zipped</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>92</span><span class=p>]:</span> <span class=p>[(</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;one&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;baz&#39;</span><span class=p>,</span> <span class=s1>&#39;three&#39;</span><span class=p>)]</span></span></span></code></pre></td></tr></table></div></div><p><code>zip</code>可以处理任意多的序列，元素的个数取决于最短的序列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1>1</a>
</span><span class=lnt id=hl-42-2><a class=lnlinks href=#hl-42-2>2</a>
</span><span class=lnt id=hl-42-3><a class=lnlinks href=#hl-42-3>3</a>
</span><span class=lnt id=hl-42-4><a class=lnlinks href=#hl-42-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>93</span><span class=p>]:</span> <span class=n>seq3</span> <span class=o>=</span> <span class=p>[</span><span class=kc>False</span><span class=p>,</span> <span class=kc>True</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>94</span><span class=p>]:</span> <span class=nb>list</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>seq1</span><span class=p>,</span> <span class=n>seq2</span><span class=p>,</span> <span class=n>seq3</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>94</span><span class=p>]:</span> <span class=p>[(</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;one&#39;</span><span class=p>,</span> <span class=kc>False</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;two&#39;</span><span class=p>,</span> <span class=kc>True</span><span class=p>)]</span></span></span></code></pre></td></tr></table></div></div><p><code>zip</code>的常见用法之一是同时迭代多个序列，可能结合<code>enumerate</code>使用：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1>1</a>
</span><span class=lnt id=hl-43-2><a class=lnlinks href=#hl-43-2>2</a>
</span><span class=lnt id=hl-43-3><a class=lnlinks href=#hl-43-3>3</a>
</span><span class=lnt id=hl-43-4><a class=lnlinks href=#hl-43-4>4</a>
</span><span class=lnt id=hl-43-5><a class=lnlinks href=#hl-43-5>5</a>
</span><span class=lnt id=hl-43-6><a class=lnlinks href=#hl-43-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>95</span><span class=p>]:</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>seq1</span><span class=p>,</span> <span class=n>seq2</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>     <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{0}</span><span class=s1>: </span><span class=si>{1}</span><span class=s1>, </span><span class=si>{2}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=mi>0</span><span class=p>:</span> <span class=n>foo</span><span class=p>,</span> <span class=n>one</span>
</span></span><span class=line><span class=cl><span class=mi>1</span><span class=p>:</span> <span class=n>bar</span><span class=p>,</span> <span class=n>two</span>
</span></span><span class=line><span class=cl><span class=mi>2</span><span class=p>:</span> <span class=n>baz</span><span class=p>,</span> <span class=n>three</span></span></span></code></pre></td></tr></table></div></div><p>给出一个“被压缩的”序列，<code>zip</code>可以被用来解压序列。也可以当作把行的列表转换为列的列表。这个方法看起来有点神奇：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1> 1</a>
</span><span class=lnt id=hl-44-2><a class=lnlinks href=#hl-44-2> 2</a>
</span><span class=lnt id=hl-44-3><a class=lnlinks href=#hl-44-3> 3</a>
</span><span class=lnt id=hl-44-4><a class=lnlinks href=#hl-44-4> 4</a>
</span><span class=lnt id=hl-44-5><a class=lnlinks href=#hl-44-5> 5</a>
</span><span class=lnt id=hl-44-6><a class=lnlinks href=#hl-44-6> 6</a>
</span><span class=lnt id=hl-44-7><a class=lnlinks href=#hl-44-7> 7</a>
</span><span class=lnt id=hl-44-8><a class=lnlinks href=#hl-44-8> 8</a>
</span><span class=lnt id=hl-44-9><a class=lnlinks href=#hl-44-9> 9</a>
</span><span class=lnt id=hl-44-10><a class=lnlinks href=#hl-44-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>96</span><span class=p>]:</span> <span class=n>pitchers</span> <span class=o>=</span> <span class=p>[(</span><span class=s1>&#39;Nolan&#39;</span><span class=p>,</span> <span class=s1>&#39;Ryan&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Roger&#39;</span><span class=p>,</span> <span class=s1>&#39;Clemens&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>   <span class=o>....</span><span class=p>:</span>             <span class=p>(</span><span class=s1>&#39;Schilling&#39;</span><span class=p>,</span> <span class=s1>&#39;Curt&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>97</span><span class=p>]:</span> <span class=n>first_names</span><span class=p>,</span> <span class=n>last_names</span> <span class=o>=</span> <span class=nb>zip</span><span class=p>(</span><span class=o>*</span><span class=n>pitchers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>98</span><span class=p>]:</span> <span class=n>first_names</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>98</span><span class=p>]:</span> <span class=p>(</span><span class=s1>&#39;Nolan&#39;</span><span class=p>,</span> <span class=s1>&#39;Roger&#39;</span><span class=p>,</span> <span class=s1>&#39;Schilling&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>99</span><span class=p>]:</span> <span class=n>last_names</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>99</span><span class=p>]:</span> <span class=p>(</span><span class=s1>&#39;Ryan&#39;</span><span class=p>,</span> <span class=s1>&#39;Clemens&#39;</span><span class=p>,</span> <span class=s1>&#39;Curt&#39;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h2 id=3114-reversed函数>3.1.14 reversed函数
<a class=header-anchor href=#3114-reversed%e5%87%bd%e6%95%b0></a></h2><p><code>reversed</code>可以从后向前迭代一个序列：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1>1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>100</span><span class=p>]:</span> <span class=nb>list</span><span class=p>(</span><span class=nb>reversed</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>100</span><span class=p>]:</span> <span class=p>[</span><span class=mi>9</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>要记住<code>reversed</code>是一个生成器（后面详细介绍），只有实体化（即列表或for循环）之后才能创建<strong>翻转</strong>的序列。</p><h2 id=3115-字典>3.1.15 字典
<a class=header-anchor href=#3115-%e5%ad%97%e5%85%b8></a></h2><p>字典可能是Python最为重要的数据结构。它更为常见的名字是哈希映射或关联数组。它是键值对的大小可变集合，键和值都是Python对象。创建字典的方法之一是使用尖括号，用冒号分隔键和值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-46-1><a class=lnlinks href=#hl-46-1>1</a>
</span><span class=lnt id=hl-46-2><a class=lnlinks href=#hl-46-2>2</a>
</span><span class=lnt id=hl-46-3><a class=lnlinks href=#hl-46-3>3</a>
</span><span class=lnt id=hl-46-4><a class=lnlinks href=#hl-46-4>4</a>
</span><span class=lnt id=hl-46-5><a class=lnlinks href=#hl-46-5>5</a>
</span><span class=lnt id=hl-46-6><a class=lnlinks href=#hl-46-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>101</span><span class=p>]:</span> <span class=n>empty_dict</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>102</span><span class=p>]:</span> <span class=n>d1</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span> <span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span> <span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>103</span><span class=p>]:</span> <span class=n>d1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>103</span><span class=p>]:</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]}</span></span></span></code></pre></td></tr></table></div></div><p>你可以像访问列表或元组中的元素一样，访问、插入或设定字典中的元素：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1>1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2>2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3>3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4>4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5>5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6>6</a>
</span><span class=lnt id=hl-47-7><a class=lnlinks href=#hl-47-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>104</span><span class=p>]:</span> <span class=n>d1</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;an integer&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>105</span><span class=p>]:</span> <span class=n>d1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>105</span><span class=p>]:</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=mi>7</span><span class=p>:</span> <span class=s1>&#39;an integer&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>106</span><span class=p>]:</span> <span class=n>d1</span><span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>106</span><span class=p>]:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>你可以用检查列表和元组是否包含某个值的方法，检查字典中是否包含某个键：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1>1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>107</span><span class=p>]:</span> <span class=s1>&#39;b&#39;</span> <span class=ow>in</span> <span class=n>d1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>107</span><span class=p>]:</span> <span class=kc>True</span></span></span></code></pre></td></tr></table></div></div><p>可以用<code>del</code>关键字或<code>pop</code>方法（返回值的同时删除键）删除值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1> 1</a>
</span><span class=lnt id=hl-49-2><a class=lnlinks href=#hl-49-2> 2</a>
</span><span class=lnt id=hl-49-3><a class=lnlinks href=#hl-49-3> 3</a>
</span><span class=lnt id=hl-49-4><a class=lnlinks href=#hl-49-4> 4</a>
</span><span class=lnt id=hl-49-5><a class=lnlinks href=#hl-49-5> 5</a>
</span><span class=lnt id=hl-49-6><a class=lnlinks href=#hl-49-6> 6</a>
</span><span class=lnt id=hl-49-7><a class=lnlinks href=#hl-49-7> 7</a>
</span><span class=lnt id=hl-49-8><a class=lnlinks href=#hl-49-8> 8</a>
</span><span class=lnt id=hl-49-9><a class=lnlinks href=#hl-49-9> 9</a>
</span><span class=lnt id=hl-49-10><a class=lnlinks href=#hl-49-10>10</a>
</span><span class=lnt id=hl-49-11><a class=lnlinks href=#hl-49-11>11</a>
</span><span class=lnt id=hl-49-12><a class=lnlinks href=#hl-49-12>12</a>
</span><span class=lnt id=hl-49-13><a class=lnlinks href=#hl-49-13>13</a>
</span><span class=lnt id=hl-49-14><a class=lnlinks href=#hl-49-14>14</a>
</span><span class=lnt id=hl-49-15><a class=lnlinks href=#hl-49-15>15</a>
</span><span class=lnt id=hl-49-16><a class=lnlinks href=#hl-49-16>16</a>
</span><span class=lnt id=hl-49-17><a class=lnlinks href=#hl-49-17>17</a>
</span><span class=lnt id=hl-49-18><a class=lnlinks href=#hl-49-18>18</a>
</span><span class=lnt id=hl-49-19><a class=lnlinks href=#hl-49-19>19</a>
</span><span class=lnt id=hl-49-20><a class=lnlinks href=#hl-49-20>20</a>
</span><span class=lnt id=hl-49-21><a class=lnlinks href=#hl-49-21>21</a>
</span><span class=lnt id=hl-49-22><a class=lnlinks href=#hl-49-22>22</a>
</span><span class=lnt id=hl-49-23><a class=lnlinks href=#hl-49-23>23</a>
</span><span class=lnt id=hl-49-24><a class=lnlinks href=#hl-49-24>24</a>
</span><span class=lnt id=hl-49-25><a class=lnlinks href=#hl-49-25>25</a>
</span><span class=lnt id=hl-49-26><a class=lnlinks href=#hl-49-26>26</a>
</span><span class=lnt id=hl-49-27><a class=lnlinks href=#hl-49-27>27</a>
</span><span class=lnt id=hl-49-28><a class=lnlinks href=#hl-49-28>28</a>
</span><span class=lnt id=hl-49-29><a class=lnlinks href=#hl-49-29>29</a>
</span><span class=lnt id=hl-49-30><a class=lnlinks href=#hl-49-30>30</a>
</span><span class=lnt id=hl-49-31><a class=lnlinks href=#hl-49-31>31</a>
</span><span class=lnt id=hl-49-32><a class=lnlinks href=#hl-49-32>32</a>
</span><span class=lnt id=hl-49-33><a class=lnlinks href=#hl-49-33>33</a>
</span><span class=lnt id=hl-49-34><a class=lnlinks href=#hl-49-34>34</a>
</span><span class=lnt id=hl-49-35><a class=lnlinks href=#hl-49-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>108</span><span class=p>]:</span> <span class=n>d1</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;some value&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>109</span><span class=p>]:</span> <span class=n>d1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>109</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
</span></span><span class=line><span class=cl> <span class=mi>7</span><span class=p>:</span> <span class=s1>&#39;an integer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=mi>5</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>110</span><span class=p>]:</span> <span class=n>d1</span><span class=p>[</span><span class=s1>&#39;dummy&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;another value&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>111</span><span class=p>]:</span> <span class=n>d1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>111</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
</span></span><span class=line><span class=cl> <span class=mi>7</span><span class=p>:</span> <span class=s1>&#39;an integer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=mi>5</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;dummy&#39;</span><span class=p>:</span> <span class=s1>&#39;another value&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>112</span><span class=p>]:</span> <span class=k>del</span> <span class=n>d1</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>113</span><span class=p>]:</span> <span class=n>d1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>113</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
</span></span><span class=line><span class=cl> <span class=mi>7</span><span class=p>:</span> <span class=s1>&#39;an integer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;dummy&#39;</span><span class=p>:</span> <span class=s1>&#39;another value&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>114</span><span class=p>]:</span> <span class=n>ret</span> <span class=o>=</span> <span class=n>d1</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s1>&#39;dummy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>115</span><span class=p>]:</span> <span class=n>ret</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>115</span><span class=p>]:</span> <span class=s1>&#39;another value&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>116</span><span class=p>]:</span> <span class=n>d1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>116</span><span class=p>]:</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=mi>7</span><span class=p>:</span> <span class=s1>&#39;an integer&#39;</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p><code>keys</code>和<code>values</code>是字典的键和值的迭代器方法。虽然键值对没有顺序，这两个方法可以用相同的顺序输出键和值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-50-1><a class=lnlinks href=#hl-50-1>1</a>
</span><span class=lnt id=hl-50-2><a class=lnlinks href=#hl-50-2>2</a>
</span><span class=lnt id=hl-50-3><a class=lnlinks href=#hl-50-3>3</a>
</span><span class=lnt id=hl-50-4><a class=lnlinks href=#hl-50-4>4</a>
</span><span class=lnt id=hl-50-5><a class=lnlinks href=#hl-50-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>117</span><span class=p>]:</span> <span class=nb>list</span><span class=p>(</span><span class=n>d1</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>117</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>118</span><span class=p>]:</span> <span class=nb>list</span><span class=p>(</span><span class=n>d1</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>118</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;some value&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=s1>&#39;an integer&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>用<code>update</code>方法可以将一个字典与另一个融合：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-51-1><a class=lnlinks href=#hl-51-1>1</a>
</span><span class=lnt id=hl-51-2><a class=lnlinks href=#hl-51-2>2</a>
</span><span class=lnt id=hl-51-3><a class=lnlinks href=#hl-51-3>3</a>
</span><span class=lnt id=hl-51-4><a class=lnlinks href=#hl-51-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>119</span><span class=p>]:</span> <span class=n>d1</span><span class=o>.</span><span class=n>update</span><span class=p>({</span><span class=s1>&#39;b&#39;</span> <span class=p>:</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span> <span class=p>:</span> <span class=mi>12</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>120</span><span class=p>]:</span> <span class=n>d1</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>120</span><span class=p>]:</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;some value&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=mi>7</span><span class=p>:</span> <span class=s1>&#39;an integer&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>:</span> <span class=mi>12</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p><code>update</code>方法是原地改变字典，因此任何传递给<code>update</code>的键的旧的值都会被舍弃。</p><h2 id=3116-用序列创建字典>3.1.16 用序列创建字典
<a class=header-anchor href=#3116-%e7%94%a8%e5%ba%8f%e5%88%97%e5%88%9b%e5%bb%ba%e5%ad%97%e5%85%b8></a></h2><p>常常，你可能想将两个序列配对组合成字典。下面是一种写法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-52-1><a class=lnlinks href=#hl-52-1>1</a>
</span><span class=lnt id=hl-52-2><a class=lnlinks href=#hl-52-2>2</a>
</span><span class=lnt id=hl-52-3><a class=lnlinks href=#hl-52-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>mapping</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>key_list</span><span class=p>,</span> <span class=n>value_list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>mapping</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span></span></span></code></pre></td></tr></table></div></div><p>因为字典本质上是2元元组的集合，dict可以接受2元元组的列表：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-53-1><a class=lnlinks href=#hl-53-1>1</a>
</span><span class=lnt id=hl-53-2><a class=lnlinks href=#hl-53-2>2</a>
</span><span class=lnt id=hl-53-3><a class=lnlinks href=#hl-53-3>3</a>
</span><span class=lnt id=hl-53-4><a class=lnlinks href=#hl-53-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>121</span><span class=p>]:</span> <span class=n>mapping</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>),</span> <span class=nb>reversed</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>122</span><span class=p>]:</span> <span class=n>mapping</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>122</span><span class=p>]:</span> <span class=p>{</span><span class=mi>0</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>:</span> <span class=mi>0</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>后面会谈到<code>dict comprehensions</code>，另一种构建字典的优雅方式。</p><h2 id=3117-默认值>3.1.17 默认值
<a class=header-anchor href=#3117-%e9%bb%98%e8%ae%a4%e5%80%bc></a></h2><p>下面的逻辑很常见：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-54-1><a class=lnlinks href=#hl-54-1>1</a>
</span><span class=lnt id=hl-54-2><a class=lnlinks href=#hl-54-2>2</a>
</span><span class=lnt id=hl-54-3><a class=lnlinks href=#hl-54-3>3</a>
</span><span class=lnt id=hl-54-4><a class=lnlinks href=#hl-54-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>some_dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>value</span> <span class=o>=</span> <span class=n>some_dict</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>value</span> <span class=o>=</span> <span class=n>default_value</span></span></span></code></pre></td></tr></table></div></div><p>因此，dict的方法get和pop可以取默认值进行返回，上面的if-else语句可以简写成下面：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-55-1><a class=lnlinks href=#hl-55-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>value</span> <span class=o>=</span> <span class=n>some_dict</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>default_value</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>get默认会返回None，如果不存在键，pop会抛出一个例外。关于设定值，常见的情况是在字典的值是属于其它集合，如列表。例如，你可以通过首字母，将一个列表中的单词分类：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-56-1><a class=lnlinks href=#hl-56-1> 1</a>
</span><span class=lnt id=hl-56-2><a class=lnlinks href=#hl-56-2> 2</a>
</span><span class=lnt id=hl-56-3><a class=lnlinks href=#hl-56-3> 3</a>
</span><span class=lnt id=hl-56-4><a class=lnlinks href=#hl-56-4> 4</a>
</span><span class=lnt id=hl-56-5><a class=lnlinks href=#hl-56-5> 5</a>
</span><span class=lnt id=hl-56-6><a class=lnlinks href=#hl-56-6> 6</a>
</span><span class=lnt id=hl-56-7><a class=lnlinks href=#hl-56-7> 7</a>
</span><span class=lnt id=hl-56-8><a class=lnlinks href=#hl-56-8> 8</a>
</span><span class=lnt id=hl-56-9><a class=lnlinks href=#hl-56-9> 9</a>
</span><span class=lnt id=hl-56-10><a class=lnlinks href=#hl-56-10>10</a>
</span><span class=lnt id=hl-56-11><a class=lnlinks href=#hl-56-11>11</a>
</span><span class=lnt id=hl-56-12><a class=lnlinks href=#hl-56-12>12</a>
</span><span class=lnt id=hl-56-13><a class=lnlinks href=#hl-56-13>13</a>
</span><span class=lnt id=hl-56-14><a class=lnlinks href=#hl-56-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>123</span><span class=p>]:</span> <span class=n>words</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;apple&#39;</span><span class=p>,</span> <span class=s1>&#39;bat&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;atom&#39;</span><span class=p>,</span> <span class=s1>&#39;book&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>124</span><span class=p>]:</span> <span class=n>by_letter</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>125</span><span class=p>]:</span> <span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>words</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=n>letter</span> <span class=o>=</span> <span class=n>word</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=k>if</span> <span class=n>letter</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>by_letter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>         <span class=n>by_letter</span><span class=p>[</span><span class=n>letter</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>word</span><span class=p>]</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>         <span class=n>by_letter</span><span class=p>[</span><span class=n>letter</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>word</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>126</span><span class=p>]:</span> <span class=n>by_letter</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>126</span><span class=p>]:</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;apple&#39;</span><span class=p>,</span> <span class=s1>&#39;atom&#39;</span><span class=p>],</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;bat&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;book&#39;</span><span class=p>]}</span></span></span></code></pre></td></tr></table></div></div><p><code>setdefault</code>方法就正是干这个的。前面的for循环可以改写为：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-57-1><a class=lnlinks href=#hl-57-1>1</a>
</span><span class=lnt id=hl-57-2><a class=lnlinks href=#hl-57-2>2</a>
</span><span class=lnt id=hl-57-3><a class=lnlinks href=#hl-57-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>words</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>letter</span> <span class=o>=</span> <span class=n>word</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>by_letter</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>letter</span><span class=p>,</span> <span class=p>[])</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>word</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><code>collections</code>模块有一个很有用的类，<code>defaultdict</code>，它可以进一步简化上面。传递类型或函数以生成每个位置的默认值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1>1</a>
</span><span class=lnt id=hl-58-2><a class=lnlinks href=#hl-58-2>2</a>
</span><span class=lnt id=hl-58-3><a class=lnlinks href=#hl-58-3>3</a>
</span><span class=lnt id=hl-58-4><a class=lnlinks href=#hl-58-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
</span></span><span class=line><span class=cl><span class=n>by_letter</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>words</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>by_letter</span><span class=p>[</span><span class=n>word</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>word</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h2 id=3118-有效的键类型>3.1.18 有效的键类型
<a class=header-anchor href=#3118-%e6%9c%89%e6%95%88%e7%9a%84%e9%94%ae%e7%b1%bb%e5%9e%8b></a></h2><p>字典的值可以是任意Python对象，而键通常是不可变的标量类型（整数、浮点型、字符串）或元组（元组中的对象必须是不可变的）。这被称为“可哈希性”。可以用<code>hash</code>函数检测一个对象是否是可哈希的（可被用作字典的键）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-59-1><a class=lnlinks href=#hl-59-1> 1</a>
</span><span class=lnt id=hl-59-2><a class=lnlinks href=#hl-59-2> 2</a>
</span><span class=lnt id=hl-59-3><a class=lnlinks href=#hl-59-3> 3</a>
</span><span class=lnt id=hl-59-4><a class=lnlinks href=#hl-59-4> 4</a>
</span><span class=lnt id=hl-59-5><a class=lnlinks href=#hl-59-5> 5</a>
</span><span class=lnt id=hl-59-6><a class=lnlinks href=#hl-59-6> 6</a>
</span><span class=lnt id=hl-59-7><a class=lnlinks href=#hl-59-7> 7</a>
</span><span class=lnt id=hl-59-8><a class=lnlinks href=#hl-59-8> 8</a>
</span><span class=lnt id=hl-59-9><a class=lnlinks href=#hl-59-9> 9</a>
</span><span class=lnt id=hl-59-10><a class=lnlinks href=#hl-59-10>10</a>
</span><span class=lnt id=hl-59-11><a class=lnlinks href=#hl-59-11>11</a>
</span><span class=lnt id=hl-59-12><a class=lnlinks href=#hl-59-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>127</span><span class=p>]:</span> <span class=nb>hash</span><span class=p>(</span><span class=s1>&#39;string&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>127</span><span class=p>]:</span> <span class=mi>5023931463650008331</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>128</span><span class=p>]:</span> <span class=nb>hash</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>128</span><span class=p>]:</span> <span class=mi>1097636502276347782</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>129</span><span class=p>]:</span> <span class=nb>hash</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]))</span> <span class=c1># fails because lists are mutable</span>
</span></span><span class=line><span class=cl><span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span>                                 <span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ipython</span><span class=o>-</span><span class=nb>input</span><span class=o>-</span><span class=mi>129</span><span class=o>-</span><span class=mi>800</span><span class=n>cd14ba8be</span><span class=o>&gt;</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>1</span> <span class=nb>hash</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]))</span> <span class=c1># fails because lists are mutable</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span><span class=p>:</span> <span class=n>unhashable</span> <span class=nb>type</span><span class=p>:</span> <span class=s1>&#39;list&#39;</span></span></span></code></pre></td></tr></table></div></div><p>要用列表当做键，一种方法是将列表转化为元组，只要内部元素可以被哈希，它也就可以被哈希：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-60-1><a class=lnlinks href=#hl-60-1>1</a>
</span><span class=lnt id=hl-60-2><a class=lnlinks href=#hl-60-2>2</a>
</span><span class=lnt id=hl-60-3><a class=lnlinks href=#hl-60-3>3</a>
</span><span class=lnt id=hl-60-4><a class=lnlinks href=#hl-60-4>4</a>
</span><span class=lnt id=hl-60-5><a class=lnlinks href=#hl-60-5>5</a>
</span><span class=lnt id=hl-60-6><a class=lnlinks href=#hl-60-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>130</span><span class=p>]:</span> <span class=n>d</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>131</span><span class=p>]:</span> <span class=n>d</span><span class=p>[</span><span class=nb>tuple</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])]</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>132</span><span class=p>]:</span> <span class=n>d</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>132</span><span class=p>]:</span> <span class=p>{(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>):</span> <span class=mi>5</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h2 id=3119-集合>3.1.19 集合
<a class=header-anchor href=#3119-%e9%9b%86%e5%90%88></a></h2><p>集合是无序的不可重复的元素的集合。你可以把它当做字典，但是只有键没有值。可以用两种方式创建集合：通过set函数或使用尖括号set语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-61-1><a class=lnlinks href=#hl-61-1>1</a>
</span><span class=lnt id=hl-61-2><a class=lnlinks href=#hl-61-2>2</a>
</span><span class=lnt id=hl-61-3><a class=lnlinks href=#hl-61-3>3</a>
</span><span class=lnt id=hl-61-4><a class=lnlinks href=#hl-61-4>4</a>
</span><span class=lnt id=hl-61-5><a class=lnlinks href=#hl-61-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>133</span><span class=p>]:</span> <span class=nb>set</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>133</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>134</span><span class=p>]:</span> <span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>134</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>集合支持合并、交集、差分和对称差等数学集合运算。考虑两个示例集合：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-62-1><a class=lnlinks href=#hl-62-1>1</a>
</span><span class=lnt id=hl-62-2><a class=lnlinks href=#hl-62-2>2</a>
</span><span class=lnt id=hl-62-3><a class=lnlinks href=#hl-62-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>135</span><span class=p>]:</span> <span class=n>a</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>136</span><span class=p>]:</span> <span class=n>b</span> <span class=o>=</span> <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>合并是取两个集合中不重复的元素。可以用<code>union</code>方法，或者<code>|</code>运算符：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-63-1><a class=lnlinks href=#hl-63-1>1</a>
</span><span class=lnt id=hl-63-2><a class=lnlinks href=#hl-63-2>2</a>
</span><span class=lnt id=hl-63-3><a class=lnlinks href=#hl-63-3>3</a>
</span><span class=lnt id=hl-63-4><a class=lnlinks href=#hl-63-4>4</a>
</span><span class=lnt id=hl-63-5><a class=lnlinks href=#hl-63-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>137</span><span class=p>]:</span> <span class=n>a</span><span class=o>.</span><span class=n>union</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>137</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>138</span><span class=p>]:</span> <span class=n>a</span> <span class=o>|</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>138</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>交集的元素包含在两个集合中。可以用<code>intersection</code>或<code>&</code>运算符：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-64-1><a class=lnlinks href=#hl-64-1>1</a>
</span><span class=lnt id=hl-64-2><a class=lnlinks href=#hl-64-2>2</a>
</span><span class=lnt id=hl-64-3><a class=lnlinks href=#hl-64-3>3</a>
</span><span class=lnt id=hl-64-4><a class=lnlinks href=#hl-64-4>4</a>
</span><span class=lnt id=hl-64-5><a class=lnlinks href=#hl-64-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>139</span><span class=p>]:</span> <span class=n>a</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>139</span><span class=p>]:</span> <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>140</span><span class=p>]:</span> <span class=n>a</span> <span class=o>&amp;</span> <span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>140</span><span class=p>]:</span> <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>表3-1列出了常用的集合方法。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://gitee.com/wugenqiang/images/raw/master/01/1240-20201009182930366.png alt="表3-1 Python的集合操作"></p><p>所有逻辑集合操作都有另外的原地实现方法，可以直接用结果替代集合的内容。对于大的集合，这么做效率更高：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-65-1><a class=lnlinks href=#hl-65-1> 1</a>
</span><span class=lnt id=hl-65-2><a class=lnlinks href=#hl-65-2> 2</a>
</span><span class=lnt id=hl-65-3><a class=lnlinks href=#hl-65-3> 3</a>
</span><span class=lnt id=hl-65-4><a class=lnlinks href=#hl-65-4> 4</a>
</span><span class=lnt id=hl-65-5><a class=lnlinks href=#hl-65-5> 5</a>
</span><span class=lnt id=hl-65-6><a class=lnlinks href=#hl-65-6> 6</a>
</span><span class=lnt id=hl-65-7><a class=lnlinks href=#hl-65-7> 7</a>
</span><span class=lnt id=hl-65-8><a class=lnlinks href=#hl-65-8> 8</a>
</span><span class=lnt id=hl-65-9><a class=lnlinks href=#hl-65-9> 9</a>
</span><span class=lnt id=hl-65-10><a class=lnlinks href=#hl-65-10>10</a>
</span><span class=lnt id=hl-65-11><a class=lnlinks href=#hl-65-11>11</a>
</span><span class=lnt id=hl-65-12><a class=lnlinks href=#hl-65-12>12</a>
</span><span class=lnt id=hl-65-13><a class=lnlinks href=#hl-65-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>141</span><span class=p>]:</span> <span class=n>c</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>142</span><span class=p>]:</span> <span class=n>c</span> <span class=o>|=</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>143</span><span class=p>]:</span> <span class=n>c</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>143</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>144</span><span class=p>]:</span> <span class=n>d</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>145</span><span class=p>]:</span> <span class=n>d</span> <span class=o>&amp;=</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>146</span><span class=p>]:</span> <span class=n>d</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>146</span><span class=p>]:</span> <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>与字典类似，集合元素通常都是不可变的。要获得类似列表的元素，必须转换成元组：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-66-1><a class=lnlinks href=#hl-66-1>1</a>
</span><span class=lnt id=hl-66-2><a class=lnlinks href=#hl-66-2>2</a>
</span><span class=lnt id=hl-66-3><a class=lnlinks href=#hl-66-3>3</a>
</span><span class=lnt id=hl-66-4><a class=lnlinks href=#hl-66-4>4</a>
</span><span class=lnt id=hl-66-5><a class=lnlinks href=#hl-66-5>5</a>
</span><span class=lnt id=hl-66-6><a class=lnlinks href=#hl-66-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>147</span><span class=p>]:</span> <span class=n>my_data</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>148</span><span class=p>]:</span> <span class=n>my_set</span> <span class=o>=</span> <span class=p>{</span><span class=nb>tuple</span><span class=p>(</span><span class=n>my_data</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>149</span><span class=p>]:</span> <span class=n>my_set</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>149</span><span class=p>]:</span> <span class=p>{(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>)}</span></span></span></code></pre></td></tr></table></div></div><p>你还可以检测一个集合是否是另一个集合的子集或父集：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-67-1><a class=lnlinks href=#hl-67-1>1</a>
</span><span class=lnt id=hl-67-2><a class=lnlinks href=#hl-67-2>2</a>
</span><span class=lnt id=hl-67-3><a class=lnlinks href=#hl-67-3>3</a>
</span><span class=lnt id=hl-67-4><a class=lnlinks href=#hl-67-4>4</a>
</span><span class=lnt id=hl-67-5><a class=lnlinks href=#hl-67-5>5</a>
</span><span class=lnt id=hl-67-6><a class=lnlinks href=#hl-67-6>6</a>
</span><span class=lnt id=hl-67-7><a class=lnlinks href=#hl-67-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>150</span><span class=p>]:</span> <span class=n>a_set</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>151</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span><span class=o>.</span><span class=n>issubset</span><span class=p>(</span><span class=n>a_set</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>151</span><span class=p>]:</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>152</span><span class=p>]:</span> <span class=n>a_set</span><span class=o>.</span><span class=n>issuperset</span><span class=p>({</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>152</span><span class=p>]:</span> <span class=kc>True</span></span></span></code></pre></td></tr></table></div></div><p>集合的内容相同时，集合才对等：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-68-1><a class=lnlinks href=#hl-68-1>1</a>
</span><span class=lnt id=hl-68-2><a class=lnlinks href=#hl-68-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>153</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>}</span> <span class=o>==</span> <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>153</span><span class=p>]:</span> <span class=kc>True</span></span></span></code></pre></td></tr></table></div></div><h2 id=3120-列表集合和字典推导式>3.1.20 列表、集合和字典推导式
<a class=header-anchor href=#3120-%e5%88%97%e8%a1%a8%e9%9b%86%e5%90%88%e5%92%8c%e5%ad%97%e5%85%b8%e6%8e%a8%e5%af%bc%e5%bc%8f></a></h2><p>列表推导式是Python最受喜爱的特性之一。它允许用户方便的从一个集合过滤元素，形成列表，在传递参数的过程中还可以修改元素。形式如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-69-1><a class=lnlinks href=#hl-69-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[</span><span class=n>expr</span> <span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>collection</span> <span class=k>if</span> <span class=n>condition</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>它等同于下面的for循环;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-70-1><a class=lnlinks href=#hl-70-1>1</a>
</span><span class=lnt id=hl-70-2><a class=lnlinks href=#hl-70-2>2</a>
</span><span class=lnt id=hl-70-3><a class=lnlinks href=#hl-70-3>3</a>
</span><span class=lnt id=hl-70-4><a class=lnlinks href=#hl-70-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>collection</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>condition</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>filter条件可以被忽略，只留下表达式就行。例如，给定一个字符串列表，我们可以过滤出长度在2及以下的字符串，并将其转换成大写：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-71-1><a class=lnlinks href=#hl-71-1>1</a>
</span><span class=lnt id=hl-71-2><a class=lnlinks href=#hl-71-2>2</a>
</span><span class=lnt id=hl-71-3><a class=lnlinks href=#hl-71-3>3</a>
</span><span class=lnt id=hl-71-4><a class=lnlinks href=#hl-71-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>154</span><span class=p>]:</span> <span class=n>strings</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;as&#39;</span><span class=p>,</span> <span class=s1>&#39;bat&#39;</span><span class=p>,</span> <span class=s1>&#39;car&#39;</span><span class=p>,</span> <span class=s1>&#39;dove&#39;</span><span class=p>,</span> <span class=s1>&#39;python&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>155</span><span class=p>]:</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>strings</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>155</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;BAT&#39;</span><span class=p>,</span> <span class=s1>&#39;CAR&#39;</span><span class=p>,</span> <span class=s1>&#39;DOVE&#39;</span><span class=p>,</span> <span class=s1>&#39;PYTHON&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>用相似的方法，还可以推导集合和字典。字典的推导式如下所示：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-72-1><a class=lnlinks href=#hl-72-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>dict_comp</span> <span class=o>=</span> <span class=p>{</span><span class=n>key</span><span class=o>-</span><span class=n>expr</span> <span class=p>:</span> <span class=n>value</span><span class=o>-</span><span class=n>expr</span> <span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>collection</span> <span class=k>if</span> <span class=n>condition</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>集合的推导式与列表很像，只不过用的是尖括号：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-73-1><a class=lnlinks href=#hl-73-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>set_comp</span> <span class=o>=</span> <span class=p>{</span><span class=n>expr</span> <span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>collection</span> <span class=k>if</span> <span class=n>condition</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>与列表推导式类似，集合与字典的推导也很方便，而且使代码的读写都很容易。来看前面的字符串列表。假如我们只想要字符串的长度，用集合推导式的方法非常方便：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-74-1><a class=lnlinks href=#hl-74-1>1</a>
</span><span class=lnt id=hl-74-2><a class=lnlinks href=#hl-74-2>2</a>
</span><span class=lnt id=hl-74-3><a class=lnlinks href=#hl-74-3>3</a>
</span><span class=lnt id=hl-74-4><a class=lnlinks href=#hl-74-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>156</span><span class=p>]:</span> <span class=n>unique_lengths</span> <span class=o>=</span> <span class=p>{</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>strings</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>157</span><span class=p>]:</span> <span class=n>unique_lengths</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>157</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p><code>map</code>函数可以进一步简化：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-75-1><a class=lnlinks href=#hl-75-1>1</a>
</span><span class=lnt id=hl-75-2><a class=lnlinks href=#hl-75-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>158</span><span class=p>]:</span> <span class=nb>set</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>len</span><span class=p>,</span> <span class=n>strings</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>158</span><span class=p>]:</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>作为一个字典推导式的例子，我们可以创建一个字符串的查找映射表以确定它在列表中的位置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-76-1><a class=lnlinks href=#hl-76-1>1</a>
</span><span class=lnt id=hl-76-2><a class=lnlinks href=#hl-76-2>2</a>
</span><span class=lnt id=hl-76-3><a class=lnlinks href=#hl-76-3>3</a>
</span><span class=lnt id=hl-76-4><a class=lnlinks href=#hl-76-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>159</span><span class=p>]:</span> <span class=n>loc_mapping</span> <span class=o>=</span> <span class=p>{</span><span class=n>val</span> <span class=p>:</span> <span class=n>index</span> <span class=k>for</span> <span class=n>index</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>strings</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>160</span><span class=p>]:</span> <span class=n>loc_mapping</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>160</span><span class=p>]:</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;as&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;bat&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;car&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;dove&#39;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;python&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h2 id=3121-嵌套列表推导式>3.1.21 嵌套列表推导式
<a class=header-anchor href=#3121-%e5%b5%8c%e5%a5%97%e5%88%97%e8%a1%a8%e6%8e%a8%e5%af%bc%e5%bc%8f></a></h2><p>假设我们有一个包含列表的列表，包含了一些英文名和西班牙名：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-77-1><a class=lnlinks href=#hl-77-1>1</a>
</span><span class=lnt id=hl-77-2><a class=lnlinks href=#hl-77-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>161</span><span class=p>]:</span> <span class=n>all_data</span> <span class=o>=</span> <span class=p>[[</span><span class=s1>&#39;John&#39;</span><span class=p>,</span> <span class=s1>&#39;Emily&#39;</span><span class=p>,</span> <span class=s1>&#39;Michael&#39;</span><span class=p>,</span> <span class=s1>&#39;Mary&#39;</span><span class=p>,</span> <span class=s1>&#39;Steven&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>             <span class=p>[</span><span class=s1>&#39;Maria&#39;</span><span class=p>,</span> <span class=s1>&#39;Juan&#39;</span><span class=p>,</span> <span class=s1>&#39;Javier&#39;</span><span class=p>,</span> <span class=s1>&#39;Natalia&#39;</span><span class=p>,</span> <span class=s1>&#39;Pilar&#39;</span><span class=p>]]</span></span></span></code></pre></td></tr></table></div></div><p>你可能是从一些文件得到的这些名字，然后想按照语言进行分类。现在假设我们想用一个列表包含所有的名字，这些名字中包含两个或更多的e。可以用for循环来做：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-78-1><a class=lnlinks href=#hl-78-1>1</a>
</span><span class=lnt id=hl-78-2><a class=lnlinks href=#hl-78-2>2</a>
</span><span class=lnt id=hl-78-3><a class=lnlinks href=#hl-78-3>3</a>
</span><span class=lnt id=hl-78-4><a class=lnlinks href=#hl-78-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>names_of_interest</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>names</span> <span class=ow>in</span> <span class=n>all_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>enough_es</span> <span class=o>=</span> <span class=p>[</span><span class=n>name</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>names</span> <span class=k>if</span> <span class=n>name</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;e&#39;</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>names_of_interest</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>enough_es</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>可以用嵌套列表推导式的方法，将这些写在一起，如下所示：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-79-1><a class=lnlinks href=#hl-79-1>1</a>
</span><span class=lnt id=hl-79-2><a class=lnlinks href=#hl-79-2>2</a>
</span><span class=lnt id=hl-79-3><a class=lnlinks href=#hl-79-3>3</a>
</span><span class=lnt id=hl-79-4><a class=lnlinks href=#hl-79-4>4</a>
</span><span class=lnt id=hl-79-5><a class=lnlinks href=#hl-79-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>162</span><span class=p>]:</span> <span class=n>result</span> <span class=o>=</span> <span class=p>[</span><span class=n>name</span> <span class=k>for</span> <span class=n>names</span> <span class=ow>in</span> <span class=n>all_data</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>names</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>           <span class=k>if</span> <span class=n>name</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;e&#39;</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>163</span><span class=p>]:</span> <span class=n>result</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>163</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;Steven&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>嵌套列表推导式看起来有些复杂。列表推导式的for部分是根据嵌套的顺序，过滤条件还是放在最后。下面是另一个例子，我们将一个整数元组的列表扁平化成了一个整数列表：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-80-1><a class=lnlinks href=#hl-80-1>1</a>
</span><span class=lnt id=hl-80-2><a class=lnlinks href=#hl-80-2>2</a>
</span><span class=lnt id=hl-80-3><a class=lnlinks href=#hl-80-3>3</a>
</span><span class=lnt id=hl-80-4><a class=lnlinks href=#hl-80-4>4</a>
</span><span class=lnt id=hl-80-5><a class=lnlinks href=#hl-80-5>5</a>
</span><span class=lnt id=hl-80-6><a class=lnlinks href=#hl-80-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>164</span><span class=p>]:</span> <span class=n>some_tuples</span> <span class=o>=</span> <span class=p>[(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>),</span> <span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>165</span><span class=p>]:</span> <span class=n>flattened</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>tup</span> <span class=ow>in</span> <span class=n>some_tuples</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>tup</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>166</span><span class=p>]:</span> <span class=n>flattened</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>166</span><span class=p>]:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>记住，for表达式的顺序是与嵌套for循环的顺序一样（而不是列表推导式的顺序）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-81-1><a class=lnlinks href=#hl-81-1>1</a>
</span><span class=lnt id=hl-81-2><a class=lnlinks href=#hl-81-2>2</a>
</span><span class=lnt id=hl-81-3><a class=lnlinks href=#hl-81-3>3</a>
</span><span class=lnt id=hl-81-4><a class=lnlinks href=#hl-81-4>4</a>
</span><span class=lnt id=hl-81-5><a class=lnlinks href=#hl-81-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>flattened</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>tup</span> <span class=ow>in</span> <span class=n>some_tuples</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>tup</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>flattened</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>你可以有任意多级别的嵌套，但是如果你有两三个以上的嵌套，你就应该考虑下代码可读性的问题了。分辨列表推导式的列表推导式中的语法也是很重要的：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-82-1><a class=lnlinks href=#hl-82-1>1</a>
</span><span class=lnt id=hl-82-2><a class=lnlinks href=#hl-82-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>167</span><span class=p>]:</span> <span class=p>[[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>tup</span><span class=p>]</span> <span class=k>for</span> <span class=n>tup</span> <span class=ow>in</span> <span class=n>some_tuples</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>167</span><span class=p>]:</span> <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>]]</span></span></span></code></pre></td></tr></table></div></div><p>这段代码产生了一个列表的列表，而不是扁平化的只包含元素的列表。</p><h1 id=32-函数>3.2 函数
<a class=header-anchor href=#32-%e5%87%bd%e6%95%b0></a></h1><p>函数是Python中最主要也是最重要的代码组织和复用手段。作为最重要的原则，如果你要重复使用相同或非常类似的代码，就需要写一个函数。通过给函数起一个名字，还可以提高代码的可读性。</p><p>函数使用<code>def</code>关键字声明，用<code>return</code>关键字返回值：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-83-1><a class=lnlinks href=#hl-83-1>1</a>
</span><span class=lnt id=hl-83-2><a class=lnlinks href=#hl-83-2>2</a>
</span><span class=lnt id=hl-83-3><a class=lnlinks href=#hl-83-3>3</a>
</span><span class=lnt id=hl-83-4><a class=lnlinks href=#hl-83-4>4</a>
</span><span class=lnt id=hl-83-5><a class=lnlinks href=#hl-83-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>my_function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=mf>1.5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>z</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>z</span> <span class=o>*</span> <span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>z</span> <span class=o>/</span> <span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>同时拥有多条return语句也是可以的。如果到达函数末尾时没有遇到任何一条return语句，则返回None。</p><p>函数可以有一些位置参数（positional）和一些关键字参数（keyword）。关键字参数通常用于指定默认值或可选参数。在上面的函数中，x和y是位置参数，而z则是关键字参数。也就是说，该函数可以下面这两种方式进行调用：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-84-1><a class=lnlinks href=#hl-84-1>1</a>
</span><span class=lnt id=hl-84-2><a class=lnlinks href=#hl-84-2>2</a>
</span><span class=lnt id=hl-84-3><a class=lnlinks href=#hl-84-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>my_function</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>my_function</span><span class=p>(</span><span class=mf>3.14</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mf>3.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>my_function</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>函数参数的主要限制在于：关键字参数必须位于位置参数（如果有的话）之后。你可以任何顺序指定关键字参数。也就是说，你不用死记硬背函数参数的顺序，只要记得它们的名字就可以了。</p><blockquote><p>笔记：也可以用关键字传递位置参数。前面的例子，也可以写为：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-85-1><a class=lnlinks href=#hl-85-1>1</a>
</span><span class=lnt id=hl-85-2><a class=lnlinks href=#hl-85-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>my_function</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>my_function</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span> <span class=n>x</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>z</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>这种写法可以提高可读性。</p></blockquote><h2 id=321-命名空间作用域和局部函数>3.2.1 命名空间、作用域，和局部函数
<a class=header-anchor href=#321-%e5%91%bd%e5%90%8d%e7%a9%ba%e9%97%b4%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%92%8c%e5%b1%80%e9%83%a8%e5%87%bd%e6%95%b0></a></h2><p>函数可以访问两种不同作用域中的变量：全局（global）和局部（local）。Python有一种更科学的用于描述变量作用域的名称，即命名空间（namespace）。任何在函数中赋值的变量默认都是被分配到局部命名空间（local namespace）中的。局部命名空间是在函数被调用时创建的，函数参数会立即填入该命名空间。在函数执行完毕之后，局部命名空间就会被销毁（会有一些例外的情况，具体请参见后面介绍闭包的那一节）。看看下面这个函数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-86-1><a class=lnlinks href=#hl-86-1>1</a>
</span><span class=lnt id=hl-86-2><a class=lnlinks href=#hl-86-2>2</a>
</span><span class=lnt id=hl-86-3><a class=lnlinks href=#hl-86-3>3</a>
</span><span class=lnt id=hl-86-4><a class=lnlinks href=#hl-86-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>func</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>调用func()之后，首先会创建出空列表a，然后添加5个元素，最后a会在该函数退出的时候被销毁。假如我们像下面这样定义a：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-87-1><a class=lnlinks href=#hl-87-1>1</a>
</span><span class=lnt id=hl-87-2><a class=lnlinks href=#hl-87-2>2</a>
</span><span class=lnt id=hl-87-3><a class=lnlinks href=#hl-87-3>3</a>
</span><span class=lnt id=hl-87-4><a class=lnlinks href=#hl-87-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>func</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>虽然可以在函数中对全局变量进行赋值操作，但是那些变量必须用global关键字声明成全局的才行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-88-1><a class=lnlinks href=#hl-88-1> 1</a>
</span><span class=lnt id=hl-88-2><a class=lnlinks href=#hl-88-2> 2</a>
</span><span class=lnt id=hl-88-3><a class=lnlinks href=#hl-88-3> 3</a>
</span><span class=lnt id=hl-88-4><a class=lnlinks href=#hl-88-4> 4</a>
</span><span class=lnt id=hl-88-5><a class=lnlinks href=#hl-88-5> 5</a>
</span><span class=lnt id=hl-88-6><a class=lnlinks href=#hl-88-6> 6</a>
</span><span class=lnt id=hl-88-7><a class=lnlinks href=#hl-88-7> 7</a>
</span><span class=lnt id=hl-88-8><a class=lnlinks href=#hl-88-8> 8</a>
</span><span class=lnt id=hl-88-9><a class=lnlinks href=#hl-88-9> 9</a>
</span><span class=lnt id=hl-88-10><a class=lnlinks href=#hl-88-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>168</span><span class=p>]:</span> <span class=n>a</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>169</span><span class=p>]:</span> <span class=k>def</span> <span class=nf>bind_a_variable</span><span class=p>():</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=k>global</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=n>a</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span> <span class=n>bind_a_variable</span><span class=p>()</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>170</span><span class=p>]:</span> <span class=nb>print</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[]</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>注意：我常常建议人们不要频繁使用global关键字。因为全局变量一般是用于存放系统的某些状态的。如果你发现自己用了很多，那可能就说明得要来点儿面向对象编程了（即使用类）。</p></blockquote><h2 id=322-返回多个值>3.2.2 返回多个值
<a class=header-anchor href=#322-%e8%bf%94%e5%9b%9e%e5%a4%9a%e4%b8%aa%e5%80%bc></a></h2><p>在我第一次用Python编程时（之前已经习惯了Java和C++），最喜欢的一个功能是：函数可以返回多个值。下面是一个简单的例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-89-1><a class=lnlinks href=#hl-89-1>1</a>
</span><span class=lnt id=hl-89-2><a class=lnlinks href=#hl-89-2>2</a>
</span><span class=lnt id=hl-89-3><a class=lnlinks href=#hl-89-3>3</a>
</span><span class=lnt id=hl-89-4><a class=lnlinks href=#hl-89-4>4</a>
</span><span class=lnt id=hl-89-5><a class=lnlinks href=#hl-89-5>5</a>
</span><span class=lnt id=hl-89-6><a class=lnlinks href=#hl-89-6>6</a>
</span><span class=lnt id=hl-89-7><a class=lnlinks href=#hl-89-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=n>f</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>在数据分析和其他科学计算应用中，你会发现自己常常这么干。该函数其实只返回了一个对象，也就是一个元组，最后该元组会被拆包到各个结果变量中。在上面的例子中，我们还可以这样写：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-90-1><a class=lnlinks href=#hl-90-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>return_value</span> <span class=o>=</span> <span class=n>f</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>这里的return_value将会是一个含有3个返回值的三元元组。此外，还有一种非常具有吸引力的多值返回方式——返回字典：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-91-1><a class=lnlinks href=#hl-91-1>1</a>
</span><span class=lnt id=hl-91-2><a class=lnlinks href=#hl-91-2>2</a>
</span><span class=lnt id=hl-91-3><a class=lnlinks href=#hl-91-3>3</a>
</span><span class=lnt id=hl-91-4><a class=lnlinks href=#hl-91-4>4</a>
</span><span class=lnt id=hl-91-5><a class=lnlinks href=#hl-91-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span> <span class=p>:</span> <span class=n>a</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span> <span class=p>:</span> <span class=n>b</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span> <span class=p>:</span> <span class=n>c</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>取决于工作内容，第二种方法可能很有用。</p><h2 id=323-函数也是对象>3.2.3 函数也是对象
<a class=header-anchor href=#323-%e5%87%bd%e6%95%b0%e4%b9%9f%e6%98%af%e5%af%b9%e8%b1%a1></a></h2><p>由于Python函数都是对象，因此，在其他语言中较难表达的一些设计思想在Python中就要简单很多了。假设我们有下面这样一个字符串数组，希望对其进行一些数据清理工作并执行一堆转换：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-92-1><a class=lnlinks href=#hl-92-1>1</a>
</span><span class=lnt id=hl-92-2><a class=lnlinks href=#hl-92-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>171</span><span class=p>]:</span> <span class=n>states</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;   Alabama &#39;</span><span class=p>,</span> <span class=s1>&#39;Georgia!&#39;</span><span class=p>,</span> <span class=s1>&#39;Georgia&#39;</span><span class=p>,</span> <span class=s1>&#39;georgia&#39;</span><span class=p>,</span> <span class=s1>&#39;FlOrIda&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>           <span class=s1>&#39;south   carolina##&#39;</span><span class=p>,</span> <span class=s1>&#39;West virginia?&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>不管是谁，只要处理过由用户提交的调查数据，就能明白这种乱七八糟的数据是怎么一回事。为了得到一组能用于分析工作的格式统一的字符串，需要做很多事情：去除空白符、删除各种标点符号、正确的大写格式等。做法之一是使用内建的字符串方法和正则表达式<code>re</code>模块：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-93-1><a class=lnlinks href=#hl-93-1> 1</a>
</span><span class=lnt id=hl-93-2><a class=lnlinks href=#hl-93-2> 2</a>
</span><span class=lnt id=hl-93-3><a class=lnlinks href=#hl-93-3> 3</a>
</span><span class=lnt id=hl-93-4><a class=lnlinks href=#hl-93-4> 4</a>
</span><span class=lnt id=hl-93-5><a class=lnlinks href=#hl-93-5> 5</a>
</span><span class=lnt id=hl-93-6><a class=lnlinks href=#hl-93-6> 6</a>
</span><span class=lnt id=hl-93-7><a class=lnlinks href=#hl-93-7> 7</a>
</span><span class=lnt id=hl-93-8><a class=lnlinks href=#hl-93-8> 8</a>
</span><span class=lnt id=hl-93-9><a class=lnlinks href=#hl-93-9> 9</a>
</span><span class=lnt id=hl-93-10><a class=lnlinks href=#hl-93-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>clean_strings</span><span class=p>(</span><span class=n>strings</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>strings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>value</span> <span class=o>=</span> <span class=n>value</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>value</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=s1>&#39;[!#?]&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>value</span> <span class=o>=</span> <span class=n>value</span><span class=o>.</span><span class=n>title</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span></span></span></code></pre></td></tr></table></div></div><p>结果如下所示：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-94-1><a class=lnlinks href=#hl-94-1>1</a>
</span><span class=lnt id=hl-94-2><a class=lnlinks href=#hl-94-2>2</a>
</span><span class=lnt id=hl-94-3><a class=lnlinks href=#hl-94-3>3</a>
</span><span class=lnt id=hl-94-4><a class=lnlinks href=#hl-94-4>4</a>
</span><span class=lnt id=hl-94-5><a class=lnlinks href=#hl-94-5>5</a>
</span><span class=lnt id=hl-94-6><a class=lnlinks href=#hl-94-6>6</a>
</span><span class=lnt id=hl-94-7><a class=lnlinks href=#hl-94-7>7</a>
</span><span class=lnt id=hl-94-8><a class=lnlinks href=#hl-94-8>8</a>
</span><span class=lnt id=hl-94-9><a class=lnlinks href=#hl-94-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>173</span><span class=p>]:</span> <span class=n>clean_strings</span><span class=p>(</span><span class=n>states</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>173</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;Alabama&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;Georgia&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;Georgia&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;Georgia&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;Florida&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;South   Carolina&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;West Virginia&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>其实还有另外一种不错的办法：将需要在一组给定字符串上执行的所有运算做成一个列表：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-95-1><a class=lnlinks href=#hl-95-1> 1</a>
</span><span class=lnt id=hl-95-2><a class=lnlinks href=#hl-95-2> 2</a>
</span><span class=lnt id=hl-95-3><a class=lnlinks href=#hl-95-3> 3</a>
</span><span class=lnt id=hl-95-4><a class=lnlinks href=#hl-95-4> 4</a>
</span><span class=lnt id=hl-95-5><a class=lnlinks href=#hl-95-5> 5</a>
</span><span class=lnt id=hl-95-6><a class=lnlinks href=#hl-95-6> 6</a>
</span><span class=lnt id=hl-95-7><a class=lnlinks href=#hl-95-7> 7</a>
</span><span class=lnt id=hl-95-8><a class=lnlinks href=#hl-95-8> 8</a>
</span><span class=lnt id=hl-95-9><a class=lnlinks href=#hl-95-9> 9</a>
</span><span class=lnt id=hl-95-10><a class=lnlinks href=#hl-95-10>10</a>
</span><span class=lnt id=hl-95-11><a class=lnlinks href=#hl-95-11>11</a>
</span><span class=lnt id=hl-95-12><a class=lnlinks href=#hl-95-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>remove_punctuation</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=s1>&#39;[!#?]&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>clean_ops</span> <span class=o>=</span> <span class=p>[</span><span class=nb>str</span><span class=o>.</span><span class=n>strip</span><span class=p>,</span> <span class=n>remove_punctuation</span><span class=p>,</span> <span class=nb>str</span><span class=o>.</span><span class=n>title</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>clean_strings</span><span class=p>(</span><span class=n>strings</span><span class=p>,</span> <span class=n>ops</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>strings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>function</span> <span class=ow>in</span> <span class=n>ops</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>value</span> <span class=o>=</span> <span class=n>function</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span></span></span></code></pre></td></tr></table></div></div><p>然后我们就有了：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-96-1><a class=lnlinks href=#hl-96-1>1</a>
</span><span class=lnt id=hl-96-2><a class=lnlinks href=#hl-96-2>2</a>
</span><span class=lnt id=hl-96-3><a class=lnlinks href=#hl-96-3>3</a>
</span><span class=lnt id=hl-96-4><a class=lnlinks href=#hl-96-4>4</a>
</span><span class=lnt id=hl-96-5><a class=lnlinks href=#hl-96-5>5</a>
</span><span class=lnt id=hl-96-6><a class=lnlinks href=#hl-96-6>6</a>
</span><span class=lnt id=hl-96-7><a class=lnlinks href=#hl-96-7>7</a>
</span><span class=lnt id=hl-96-8><a class=lnlinks href=#hl-96-8>8</a>
</span><span class=lnt id=hl-96-9><a class=lnlinks href=#hl-96-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>175</span><span class=p>]:</span> <span class=n>clean_strings</span><span class=p>(</span><span class=n>states</span><span class=p>,</span> <span class=n>clean_ops</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>175</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;Alabama&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;Georgia&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;Georgia&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;Georgia&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;Florida&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;South   Carolina&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;West Virginia&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>这种多函数模式使你能在很高的层次上轻松修改字符串的转换方式。此时的clean_strings也更具可复用性！</p><p>还可以将函数用作其他函数的参数，比如内置的map函数，它用于在一组数据上应用一个函数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-97-1><a class=lnlinks href=#hl-97-1>1</a>
</span><span class=lnt id=hl-97-2><a class=lnlinks href=#hl-97-2>2</a>
</span><span class=lnt id=hl-97-3><a class=lnlinks href=#hl-97-3>3</a>
</span><span class=lnt id=hl-97-4><a class=lnlinks href=#hl-97-4>4</a>
</span><span class=lnt id=hl-97-5><a class=lnlinks href=#hl-97-5>5</a>
</span><span class=lnt id=hl-97-6><a class=lnlinks href=#hl-97-6>6</a>
</span><span class=lnt id=hl-97-7><a class=lnlinks href=#hl-97-7>7</a>
</span><span class=lnt id=hl-97-8><a class=lnlinks href=#hl-97-8>8</a>
</span><span class=lnt id=hl-97-9><a class=lnlinks href=#hl-97-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>176</span><span class=p>]:</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>map</span><span class=p>(</span><span class=n>remove_punctuation</span><span class=p>,</span> <span class=n>states</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=nb>print</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Alabama</span> 
</span></span><span class=line><span class=cl><span class=n>Georgia</span>
</span></span><span class=line><span class=cl><span class=n>Georgia</span>
</span></span><span class=line><span class=cl><span class=n>georgia</span>
</span></span><span class=line><span class=cl><span class=n>FlOrIda</span>
</span></span><span class=line><span class=cl><span class=n>south</span>   <span class=n>carolina</span>
</span></span><span class=line><span class=cl><span class=n>West</span> <span class=n>virginia</span></span></span></code></pre></td></tr></table></div></div><h2 id=324-匿名lambda函数>3.2.4 匿名（lambda）函数
<a class=header-anchor href=#324-%e5%8c%bf%e5%90%8dlambda%e5%87%bd%e6%95%b0></a></h2><p>Python支持一种被称为匿名的、或lambda函数。它仅由单条语句组成，该语句的结果就是返回值。它是通过lambda关键字定义的，这个关键字没有别的含义，仅仅是说“我们正在声明的是一个匿名函数”。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-98-1><a class=lnlinks href=#hl-98-1>1</a>
</span><span class=lnt id=hl-98-2><a class=lnlinks href=#hl-98-2>2</a>
</span><span class=lnt id=hl-98-3><a class=lnlinks href=#hl-98-3>3</a>
</span><span class=lnt id=hl-98-4><a class=lnlinks href=#hl-98-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>short_function</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>equiv_anon</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span></span></span></code></pre></td></tr></table></div></div><p>本书其余部分一般将其称为lambda函数。它们在数据分析工作中非常方便，因为你会发现很多数据转换函数都以函数作为参数的。直接传入lambda函数比编写完整函数声明要少输入很多字（也更清晰），甚至比将lambda函数赋值给一个变量还要少输入很多字。看看下面这个简单得有些傻的例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-99-1><a class=lnlinks href=#hl-99-1>1</a>
</span><span class=lnt id=hl-99-2><a class=lnlinks href=#hl-99-2>2</a>
</span><span class=lnt id=hl-99-3><a class=lnlinks href=#hl-99-3>3</a>
</span><span class=lnt id=hl-99-4><a class=lnlinks href=#hl-99-4>4</a>
</span><span class=lnt id=hl-99-5><a class=lnlinks href=#hl-99-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>apply_to_list</span><span class=p>(</span><span class=n>some_list</span><span class=p>,</span> <span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span><span class=n>f</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>some_list</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ints</span> <span class=o>=</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>apply_to_list</span><span class=p>(</span><span class=n>ints</span><span class=p>,</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>虽然你可以直接编写[x *2for x in ints]，但是这里我们可以非常轻松地传入一个自定义运算给apply_to_list函数。</p><p>再来看另外一个例子。假设有一组字符串，你想要根据各字符串不同字母的数量对其进行排序：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-100-1><a class=lnlinks href=#hl-100-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>177</span><span class=p>]:</span> <span class=n>strings</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;card&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;aaaa&#39;</span><span class=p>,</span> <span class=s1>&#39;abab&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>这里，我们可以传入一个lambda函数到列表的sort方法：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-101-1><a class=lnlinks href=#hl-101-1>1</a>
</span><span class=lnt id=hl-101-2><a class=lnlinks href=#hl-101-2>2</a>
</span><span class=lnt id=hl-101-3><a class=lnlinks href=#hl-101-3>3</a>
</span><span class=lnt id=hl-101-4><a class=lnlinks href=#hl-101-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>178</span><span class=p>]:</span> <span class=n>strings</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>179</span><span class=p>]:</span> <span class=n>strings</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>179</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;aaaa&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39;abab&#39;</span><span class=p>,</span> <span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=s1>&#39;card&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>笔记：lambda函数之所以会被称为匿名函数，与def声明的函数不同，原因之一就是这种函数对象本身是没有提供名称__name__属性。</p></blockquote><h2 id=325-柯里化部分参数应用>3.2.5 柯里化：部分参数应用
<a class=header-anchor href=#325-%e6%9f%af%e9%87%8c%e5%8c%96%e9%83%a8%e5%88%86%e5%8f%82%e6%95%b0%e5%ba%94%e7%94%a8></a></h2><p>柯里化（currying）是一个有趣的计算机科学术语，它指的是通过“部分参数应用”（partial argument application）从现有函数派生出新函数的技术。例如，假设我们有一个执行两数相加的简单函数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-102-1><a class=lnlinks href=#hl-102-1>1</a>
</span><span class=lnt id=hl-102-2><a class=lnlinks href=#hl-102-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>add_numbers</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span></span></span></code></pre></td></tr></table></div></div><p>通过这个函数，我们可以派生出一个新的只有一个参数的函数——add_five，它用于对其参数加5：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-103-1><a class=lnlinks href=#hl-103-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>add_five</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>y</span><span class=p>:</span> <span class=n>add_numbers</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>add_numbers的第二个参数称为“柯里化的”（curried）。这里没什么特别花哨的东西，因为我们其实就只是定义了一个可以调用现有函数的新函数而已。内置的functools模块可以用partial函数将此过程简化：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-104-1><a class=lnlinks href=#hl-104-1>1</a>
</span><span class=lnt id=hl-104-2><a class=lnlinks href=#hl-104-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>partial</span>
</span></span><span class=line><span class=cl><span class=n>add_five</span> <span class=o>=</span> <span class=n>partial</span><span class=p>(</span><span class=n>add_numbers</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><h2 id=326-生成器>3.2.6 生成器
<a class=header-anchor href=#326-%e7%94%9f%e6%88%90%e5%99%a8></a></h2><p>能以一种一致的方式对序列进行迭代（比如列表中的对象或文件中的行）是Python的一个重要特点。这是通过一种叫做迭代器协议（iterator protocol，它是一种使对象可迭代的通用方式）的方式实现的，一个原生的使对象可迭代的方法。比如说，对字典进行迭代可以得到其所有的键：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-105-1><a class=lnlinks href=#hl-105-1>1</a>
</span><span class=lnt id=hl-105-2><a class=lnlinks href=#hl-105-2>2</a>
</span><span class=lnt id=hl-105-3><a class=lnlinks href=#hl-105-3>3</a>
</span><span class=lnt id=hl-105-4><a class=lnlinks href=#hl-105-4>4</a>
</span><span class=lnt id=hl-105-5><a class=lnlinks href=#hl-105-5>5</a>
</span><span class=lnt id=hl-105-6><a class=lnlinks href=#hl-105-6>6</a>
</span><span class=lnt id=hl-105-7><a class=lnlinks href=#hl-105-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>180</span><span class=p>]:</span> <span class=n>some_dict</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>181</span><span class=p>]:</span> <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>some_dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=nb>print</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>c</span></span></span></code></pre></td></tr></table></div></div><p>当你编写for key in some_dict时，Python解释器首先会尝试从some_dict创建一个迭代器：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-106-1><a class=lnlinks href=#hl-106-1>1</a>
</span><span class=lnt id=hl-106-2><a class=lnlinks href=#hl-106-2>2</a>
</span><span class=lnt id=hl-106-3><a class=lnlinks href=#hl-106-3>3</a>
</span><span class=lnt id=hl-106-4><a class=lnlinks href=#hl-106-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>182</span><span class=p>]:</span> <span class=n>dict_iterator</span> <span class=o>=</span> <span class=nb>iter</span><span class=p>(</span><span class=n>some_dict</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>183</span><span class=p>]:</span> <span class=n>dict_iterator</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>183</span><span class=p>]:</span> <span class=o>&lt;</span><span class=n>dict_keyiterator</span> <span class=n>at</span> <span class=mh>0x7fbbd5a9f908</span><span class=o>&gt;</span></span></span></code></pre></td></tr></table></div></div><p>迭代器是一种特殊对象，它可以在诸如for循环之类的上下文中向Python解释器输送对象。大部分能接受列表之类的对象的方法也都可以接受任何可迭代对象。比如min、max、sum等内置方法以及list、tuple等类型构造器：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-107-1><a class=lnlinks href=#hl-107-1>1</a>
</span><span class=lnt id=hl-107-2><a class=lnlinks href=#hl-107-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>184</span><span class=p>]:</span> <span class=nb>list</span><span class=p>(</span><span class=n>dict_iterator</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>184</span><span class=p>]:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>生成器（generator）是构造新的可迭代对象的一种简单方式。一般的函数执行之后只会返回单个值，而生成器则是以延迟的方式返回一个值序列，即每返回一个值之后暂停，直到下一个值被请求时再继续。要创建一个生成器，只需将函数中的return替换为yeild即可：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-108-1><a class=lnlinks href=#hl-108-1>1</a>
</span><span class=lnt id=hl-108-2><a class=lnlinks href=#hl-108-2>2</a>
</span><span class=lnt id=hl-108-3><a class=lnlinks href=#hl-108-3>3</a>
</span><span class=lnt id=hl-108-4><a class=lnlinks href=#hl-108-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>squares</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Generating squares from 1 to </span><span class=si>{0}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>n</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=n>i</span> <span class=o>**</span> <span class=mi>2</span></span></span></code></pre></td></tr></table></div></div><p>调用该生成器时，没有任何代码会被立即执行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-109-1><a class=lnlinks href=#hl-109-1>1</a>
</span><span class=lnt id=hl-109-2><a class=lnlinks href=#hl-109-2>2</a>
</span><span class=lnt id=hl-109-3><a class=lnlinks href=#hl-109-3>3</a>
</span><span class=lnt id=hl-109-4><a class=lnlinks href=#hl-109-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>186</span><span class=p>]:</span> <span class=n>gen</span> <span class=o>=</span> <span class=n>squares</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>187</span><span class=p>]:</span> <span class=n>gen</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>187</span><span class=p>]:</span> <span class=o>&lt;</span><span class=n>generator</span> <span class=nb>object</span> <span class=n>squares</span> <span class=n>at</span> <span class=mh>0x7fbbd5ab4570</span><span class=o>&gt;</span></span></span></code></pre></td></tr></table></div></div><p>直到你从该生成器中请求元素时，它才会开始执行其代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-110-1><a class=lnlinks href=#hl-110-1>1</a>
</span><span class=lnt id=hl-110-2><a class=lnlinks href=#hl-110-2>2</a>
</span><span class=lnt id=hl-110-3><a class=lnlinks href=#hl-110-3>3</a>
</span><span class=lnt id=hl-110-4><a class=lnlinks href=#hl-110-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>188</span><span class=p>]:</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>gen</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=nb>print</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Generating</span> <span class=n>squares</span> <span class=kn>from</span> <span class=mi>1</span> <span class=n>to</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=mi>1</span> <span class=mi>4</span> <span class=mi>9</span> <span class=mi>16</span> <span class=mi>25</span> <span class=mi>36</span> <span class=mi>49</span> <span class=mi>64</span> <span class=mi>81</span> <span class=mi>100</span></span></span></code></pre></td></tr></table></div></div><h2 id=327-生成器表达式>3.2.7 生成器表达式
<a class=header-anchor href=#327-%e7%94%9f%e6%88%90%e5%99%a8%e8%a1%a8%e8%be%be%e5%bc%8f></a></h2><p>另一种更简洁的构造生成器的方法是使用生成器表达式（generator expression）。这是一种类似于列表、字典、集合推导式的生成器。其创建方式为，把列表推导式两端的方括号改成圆括号：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-111-1><a class=lnlinks href=#hl-111-1>1</a>
</span><span class=lnt id=hl-111-2><a class=lnlinks href=#hl-111-2>2</a>
</span><span class=lnt id=hl-111-3><a class=lnlinks href=#hl-111-3>3</a>
</span><span class=lnt id=hl-111-4><a class=lnlinks href=#hl-111-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>189</span><span class=p>]:</span> <span class=n>gen</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>**</span> <span class=mi>2</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>190</span><span class=p>]:</span> <span class=n>gen</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>190</span><span class=p>]:</span> <span class=o>&lt;</span><span class=n>generator</span> <span class=nb>object</span> <span class=o>&lt;</span><span class=n>genexpr</span><span class=o>&gt;</span> <span class=n>at</span> <span class=mh>0x7fbbd5ab29e8</span><span class=o>&gt;</span></span></span></code></pre></td></tr></table></div></div><p>它跟下面这个冗长得多的生成器是完全等价的：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-112-1><a class=lnlinks href=#hl-112-1>1</a>
</span><span class=lnt id=hl-112-2><a class=lnlinks href=#hl-112-2>2</a>
</span><span class=lnt id=hl-112-3><a class=lnlinks href=#hl-112-3>3</a>
</span><span class=lnt id=hl-112-4><a class=lnlinks href=#hl-112-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>_make_gen</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>gen</span> <span class=o>=</span> <span class=n>_make_gen</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>生成器表达式也可以取代列表推导式，作为函数参数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-113-1><a class=lnlinks href=#hl-113-1>1</a>
</span><span class=lnt id=hl-113-2><a class=lnlinks href=#hl-113-2>2</a>
</span><span class=lnt id=hl-113-3><a class=lnlinks href=#hl-113-3>3</a>
</span><span class=lnt id=hl-113-4><a class=lnlinks href=#hl-113-4>4</a>
</span><span class=lnt id=hl-113-5><a class=lnlinks href=#hl-113-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>191</span><span class=p>]:</span> <span class=nb>sum</span><span class=p>(</span><span class=n>x</span> <span class=o>**</span> <span class=mi>2</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>191</span><span class=p>]:</span> <span class=mi>328350</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>192</span><span class=p>]:</span> <span class=nb>dict</span><span class=p>((</span><span class=n>i</span><span class=p>,</span> <span class=n>i</span> <span class=o>**</span><span class=mi>2</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>192</span><span class=p>]:</span> <span class=p>{</span><span class=mi>0</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>:</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>4</span><span class=p>:</span> <span class=mi>16</span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h2 id=328-itertools模块>3.2.8 itertools模块
<a class=header-anchor href=#328-itertools%e6%a8%a1%e5%9d%97></a></h2><p>标准库itertools模块中有一组用于许多常见数据算法的生成器。例如，groupby可以接受任何序列和一个函数。它根据函数的返回值对序列中的连续元素进行分组。下面是一个例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-114-1><a class=lnlinks href=#hl-114-1> 1</a>
</span><span class=lnt id=hl-114-2><a class=lnlinks href=#hl-114-2> 2</a>
</span><span class=lnt id=hl-114-3><a class=lnlinks href=#hl-114-3> 3</a>
</span><span class=lnt id=hl-114-4><a class=lnlinks href=#hl-114-4> 4</a>
</span><span class=lnt id=hl-114-5><a class=lnlinks href=#hl-114-5> 5</a>
</span><span class=lnt id=hl-114-6><a class=lnlinks href=#hl-114-6> 6</a>
</span><span class=lnt id=hl-114-7><a class=lnlinks href=#hl-114-7> 7</a>
</span><span class=lnt id=hl-114-8><a class=lnlinks href=#hl-114-8> 8</a>
</span><span class=lnt id=hl-114-9><a class=lnlinks href=#hl-114-9> 9</a>
</span><span class=lnt id=hl-114-10><a class=lnlinks href=#hl-114-10>10</a>
</span><span class=lnt id=hl-114-11><a class=lnlinks href=#hl-114-11>11</a>
</span><span class=lnt id=hl-114-12><a class=lnlinks href=#hl-114-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>193</span><span class=p>]:</span> <span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>194</span><span class=p>]:</span> <span class=n>first_letter</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>195</span><span class=p>]:</span> <span class=n>names</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Alan&#39;</span><span class=p>,</span> <span class=s1>&#39;Adam&#39;</span><span class=p>,</span> <span class=s1>&#39;Wes&#39;</span><span class=p>,</span> <span class=s1>&#39;Will&#39;</span><span class=p>,</span> <span class=s1>&#39;Albert&#39;</span><span class=p>,</span> <span class=s1>&#39;Steven&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>196</span><span class=p>]:</span> <span class=k>for</span> <span class=n>letter</span><span class=p>,</span> <span class=n>names</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=n>names</span><span class=p>,</span> <span class=n>first_letter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=nb>print</span><span class=p>(</span><span class=n>letter</span><span class=p>,</span> <span class=nb>list</span><span class=p>(</span><span class=n>names</span><span class=p>))</span> <span class=c1># names is a generator</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=p>[</span><span class=s1>&#39;Alan&#39;</span><span class=p>,</span> <span class=s1>&#39;Adam&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>W</span> <span class=p>[</span><span class=s1>&#39;Wes&#39;</span><span class=p>,</span> <span class=s1>&#39;Will&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=p>[</span><span class=s1>&#39;Albert&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>S</span> <span class=p>[</span><span class=s1>&#39;Steven&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>表3-2中列出了一些我经常用到的itertools函数。建议参阅Python官方文档，进一步学习。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://gitee.com/wugenqiang/images/raw/master/01/1240-20201009185536362.png alt="表3-2 一些有用的itertools函数"></p><h2 id=329-错误和异常处理>3.2.9 错误和异常处理
<a class=header-anchor href=#329-%e9%94%99%e8%af%af%e5%92%8c%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86></a></h2><p>优雅地处理Python的错误和异常是构建健壮程序的重要部分。在数据分析中，许多函数函数只用于部分输入。例如，Python的float函数可以将字符串转换成浮点数，但输入有误时，有<code>ValueError</code>错误：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-115-1><a class=lnlinks href=#hl-115-1>1</a>
</span><span class=lnt id=hl-115-2><a class=lnlinks href=#hl-115-2>2</a>
</span><span class=lnt id=hl-115-3><a class=lnlinks href=#hl-115-3>3</a>
</span><span class=lnt id=hl-115-4><a class=lnlinks href=#hl-115-4>4</a>
</span><span class=lnt id=hl-115-5><a class=lnlinks href=#hl-115-5>5</a>
</span><span class=lnt id=hl-115-6><a class=lnlinks href=#hl-115-6>6</a>
</span><span class=lnt id=hl-115-7><a class=lnlinks href=#hl-115-7>7</a>
</span><span class=lnt id=hl-115-8><a class=lnlinks href=#hl-115-8>8</a>
</span><span class=lnt id=hl-115-9><a class=lnlinks href=#hl-115-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>197</span><span class=p>]:</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;1.2345&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>197</span><span class=p>]:</span> <span class=mf>1.2345</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>198</span><span class=p>]:</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;something&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=ne>ValueError</span>                                <span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ipython</span><span class=o>-</span><span class=nb>input</span><span class=o>-</span><span class=mi>198</span><span class=o>-</span><span class=mi>439904410854</span><span class=o>&gt;</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>1</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;something&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=ne>ValueError</span><span class=p>:</span> <span class=n>could</span> <span class=ow>not</span> <span class=n>convert</span> <span class=n>string</span> <span class=n>to</span> <span class=nb>float</span><span class=p>:</span> <span class=s1>&#39;something&#39;</span></span></span></code></pre></td></tr></table></div></div><p>假如想优雅地处理float的错误，让它返回输入值。我们可以写一个函数，在try/except中调用float：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-116-1><a class=lnlinks href=#hl-116-1>1</a>
</span><span class=lnt id=hl-116-2><a class=lnlinks href=#hl-116-2>2</a>
</span><span class=lnt id=hl-116-3><a class=lnlinks href=#hl-116-3>3</a>
</span><span class=lnt id=hl-116-4><a class=lnlinks href=#hl-116-4>4</a>
</span><span class=lnt id=hl-116-5><a class=lnlinks href=#hl-116-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>attempt_float</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>x</span></span></span></code></pre></td></tr></table></div></div><p>当float(x)抛出异常时，才会执行except的部分：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-117-1><a class=lnlinks href=#hl-117-1>1</a>
</span><span class=lnt id=hl-117-2><a class=lnlinks href=#hl-117-2>2</a>
</span><span class=lnt id=hl-117-3><a class=lnlinks href=#hl-117-3>3</a>
</span><span class=lnt id=hl-117-4><a class=lnlinks href=#hl-117-4>4</a>
</span><span class=lnt id=hl-117-5><a class=lnlinks href=#hl-117-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>200</span><span class=p>]:</span> <span class=n>attempt_float</span><span class=p>(</span><span class=s1>&#39;1.2345&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>200</span><span class=p>]:</span> <span class=mf>1.2345</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>201</span><span class=p>]:</span> <span class=n>attempt_float</span><span class=p>(</span><span class=s1>&#39;something&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>201</span><span class=p>]:</span> <span class=s1>&#39;something&#39;</span></span></span></code></pre></td></tr></table></div></div><p>你可能注意到float抛出的异常不仅是ValueError：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-118-1><a class=lnlinks href=#hl-118-1>1</a>
</span><span class=lnt id=hl-118-2><a class=lnlinks href=#hl-118-2>2</a>
</span><span class=lnt id=hl-118-3><a class=lnlinks href=#hl-118-3>3</a>
</span><span class=lnt id=hl-118-4><a class=lnlinks href=#hl-118-4>4</a>
</span><span class=lnt id=hl-118-5><a class=lnlinks href=#hl-118-5>5</a>
</span><span class=lnt id=hl-118-6><a class=lnlinks href=#hl-118-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>202</span><span class=p>]:</span> <span class=nb>float</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span>                                 <span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ipython</span><span class=o>-</span><span class=nb>input</span><span class=o>-</span><span class=mi>202</span><span class=o>-</span><span class=mi>842079</span><span class=n>ebb635</span><span class=o>&gt;</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>1</span> <span class=nb>float</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span><span class=p>:</span> <span class=nb>float</span><span class=p>()</span> <span class=n>argument</span> <span class=n>must</span> <span class=n>be</span> <span class=n>a</span> <span class=n>string</span> <span class=ow>or</span> <span class=n>a</span> <span class=n>number</span><span class=p>,</span> <span class=ow>not</span> <span class=s1>&#39;tuple&#39;</span></span></span></code></pre></td></tr></table></div></div><p>你可能只想处理ValueError，TypeError错误（输入不是字符串或数值）可能是合理的bug。可以写一个异常类型：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-119-1><a class=lnlinks href=#hl-119-1>1</a>
</span><span class=lnt id=hl-119-2><a class=lnlinks href=#hl-119-2>2</a>
</span><span class=lnt id=hl-119-3><a class=lnlinks href=#hl-119-3>3</a>
</span><span class=lnt id=hl-119-4><a class=lnlinks href=#hl-119-4>4</a>
</span><span class=lnt id=hl-119-5><a class=lnlinks href=#hl-119-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>attempt_float</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>x</span></span></span></code></pre></td></tr></table></div></div><p>然后有：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-120-1><a class=lnlinks href=#hl-120-1> 1</a>
</span><span class=lnt id=hl-120-2><a class=lnlinks href=#hl-120-2> 2</a>
</span><span class=lnt id=hl-120-3><a class=lnlinks href=#hl-120-3> 3</a>
</span><span class=lnt id=hl-120-4><a class=lnlinks href=#hl-120-4> 4</a>
</span><span class=lnt id=hl-120-5><a class=lnlinks href=#hl-120-5> 5</a>
</span><span class=lnt id=hl-120-6><a class=lnlinks href=#hl-120-6> 6</a>
</span><span class=lnt id=hl-120-7><a class=lnlinks href=#hl-120-7> 7</a>
</span><span class=lnt id=hl-120-8><a class=lnlinks href=#hl-120-8> 8</a>
</span><span class=lnt id=hl-120-9><a class=lnlinks href=#hl-120-9> 9</a>
</span><span class=lnt id=hl-120-10><a class=lnlinks href=#hl-120-10>10</a>
</span><span class=lnt id=hl-120-11><a class=lnlinks href=#hl-120-11>11</a>
</span><span class=lnt id=hl-120-12><a class=lnlinks href=#hl-120-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>204</span><span class=p>]:</span> <span class=n>attempt_float</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span>                                 <span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ipython</span><span class=o>-</span><span class=nb>input</span><span class=o>-</span><span class=mi>204</span><span class=o>-</span><span class=mi>9</span><span class=n>bdfd730cead</span><span class=o>&gt;</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>1</span> <span class=n>attempt_float</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ipython</span><span class=o>-</span><span class=nb>input</span><span class=o>-</span><span class=mi>203</span><span class=o>-</span><span class=mf>3e06</span><span class=n>b8379b6b</span><span class=o>&gt;</span> <span class=ow>in</span> <span class=n>attempt_float</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=mi>1</span> <span class=k>def</span> <span class=nf>attempt_float</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=mi>2</span>     <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>3</span>         <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=mi>4</span>     <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=mi>5</span>         <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl><span class=ne>TypeError</span><span class=p>:</span> <span class=nb>float</span><span class=p>()</span> <span class=n>argument</span> <span class=n>must</span> <span class=n>be</span> <span class=n>a</span> <span class=n>string</span> <span class=ow>or</span> <span class=n>a</span> <span class=n>number</span><span class=p>,</span> <span class=ow>not</span> <span class=s1>&#39;tuple&#39;</span></span></span></code></pre></td></tr></table></div></div><p>可以用元组包含多个异常：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-121-1><a class=lnlinks href=#hl-121-1>1</a>
</span><span class=lnt id=hl-121-2><a class=lnlinks href=#hl-121-2>2</a>
</span><span class=lnt id=hl-121-3><a class=lnlinks href=#hl-121-3>3</a>
</span><span class=lnt id=hl-121-4><a class=lnlinks href=#hl-121-4>4</a>
</span><span class=lnt id=hl-121-5><a class=lnlinks href=#hl-121-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>attempt_float</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>float</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=p>(</span><span class=ne>TypeError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>x</span></span></span></code></pre></td></tr></table></div></div><p>某些情况下，你可能不想抑制异常，你想无论try部分的代码是否成功，都执行一段代码。可以使用finally：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-122-1><a class=lnlinks href=#hl-122-1>1</a>
</span><span class=lnt id=hl-122-2><a class=lnlinks href=#hl-122-2>2</a>
</span><span class=lnt id=hl-122-3><a class=lnlinks href=#hl-122-3>3</a>
</span><span class=lnt id=hl-122-4><a class=lnlinks href=#hl-122-4>4</a>
</span><span class=lnt id=hl-122-5><a class=lnlinks href=#hl-122-5>5</a>
</span><span class=lnt id=hl-122-6><a class=lnlinks href=#hl-122-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>write_to_file</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>这里，文件处理f总会被关闭。相似的，你可以用else让只在try部分成功的情况下，才执行代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-123-1><a class=lnlinks href=#hl-123-1> 1</a>
</span><span class=lnt id=hl-123-2><a class=lnlinks href=#hl-123-2> 2</a>
</span><span class=lnt id=hl-123-3><a class=lnlinks href=#hl-123-3> 3</a>
</span><span class=lnt id=hl-123-4><a class=lnlinks href=#hl-123-4> 4</a>
</span><span class=lnt id=hl-123-5><a class=lnlinks href=#hl-123-5> 5</a>
</span><span class=lnt id=hl-123-6><a class=lnlinks href=#hl-123-6> 6</a>
</span><span class=lnt id=hl-123-7><a class=lnlinks href=#hl-123-7> 7</a>
</span><span class=lnt id=hl-123-8><a class=lnlinks href=#hl-123-8> 8</a>
</span><span class=lnt id=hl-123-9><a class=lnlinks href=#hl-123-9> 9</a>
</span><span class=lnt id=hl-123-10><a class=lnlinks href=#hl-123-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>write_to_file</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Failed&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Succeeded&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><h2 id=3210-ipython的异常>3.2.10 IPython的异常
<a class=header-anchor href=#3210-ipython%e7%9a%84%e5%bc%82%e5%b8%b8></a></h2><p>如果是在%run一个脚本或一条语句时抛出异常，IPython默认会打印完整的调用栈（traceback），在栈的每个点都会有几行上下文：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-124-1><a class=lnlinks href=#hl-124-1> 1</a>
</span><span class=lnt id=hl-124-2><a class=lnlinks href=#hl-124-2> 2</a>
</span><span class=lnt id=hl-124-3><a class=lnlinks href=#hl-124-3> 3</a>
</span><span class=lnt id=hl-124-4><a class=lnlinks href=#hl-124-4> 4</a>
</span><span class=lnt id=hl-124-5><a class=lnlinks href=#hl-124-5> 5</a>
</span><span class=lnt id=hl-124-6><a class=lnlinks href=#hl-124-6> 6</a>
</span><span class=lnt id=hl-124-7><a class=lnlinks href=#hl-124-7> 7</a>
</span><span class=lnt id=hl-124-8><a class=lnlinks href=#hl-124-8> 8</a>
</span><span class=lnt id=hl-124-9><a class=lnlinks href=#hl-124-9> 9</a>
</span><span class=lnt id=hl-124-10><a class=lnlinks href=#hl-124-10>10</a>
</span><span class=lnt id=hl-124-11><a class=lnlinks href=#hl-124-11>11</a>
</span><span class=lnt id=hl-124-12><a class=lnlinks href=#hl-124-12>12</a>
</span><span class=lnt id=hl-124-13><a class=lnlinks href=#hl-124-13>13</a>
</span><span class=lnt id=hl-124-14><a class=lnlinks href=#hl-124-14>14</a>
</span><span class=lnt id=hl-124-15><a class=lnlinks href=#hl-124-15>15</a>
</span><span class=lnt id=hl-124-16><a class=lnlinks href=#hl-124-16>16</a>
</span><span class=lnt id=hl-124-17><a class=lnlinks href=#hl-124-17>17</a>
</span><span class=lnt id=hl-124-18><a class=lnlinks href=#hl-124-18>18</a>
</span><span class=lnt id=hl-124-19><a class=lnlinks href=#hl-124-19>19</a>
</span><span class=lnt id=hl-124-20><a class=lnlinks href=#hl-124-20>20</a>
</span><span class=lnt id=hl-124-21><a class=lnlinks href=#hl-124-21>21</a>
</span><span class=lnt id=hl-124-22><a class=lnlinks href=#hl-124-22>22</a>
</span><span class=lnt id=hl-124-23><a class=lnlinks href=#hl-124-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>10</span><span class=p>]:</span> <span class=o>%</span><span class=n>run</span> <span class=n>examples</span><span class=o>/</span><span class=n>ipython_bug</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=ne>AssertionError</span>                            <span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>wesm</span><span class=o>/</span><span class=n>code</span><span class=o>/</span><span class=n>pydata</span><span class=o>-</span><span class=n>book</span><span class=o>/</span><span class=n>examples</span><span class=o>/</span><span class=n>ipython_bug</span><span class=o>.</span><span class=n>py</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl>     <span class=mi>13</span>     <span class=n>throws_an_exception</span><span class=p>()</span>
</span></span><span class=line><span class=cl>     <span class=mi>14</span>
</span></span><span class=line><span class=cl><span class=o>---&gt;</span> <span class=mi>15</span> <span class=n>calling_things</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>wesm</span><span class=o>/</span><span class=n>code</span><span class=o>/</span><span class=n>pydata</span><span class=o>-</span><span class=n>book</span><span class=o>/</span><span class=n>examples</span><span class=o>/</span><span class=n>ipython_bug</span><span class=o>.</span><span class=n>py</span> <span class=ow>in</span> <span class=n>calling_things</span><span class=p>()</span>
</span></span><span class=line><span class=cl>     <span class=mi>11</span> <span class=k>def</span> <span class=nf>calling_things</span><span class=p>():</span>
</span></span><span class=line><span class=cl>     <span class=mi>12</span>     <span class=n>works_fine</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>---&gt;</span> <span class=mi>13</span>     <span class=n>throws_an_exception</span><span class=p>()</span>
</span></span><span class=line><span class=cl>     <span class=mi>14</span>
</span></span><span class=line><span class=cl>     <span class=mi>15</span> <span class=n>calling_things</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>wesm</span><span class=o>/</span><span class=n>code</span><span class=o>/</span><span class=n>pydata</span><span class=o>-</span><span class=n>book</span><span class=o>/</span><span class=n>examples</span><span class=o>/</span><span class=n>ipython_bug</span><span class=o>.</span><span class=n>py</span> <span class=ow>in</span> <span class=n>throws_an_exception</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=mi>7</span>     <span class=n>a</span> <span class=o>=</span> <span class=mi>5</span>
</span></span><span class=line><span class=cl>      <span class=mi>8</span>     <span class=n>b</span> <span class=o>=</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>9</span>     <span class=k>assert</span><span class=p>(</span><span class=n>a</span> <span class=o>+</span> <span class=n>b</span> <span class=o>==</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=mi>10</span>
</span></span><span class=line><span class=cl>     <span class=mi>11</span> <span class=k>def</span> <span class=nf>calling_things</span><span class=p>():</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=ne>AssertionError</span><span class=p>:</span></span></span></code></pre></td></tr></table></div></div><p>自身就带有文本是相对于Python标准解释器的极大优点。你可以用魔术命令<code>%xmode</code>，从Plain（与Python标准解释器相同）到Verbose（带有函数的参数值）控制文本显示的数量。后面可以看到，发生错误之后，（用%debug或%pdb magics）可以进入stack进行事后调试。</p><h1 id=33-文件和操作系统>3.3 文件和操作系统
<a class=header-anchor href=#33-%e6%96%87%e4%bb%b6%e5%92%8c%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f></a></h1><p>本书的代码示例大多使用诸如pandas.read_csv之类的高级工具将磁盘上的数据文件读入Python数据结构。但我们还是需要了解一些有关Python文件处理方面的基础知识。好在它本来就很简单，这也是Python在文本和文件处理方面的如此流行的原因之一。</p><p>为了打开一个文件以便读写，可以使用内置的open函数以及一个相对或绝对的文件路径：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-125-1><a class=lnlinks href=#hl-125-1>1</a>
</span><span class=lnt id=hl-125-2><a class=lnlinks href=#hl-125-2>2</a>
</span><span class=lnt id=hl-125-3><a class=lnlinks href=#hl-125-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>207</span><span class=p>]:</span> <span class=n>path</span> <span class=o>=</span> <span class=s1>&#39;examples/segismundo.txt&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>208</span><span class=p>]:</span> <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>默认情况下，文件是以只读模式（&lsquo;r&rsquo;）打开的。然后，我们就可以像处理列表那样来处理这个文件句柄f了，比如对行进行迭代：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-126-1><a class=lnlinks href=#hl-126-1>1</a>
</span><span class=lnt id=hl-126-2><a class=lnlinks href=#hl-126-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span></span></span></code></pre></td></tr></table></div></div><p>从文件中取出的行都带有完整的行结束符（EOL），因此你常常会看到下面这样的代码（得到一组没有EOL的行）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-127-1><a class=lnlinks href=#hl-127-1> 1</a>
</span><span class=lnt id=hl-127-2><a class=lnlinks href=#hl-127-2> 2</a>
</span><span class=lnt id=hl-127-3><a class=lnlinks href=#hl-127-3> 3</a>
</span><span class=lnt id=hl-127-4><a class=lnlinks href=#hl-127-4> 4</a>
</span><span class=lnt id=hl-127-5><a class=lnlinks href=#hl-127-5> 5</a>
</span><span class=lnt id=hl-127-6><a class=lnlinks href=#hl-127-6> 6</a>
</span><span class=lnt id=hl-127-7><a class=lnlinks href=#hl-127-7> 7</a>
</span><span class=lnt id=hl-127-8><a class=lnlinks href=#hl-127-8> 8</a>
</span><span class=lnt id=hl-127-9><a class=lnlinks href=#hl-127-9> 9</a>
</span><span class=lnt id=hl-127-10><a class=lnlinks href=#hl-127-10>10</a>
</span><span class=lnt id=hl-127-11><a class=lnlinks href=#hl-127-11>11</a>
</span><span class=lnt id=hl-127-12><a class=lnlinks href=#hl-127-12>12</a>
</span><span class=lnt id=hl-127-13><a class=lnlinks href=#hl-127-13>13</a>
</span><span class=lnt id=hl-127-14><a class=lnlinks href=#hl-127-14>14</a>
</span><span class=lnt id=hl-127-15><a class=lnlinks href=#hl-127-15>15</a>
</span><span class=lnt id=hl-127-16><a class=lnlinks href=#hl-127-16>16</a>
</span><span class=lnt id=hl-127-17><a class=lnlinks href=#hl-127-17>17</a>
</span><span class=lnt id=hl-127-18><a class=lnlinks href=#hl-127-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>209</span><span class=p>]:</span> <span class=n>lines</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>rstrip</span><span class=p>()</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>210</span><span class=p>]:</span> <span class=n>lines</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>210</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;Sueña el rico en su riqueza,&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;que más cuidados le ofrece;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;sueña el pobre que padece&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;su miseria y su pobreza;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;sueña el que a medrar empieza,&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;sueña el que afana y pretende,&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;sueña el que agravia y ofende,&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;y en el mundo, en conclusión,&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;todos sueñan lo que son,&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;aunque ninguno lo entiende.&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>如果使用open创建文件对象，一定要用close关闭它。关闭文件可以返回操作系统资源：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-128-1><a class=lnlinks href=#hl-128-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>211</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>用with语句可以可以更容易地清理打开的文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-129-1><a class=lnlinks href=#hl-129-1>1</a>
</span><span class=lnt id=hl-129-2><a class=lnlinks href=#hl-129-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>212</span><span class=p>]:</span> <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=n>lines</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>rstrip</span><span class=p>()</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>f</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>这样可以在退出代码块时，自动关闭文件。</p><p>如果输入f =open(path,&lsquo;w&rsquo;)，就会有一个新文件被创建在examples/segismundo.txt，并覆盖掉该位置原来的任何数据。另外有一个x文件模式，它可以创建可写的文件，但是如果文件路径存在，就无法创建。表3-3列出了所有的读/写模式。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://gitee.com/wugenqiang/images/raw/master/01/1240-20201009185850741.png alt="表3-3 Python的文件模式"></p><p>对于可读文件，一些常用的方法是read、seek和tell。read会从文件返回字符。字符的内容是由文件的编码决定的（如UTF-8），如果是二进制模式打开的就是原始字节：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-130-1><a class=lnlinks href=#hl-130-1>1</a>
</span><span class=lnt id=hl-130-2><a class=lnlinks href=#hl-130-2>2</a>
</span><span class=lnt id=hl-130-3><a class=lnlinks href=#hl-130-3>3</a>
</span><span class=lnt id=hl-130-4><a class=lnlinks href=#hl-130-4>4</a>
</span><span class=lnt id=hl-130-5><a class=lnlinks href=#hl-130-5>5</a>
</span><span class=lnt id=hl-130-6><a class=lnlinks href=#hl-130-6>6</a>
</span><span class=lnt id=hl-130-7><a class=lnlinks href=#hl-130-7>7</a>
</span><span class=lnt id=hl-130-8><a class=lnlinks href=#hl-130-8>8</a>
</span><span class=lnt id=hl-130-9><a class=lnlinks href=#hl-130-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>213</span><span class=p>]:</span> <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>214</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>214</span><span class=p>]:</span> <span class=s1>&#39;Sueña el r&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>215</span><span class=p>]:</span> <span class=n>f2</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span>  <span class=c1># Binary mode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>216</span><span class=p>]:</span> <span class=n>f2</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>216</span><span class=p>]:</span> <span class=sa>b</span><span class=s1>&#39;Sue</span><span class=se>\xc3\xb1</span><span class=s1>a el &#39;</span></span></span></code></pre></td></tr></table></div></div><p>read模式会将文件句柄的位置提前，提前的数量是读取的字节数。tell可以给出当前的位置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-131-1><a class=lnlinks href=#hl-131-1>1</a>
</span><span class=lnt id=hl-131-2><a class=lnlinks href=#hl-131-2>2</a>
</span><span class=lnt id=hl-131-3><a class=lnlinks href=#hl-131-3>3</a>
</span><span class=lnt id=hl-131-4><a class=lnlinks href=#hl-131-4>4</a>
</span><span class=lnt id=hl-131-5><a class=lnlinks href=#hl-131-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>217</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>tell</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>217</span><span class=p>]:</span> <span class=mi>11</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>218</span><span class=p>]:</span> <span class=n>f2</span><span class=o>.</span><span class=n>tell</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>218</span><span class=p>]:</span> <span class=mi>10</span></span></span></code></pre></td></tr></table></div></div><p>尽管我们从文件读取了10个字符，位置却是11，这是因为用默认的编码用了这么多字节才解码了这10个字符。你可以用sys模块检查默认的编码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-132-1><a class=lnlinks href=#hl-132-1>1</a>
</span><span class=lnt id=hl-132-2><a class=lnlinks href=#hl-132-2>2</a>
</span><span class=lnt id=hl-132-3><a class=lnlinks href=#hl-132-3>3</a>
</span><span class=lnt id=hl-132-4><a class=lnlinks href=#hl-132-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>219</span><span class=p>]:</span> <span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>220</span><span class=p>]:</span> <span class=n>sys</span><span class=o>.</span><span class=n>getdefaultencoding</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>220</span><span class=p>]:</span> <span class=s1>&#39;utf-8&#39;</span></span></span></code></pre></td></tr></table></div></div><p>seek将文件位置更改为文件中的指定字节：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-133-1><a class=lnlinks href=#hl-133-1>1</a>
</span><span class=lnt id=hl-133-2><a class=lnlinks href=#hl-133-2>2</a>
</span><span class=lnt id=hl-133-3><a class=lnlinks href=#hl-133-3>3</a>
</span><span class=lnt id=hl-133-4><a class=lnlinks href=#hl-133-4>4</a>
</span><span class=lnt id=hl-133-5><a class=lnlinks href=#hl-133-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>221</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>221</span><span class=p>]:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>222</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>222</span><span class=p>]:</span> <span class=s1>&#39;ñ&#39;</span></span></span></code></pre></td></tr></table></div></div><p>最后，关闭文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-134-1><a class=lnlinks href=#hl-134-1>1</a>
</span><span class=lnt id=hl-134-2><a class=lnlinks href=#hl-134-2>2</a>
</span><span class=lnt id=hl-134-3><a class=lnlinks href=#hl-134-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>223</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>224</span><span class=p>]:</span> <span class=n>f2</span><span class=o>.</span><span class=n>close</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>向文件写入，可以使用文件的write或writelines方法。例如，我们可以创建一个无空行版的prof_mod.py：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-135-1><a class=lnlinks href=#hl-135-1> 1</a>
</span><span class=lnt id=hl-135-2><a class=lnlinks href=#hl-135-2> 2</a>
</span><span class=lnt id=hl-135-3><a class=lnlinks href=#hl-135-3> 3</a>
</span><span class=lnt id=hl-135-4><a class=lnlinks href=#hl-135-4> 4</a>
</span><span class=lnt id=hl-135-5><a class=lnlinks href=#hl-135-5> 5</a>
</span><span class=lnt id=hl-135-6><a class=lnlinks href=#hl-135-6> 6</a>
</span><span class=lnt id=hl-135-7><a class=lnlinks href=#hl-135-7> 7</a>
</span><span class=lnt id=hl-135-8><a class=lnlinks href=#hl-135-8> 8</a>
</span><span class=lnt id=hl-135-9><a class=lnlinks href=#hl-135-9> 9</a>
</span><span class=lnt id=hl-135-10><a class=lnlinks href=#hl-135-10>10</a>
</span><span class=lnt id=hl-135-11><a class=lnlinks href=#hl-135-11>11</a>
</span><span class=lnt id=hl-135-12><a class=lnlinks href=#hl-135-12>12</a>
</span><span class=lnt id=hl-135-13><a class=lnlinks href=#hl-135-13>13</a>
</span><span class=lnt id=hl-135-14><a class=lnlinks href=#hl-135-14>14</a>
</span><span class=lnt id=hl-135-15><a class=lnlinks href=#hl-135-15>15</a>
</span><span class=lnt id=hl-135-16><a class=lnlinks href=#hl-135-16>16</a>
</span><span class=lnt id=hl-135-17><a class=lnlinks href=#hl-135-17>17</a>
</span><span class=lnt id=hl-135-18><a class=lnlinks href=#hl-135-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>225</span><span class=p>]:</span> <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;tmp.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>handle</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=n>handle</span><span class=o>.</span><span class=n>writelines</span><span class=p>(</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>226</span><span class=p>]:</span> <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;tmp.txt&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=n>lines</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>227</span><span class=p>]:</span> <span class=n>lines</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>227</span><span class=p>]:</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;Sueña el rico en su riqueza,</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;que más cuidados le ofrece;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;sueña el pobre que padece</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;su miseria y su pobreza;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;sueña el que a medrar empieza,</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;sueña el que afana y pretende,</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;sueña el que agravia y ofende,</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;y en el mundo, en conclusión,</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;todos sueñan lo que son,</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;aunque ninguno lo entiende.</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>表3-4列出了一些最常用的文件方法。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://gitee.com/wugenqiang/images/raw/master/01/1240-20201009185922864.png alt="表3-4 Python重要的文件方法或属性"></p><h2 id=331-文件的字节和unicode>3.3.1 文件的字节和Unicode
<a class=header-anchor href=#331-%e6%96%87%e4%bb%b6%e7%9a%84%e5%ad%97%e8%8a%82%e5%92%8cunicode></a></h2><p>Python文件的默认操作是“文本模式”，也就是说，你需要处理Python的字符串（即Unicode）。它与“二进制模式”相对，文件模式加一个b。我们来看上一节的文件（UTF-8编码、包含非ASCII字符）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-136-1><a class=lnlinks href=#hl-136-1>1</a>
</span><span class=lnt id=hl-136-2><a class=lnlinks href=#hl-136-2>2</a>
</span><span class=lnt id=hl-136-3><a class=lnlinks href=#hl-136-3>3</a>
</span><span class=lnt id=hl-136-4><a class=lnlinks href=#hl-136-4>4</a>
</span><span class=lnt id=hl-136-5><a class=lnlinks href=#hl-136-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>230</span><span class=p>]:</span> <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=n>chars</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>231</span><span class=p>]:</span> <span class=n>chars</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>231</span><span class=p>]:</span> <span class=s1>&#39;Sueña el r&#39;</span></span></span></code></pre></td></tr></table></div></div><p>UTF-8是长度可变的Unicode编码，所以当我从文件请求一定数量的字符时，Python会从文件读取足够多（可能少至10或多至40字节）的字节进行解码。如果以“rb”模式打开文件，则读取确切的请求字节数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-137-1><a class=lnlinks href=#hl-137-1>1</a>
</span><span class=lnt id=hl-137-2><a class=lnlinks href=#hl-137-2>2</a>
</span><span class=lnt id=hl-137-3><a class=lnlinks href=#hl-137-3>3</a>
</span><span class=lnt id=hl-137-4><a class=lnlinks href=#hl-137-4>4</a>
</span><span class=lnt id=hl-137-5><a class=lnlinks href=#hl-137-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>232</span><span class=p>]:</span> <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=n>data</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>233</span><span class=p>]:</span> <span class=n>data</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>233</span><span class=p>]:</span> <span class=sa>b</span><span class=s1>&#39;Sue</span><span class=se>\xc3\xb1</span><span class=s1>a el &#39;</span></span></span></code></pre></td></tr></table></div></div><p>取决于文本的编码，你可以将字节解码为str对象，但只有当每个编码的Unicode字符都完全成形时才能这么做：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-138-1><a class=lnlinks href=#hl-138-1> 1</a>
</span><span class=lnt id=hl-138-2><a class=lnlinks href=#hl-138-2> 2</a>
</span><span class=lnt id=hl-138-3><a class=lnlinks href=#hl-138-3> 3</a>
</span><span class=lnt id=hl-138-4><a class=lnlinks href=#hl-138-4> 4</a>
</span><span class=lnt id=hl-138-5><a class=lnlinks href=#hl-138-5> 5</a>
</span><span class=lnt id=hl-138-6><a class=lnlinks href=#hl-138-6> 6</a>
</span><span class=lnt id=hl-138-7><a class=lnlinks href=#hl-138-7> 7</a>
</span><span class=lnt id=hl-138-8><a class=lnlinks href=#hl-138-8> 8</a>
</span><span class=lnt id=hl-138-9><a class=lnlinks href=#hl-138-9> 9</a>
</span><span class=lnt id=hl-138-10><a class=lnlinks href=#hl-138-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>234</span><span class=p>]:</span> <span class=n>data</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>234</span><span class=p>]:</span> <span class=s1>&#39;Sueña el &#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>235</span><span class=p>]:</span> <span class=n>data</span><span class=p>[:</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=ne>UnicodeDecodeError</span>                        <span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ipython</span><span class=o>-</span><span class=nb>input</span><span class=o>-</span><span class=mi>235</span><span class=o>-</span><span class=mf>300e0</span><span class=n>af10bb7</span><span class=o>&gt;</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>1</span> <span class=n>data</span><span class=p>[:</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=ne>UnicodeDecodeError</span><span class=p>:</span> <span class=s1>&#39;utf-8&#39;</span> <span class=n>codec</span> <span class=n>can</span><span class=s1>&#39;t decode byte 0xc3 in position 3: unexpecte</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=n>end</span> <span class=n>of</span> <span class=n>data</span></span></span></code></pre></td></tr></table></div></div><p>文本模式结合了open的编码选项，提供了一种更方便的方法将Unicode转换为另一种编码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-139-1><a class=lnlinks href=#hl-139-1>1</a>
</span><span class=lnt id=hl-139-2><a class=lnlinks href=#hl-139-2>2</a>
</span><span class=lnt id=hl-139-3><a class=lnlinks href=#hl-139-3>3</a>
</span><span class=lnt id=hl-139-4><a class=lnlinks href=#hl-139-4>4</a>
</span><span class=lnt id=hl-139-5><a class=lnlinks href=#hl-139-5>5</a>
</span><span class=lnt id=hl-139-6><a class=lnlinks href=#hl-139-6>6</a>
</span><span class=lnt id=hl-139-7><a class=lnlinks href=#hl-139-7>7</a>
</span><span class=lnt id=hl-139-8><a class=lnlinks href=#hl-139-8>8</a>
</span><span class=lnt id=hl-139-9><a class=lnlinks href=#hl-139-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>236</span><span class=p>]:</span> <span class=n>sink_path</span> <span class=o>=</span> <span class=s1>&#39;sink.txt&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>237</span><span class=p>]:</span> <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span> <span class=k>as</span> <span class=n>source</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>sink_path</span><span class=p>,</span> <span class=s1>&#39;xt&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;iso-8859-1&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>sink</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>         <span class=n>sink</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>source</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>238</span><span class=p>]:</span> <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>sink_path</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;iso-8859-1&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=o>.....</span><span class=p>:</span>     <span class=nb>print</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>Sueña</span> <span class=n>el</span> <span class=n>r</span></span></span></code></pre></td></tr></table></div></div><p>注意，不要在二进制模式中使用seek。如果文件位置位于定义Unicode字符的字节的中间位置，读取后面会产生错误：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-140-1><a class=lnlinks href=#hl-140-1> 1</a>
</span><span class=lnt id=hl-140-2><a class=lnlinks href=#hl-140-2> 2</a>
</span><span class=lnt id=hl-140-3><a class=lnlinks href=#hl-140-3> 3</a>
</span><span class=lnt id=hl-140-4><a class=lnlinks href=#hl-140-4> 4</a>
</span><span class=lnt id=hl-140-5><a class=lnlinks href=#hl-140-5> 5</a>
</span><span class=lnt id=hl-140-6><a class=lnlinks href=#hl-140-6> 6</a>
</span><span class=lnt id=hl-140-7><a class=lnlinks href=#hl-140-7> 7</a>
</span><span class=lnt id=hl-140-8><a class=lnlinks href=#hl-140-8> 8</a>
</span><span class=lnt id=hl-140-9><a class=lnlinks href=#hl-140-9> 9</a>
</span><span class=lnt id=hl-140-10><a class=lnlinks href=#hl-140-10>10</a>
</span><span class=lnt id=hl-140-11><a class=lnlinks href=#hl-140-11>11</a>
</span><span class=lnt id=hl-140-12><a class=lnlinks href=#hl-140-12>12</a>
</span><span class=lnt id=hl-140-13><a class=lnlinks href=#hl-140-13>13</a>
</span><span class=lnt id=hl-140-14><a class=lnlinks href=#hl-140-14>14</a>
</span><span class=lnt id=hl-140-15><a class=lnlinks href=#hl-140-15>15</a>
</span><span class=lnt id=hl-140-16><a class=lnlinks href=#hl-140-16>16</a>
</span><span class=lnt id=hl-140-17><a class=lnlinks href=#hl-140-17>17</a>
</span><span class=lnt id=hl-140-18><a class=lnlinks href=#hl-140-18>18</a>
</span><span class=lnt id=hl-140-19><a class=lnlinks href=#hl-140-19>19</a>
</span><span class=lnt id=hl-140-20><a class=lnlinks href=#hl-140-20>20</a>
</span><span class=lnt id=hl-140-21><a class=lnlinks href=#hl-140-21>21</a>
</span><span class=lnt id=hl-140-22><a class=lnlinks href=#hl-140-22>22</a>
</span><span class=lnt id=hl-140-23><a class=lnlinks href=#hl-140-23>23</a>
</span><span class=lnt id=hl-140-24><a class=lnlinks href=#hl-140-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>240</span><span class=p>]:</span> <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>241</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>241</span><span class=p>]:</span> <span class=s1>&#39;Sueña&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>242</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Out</span><span class=p>[</span><span class=mi>242</span><span class=p>]:</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>243</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>---------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=ne>UnicodeDecodeError</span>                        <span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>ipython</span><span class=o>-</span><span class=nb>input</span><span class=o>-</span><span class=mi>243</span><span class=o>-</span><span class=mf>7841103e33</span><span class=n>f5</span><span class=o>&gt;</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=o>----&gt;</span> <span class=mi>1</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>miniconda</span><span class=o>/</span><span class=n>envs</span><span class=o>/</span><span class=n>book</span><span class=o>-</span><span class=n>env</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>python3</span><span class=mf>.6</span><span class=o>/</span><span class=n>codecs</span><span class=o>.</span><span class=n>py</span> <span class=ow>in</span> <span class=n>decode</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>input</span><span class=p>,</span> <span class=n>final</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=mi>319</span>         <span class=c1># decode input (taking the buffer into account)</span>
</span></span><span class=line><span class=cl>    <span class=mi>320</span>         <span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span> <span class=o>+</span> <span class=nb>input</span>
</span></span><span class=line><span class=cl><span class=o>--&gt;</span> <span class=mi>321</span>         <span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=n>consumed</span><span class=p>)</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_buffer_decode</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>errors</span><span class=p>,</span> <span class=n>final</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=mi>322</span>         <span class=c1># keep undecoded input until the next call</span>
</span></span><span class=line><span class=cl>    <span class=mi>323</span>         <span class=bp>self</span><span class=o>.</span><span class=n>buffer</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>consumed</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=ne>UnicodeDecodeError</span><span class=p>:</span> <span class=s1>&#39;utf-8&#39;</span> <span class=n>codec</span> <span class=n>can</span><span class=s1>&#39;t decode byte 0xb1 in position 0: invalid s</span>
</span></span><span class=line><span class=cl><span class=n>tart</span> <span class=n>byte</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>In</span> <span class=p>[</span><span class=mi>244</span><span class=p>]:</span> <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>如果你经常要对非ASCII字符文本进行数据分析，通晓Python的Unicode功能是非常重要的。更多内容，参阅Python官方文档。</p><h1 id=34-结论>3.4 结论
<a class=header-anchor href=#34-%e7%bb%93%e8%ae%ba></a></h1><p>我们已经学过了Python的基础、环境和语法，接下来学习NumPy和Python的面向数组计算。</p></div><footer class=post-footer><div class=post-tags><a href=/tags/python/>python</a></div><div class=post-share-tools><div class=post-share-loading><i class="fa-solid fa-ellipsis fa-spin"></i></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class=a2a_dd href=https://www.addtoany.com/share></a><a class=a2a_button_wechat></a><a class=a2a_button_qzone></a><a class=a2a_button_sina_weibo></a><a class=a2a_button_douban></a><a class=a2a_button_facebook></a><a class=a2a_button_x></a><a class=a2a_button_email></a><a class=a2a_button_printfriendly></a></div></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="Rich - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="Rich - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知识 title=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
第三章 Python 的数据结构、函数和文件</li><li class=post-copyright-author><strong>本文作者： </strong>Rich</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=//localhost:1313/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch03-python%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%87%BD%E6%95%B0%E5%92%8C%E6%96%87%E4%BB%B6/ title="第三章 Python 的数据结构、函数和文件">//localhost:1313/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch03-python%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%87%BD%E6%95%B0%E5%92%8C%E6%96%87%E4%BB%B6/</a></li><li class=post-copyright-license><strong>版权声明： </strong>本作品采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> 许可协议。转载请注明出处！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/white.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/rss.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch07-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E5%92%8C%E5%87%86%E5%A4%87/ rel=next title="第七章 数据清洗和准备"><i class="fa fa-chevron-left"></i> 第七章 数据清洗和准备</a></div><div class="post-nav-prev post-nav-item"><a href=/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch12-pandas%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8/ rel=prev title="第十二章 Pandas 高级应用">第十二章 Pandas 高级应用
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div id=i18n-translate class=i18n-translate><i class="fa fa-language"></i><div id=lang-select class=lang-select><div id=lang-selected class=selected-option><span class="flag-icon flag-icon-zh-cn"></span>
<span class=selected-language>简体中文</span>
<i class="fa fa-chevron-down"></i></div><div id=lang-options class=lang-options><div class=lang-option lang-code=zh-cn lang-name=简体中文 lang-url=/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch03-python%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%87%BD%E6%95%B0%E5%92%8C%E6%96%87%E4%BB%B6/><span class="flag-icon flag-icon-zh-cn"></span>
<span class=lang-name>简体中文</span></div></div></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2020 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Rich</span></div></div></footer><script class=next-config data-name=page type=application/json>{"clipboard":{"js":{"alias":"clipboard","file":"dist/clipboard.min.js","name":"clipboard.js","version":"2.0.11"}},"comments":false,"expired":false,"isHome":false,"isPage":true,"path":"ch03-python%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%87%BD%E6%95%B0%E5%92%8C%E6%96%87%E4%BB%B6","permalink":"//localhost:1313/post/%E7%A8%8B%E6%8A%80/python/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ch03-python%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%87%BD%E6%95%B0%E5%92%8C%E6%96%87%E4%BB%B6/","title":"第三章 Python 的数据结构、函数和文件","toc":true,"waline":{"commentcnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/comment.js","name":"comment","version":"2.15.8"}}}</script><script type=text/javascript src=//localhost:1313/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=//localhost:1313/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"hostname":"//localhost:1313/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":true,"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"slideInRight","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":true},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"//localhost:1313/js/3rd"}},"version":"4.8.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.js?=1750130937" defer></script><script type=text/javascript src="/js/clipboard.js?=1750130938" defer></script></body></html>